<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>2. WATIR - WEB AUTOMATION TESTING IN RUBY</title><link rel="stylesheet" type="text/css" href="..//docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.76.1" /><meta name="keywords" content="PHP, Python, Perl, Ruby, Java, HTML, XHTML, HTML5, CSS, Javascript, JQuery, C, C++, D" /><link rel="home" href="../index.html" title="Netkiller Developer 手札" /><link rel="up" href="webtesting.html" title="第 60 章 Web Testing" /><link rel="prev" href="webtesting.html" title="第 60 章 Web Testing" /><link rel="next" href="selenium.html" title="3. Selenium - Web Browser Automation" /><script xmlns="" type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11694057-1']);
  _gaq.push(['_setDomainName', 'netkiller.sourceforge.net']);
  _gaq.push(['_setAllowHash', 'false']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2. WATIR -  WEB AUTOMATION TESTING IN RUBY</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="webtesting.html">上一页</a> </td><th width="60%" align="center">第 60 章 Web Testing</th><td width="20%" align="right"> <a accesskey="n" href="selenium.html">下一页</a></td></tr></table><hr /></div><table xmlns="" width="100%" border="0"><tr><td align="left"><a href="http://netkiller.sourceforge.net/">Home</a> |
                <a href="http://netkiller.github.com/">Mirror</a> |
                <a href="/search.html">Search</a></td><td><script src="http://platform.linkedin.com/in.js" type="text/javascript"></script><script type="IN/Share" data-counter="right"></script></td><td><div id="ckepop"><a class="jiathis_like_qzone" data="width=100"></a><a class="jiathis_like_renren" data="width=100"></a><a class="jiathis_like_kaixin001"></a></div><script type="text/javascript" src="http://v3.jiathis.com/code_mini/jia.js?uid=1343815502531161" charset="utf-8"></script></td><td align="right"><form id="searchbox_008589143145807374698:f5uprauilyy" action="/search.html"><input type="hidden" name="cx" value="008589143145807374698:f5uprauilyy" /><input type="hidden" name="cof" value="FORID:11" /><input name="q" type="text" size="25" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: rgb(126, 157, 185); border-right-color: rgb(126, 157, 185); border-bottom-color: rgb(126, 157, 185); border-left-color: rgb(126, 157, 185); padding-top: 2px; padding-right: 2px; padding-bottom: 2px; padding-left: 2px; background-image: url(http://www.google.com/cse/intl/en/images/google_custom_search_watermark.gif); background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(255, 255, 255); background-position: 0% 50%; background-repeat: no-repeat no-repeat; " /><input type="submit" name="sa" value="Search" /><input name="siteurl" type="hidden" value="http://netkiller.sourceforge.net/" /></form><script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=searchbox_008589143145807374698%3Af5uprauilyy"></script></td></tr></table><div class="section" title="2. WATIR - WEB AUTOMATION TESTING IN RUBY"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="watir"></a>2. WATIR -  WEB AUTOMATION TESTING IN RUBY</h2></div></div></div><div class="section" title="2.1. Install of WATIR"><div class="titlepage"><div><div><h3 class="title"><a id="watir.install"></a>2.1. Install of WATIR</h3></div></div></div><p>Install Ruby on Linux</p><pre class="screen">
sudo apt-get install ruby  # for Ubuntu / Debian users
sudo yum install ruby      # for Red Hat / Fedora users
		</pre><p>Update RubyGems</p><pre class="screen">
sudo apt-get install rubygems # for Ubuntu / Debian users

sudo yum install rubygems # for Red Hat / Fedora users
		</pre><p>Install Watir</p><pre class="screen">
gem update --system --no-rdoc --no-ri
gem install watir --no-rdoc --no-ri
		</pre><div class="section" title="2.1.1. IE"><div class="titlepage"><div><div><h4 class="title"><a id="idp850064"></a>2.1.1. IE</h4></div></div></div><pre class="screen">
http://www.microsoft.com/downloads/en/details.aspx?FamilyID=95e06cbe-4940-4218-b75d-b8856fced535
			</pre></div><div class="section" title="2.1.2. Firefox"><div class="titlepage"><div><div><h4 class="title"><a id="idp850976"></a>2.1.2. Firefox</h4></div></div></div><p>如果仅仅安装Firefox测试环境：</p><pre class="screen">
sudo gem install firewatir

Successfully installed firewatir-1.8.0
1 gem installed
Installing ri documentation for firewatir-1.8.0...
Installing RDoc documentation for firewatir-1.8.0...
			</pre><p>JSSH for Firefox: </p><p>http://wiki.openqa.org/display/WTR/FireWatir+Installation</p><p>test jssh</p><pre class="screen">
$ firefox -jssh
$ telnet localhost 9997
			</pre></div><div class="section" title="2.1.3. Chrome Driver"><div class="titlepage"><div><div><h4 class="title"><a id="idp853408"></a>2.1.3. Chrome Driver</h4></div></div></div><a class="ulink" href="http://code.google.com/p/chromium/downloads/list" target="_top">http://code.google.com/p/chromium/downloads/list</a><pre class="screen">
@browser = Watir::Browser.new(:chrome)
@browser.goto "http://google.com"
			</pre></div></div><div class="section" title="2.2. Getting Started"><div class="titlepage"><div><div><h3 class="title"><a id="watir.example"></a>2.2. Getting Started</h3></div></div></div><p>Quick Start</p><p>create a testing script</p><pre class="screen">
		
$ cat google.rb
require 'rubygems'
require 'watir'
require 'firewatir'

browser = Watir::Browser.new
browser.goto 'http://google.com'
browser.text_field(:name, 'q').set 'Ruby'
browser.button(:name, 'btnG').click
if browser.text.include? 'Ruby Programming Language'
  puts 'Text was found'
else
  puts 'Text was not found'
end
		
		</pre><p>run test</p><pre class="screen">
		
$ irb google.rb

google.rb(main):001:0&gt; require 'rubygems'
=&gt; true
google.rb(main):002:0&gt; require 'watir'
=&gt; true
google.rb(main):003:0&gt; require 'firewatir'
=&gt; true
google.rb(main):004:0&gt;
google.rb(main):005:0* browser = Watir::Browser.new
=&gt; #&lt;FireWatir::Firefox:0x7f797dd2b880 url="http://www.google.com.hk/search?hl=zh-CN&amp;source=hp&amp;biw=1440&amp;bih=660&amp;q=Ruby&amp;btnG=Google+%E6%90%9C%E7%B4%A2&amp;aq=f&amp;aqi=g10&amp;aql=&amp;oq=" title="Ruby - Google \346\220\234\347\264\242"&gt;
google.rb(main):006:0&gt; browser.goto 'http://google.com'
=&gt; #&lt;FireWatir::Firefox:0x7f797dd2b880 url="http://www.google.com.hk/" title="Google"&gt;
google.rb(main):007:0&gt; browser.text_field(:name, 'q').set 'Ruby'
=&gt; 0
google.rb(main):008:0&gt; browser.button(:name, 'btnG').click
=&gt; 0
google.rb(main):009:0&gt; if browser.text.include? 'Ruby Programming Language'
google.rb(main):010:1&gt;   puts 'Text was found'
google.rb(main):011:1&gt; else
google.rb(main):012:1*   puts 'Text was not found'
google.rb(main):013:1&gt; end
Text was found
=&gt; nil
		
		</pre></div><div class="section" title="2.3. Config file"><div class="titlepage"><div><div><h3 class="title"><a id="watir.config"></a>2.3. Config file</h3></div></div></div><p>Create a file like this, called options.yml</p><pre class="screen">
cat options.yml
browser: ie
		</pre><p>In your program, execute the following code before calling "Watir::Browser.new":</p><pre class="programlisting">
Watir.options_file = '~/options.yml'
		</pre><p>You will need to provide the full path to your file. Once you have done this, "Browser.new" will use the option settings from this file. If you also use an environment variable, it will override this setting.</p><p>Currently the following options are configurable for IE:</p><pre class="screen">
speed: fast
visible: true
		</pre><p>Valid speed settings are "fast", "slow" and "zippy"</p></div><div class="section" title="2.4. Watir library"><div class="titlepage"><div><div><h3 class="title"><a id="watir.library"></a>2.4. Watir library</h3></div></div></div><p>Load the Watir library</p><pre class="programlisting">
require 'rubygems'
require 'watir'
require 'firewatir'
		</pre></div><div class="section" title="2.5. Browser"><div class="titlepage"><div><div><h3 class="title"><a id="watir.browser"></a>2.5. Browser</h3></div></div></div><div class="section" title="2.5.1. Environment variable"><div class="titlepage"><div><div><h4 class="title"><a id="idp863328"></a>2.5.1. Environment variable</h4></div></div></div><pre class="programlisting">
&gt; set watir_browser=ie
&gt; set watir_browser=firefox
&gt; set watir_browser=safari
			</pre></div><div class="section" title="2.5.2. Browser options"><div class="titlepage"><div><div><h4 class="title"><a id="idp864128"></a>2.5.2. Browser options </h4></div></div></div><pre class="programlisting">
Watir::Browser.default = 'ie'
Watir::Browser.default = 'firefox'
			</pre><p>Specifying additional options (IE only)</p><pre class="programlisting">
Speed up execution
(or use the "-b" command line switch)

browser.speed = :fast
Maximize browser window

browser.maximize
Pop browser window to front

browser.bring_to_front
			</pre></div><div class="section" title="2.5.3. Open a browser (default: Internet Explorer)"><div class="titlepage"><div><div><h4 class="title"><a id="idp865728"></a>2.5.3. Open a browser (default: Internet Explorer)</h4></div></div></div><pre class="screen">
browser = Watir::Browser.new
			</pre></div><div class="section" title="2.5.4. Watir::Browser.attach"><div class="titlepage"><div><div><h4 class="title"><a id="idp866480"></a>2.5.4. Watir::Browser.attach</h4></div></div></div><pre class="screen">
$ firefox -jssh
			</pre><pre class="programlisting">
browser = Watir::Browser.attach(:title, 'Mozlla Firefox')
			</pre></div><div class="section" title="2.5.5. Open Browser at the specified URL"><div class="titlepage"><div><div><h4 class="title"><a id="idp867520"></a>2.5.5. Open Browser at the specified URL</h4></div></div></div><pre class="programlisting">
browser = Watir::Browser.start("http://google.com")
			</pre></div><div class="section" title="2.5.6. Go to a specified URL"><div class="titlepage"><div><div><h4 class="title"><a id="idp868288"></a>2.5.6. Go to a specified URL</h4></div></div></div><pre class="programlisting">
browser.goto("http://amazon.com")
			</pre></div><div class="section" title="2.5.7. Close the browser"><div class="titlepage"><div><div><h4 class="title"><a id="idp869008"></a>2.5.7. Close the browser</h4></div></div></div><pre class="programlisting">
browser.close
			</pre></div></div><div class="section" title="2.6. Test Unit"><div class="titlepage"><div><div><h3 class="title"><a id="watir.testunit"></a>2.6. Test Unit</h3></div></div></div><p>Create a Test Instance</p><pre class="programlisting">
		
require 'test/unit'
require 'rubygems'
require 'watir'
require 'firewatir'

class GoogleHomePage &lt; Test::Unit::TestCase
  def test_there_should_be_text_About_Google
    browser = Watir::Browser.start "http://www.google.com"
    assert(browser.text.include?("About Google"))
  end
end
		
		</pre><pre class="screen">
$ ruby test_unit.rb

Loaded suite test_unit
Started
.
Finished in 1.687 seconds.

1 tests, 1 assertions, 0 failures, 0 errors
		</pre><p>Create a Test Case Method</p><pre class="programlisting">
		
class SampleTest &lt; Watir::TestCase
  def test_login
    # login test code, etc
  end

  def test_account
    # account test code, etc
  end
end
		
		</pre><p>How to run a specific test case?</p><pre class="screen">
ruby my_test_file.rb --name test_account
		</pre><div class="note" title="提示" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">提示</h3><p>必须test_为前缀</p><p>默认非顺序执行</p><p>顺序执行方法 test_a_mytest, test_b_mytest; test_01_mytest, test_02_mytest</p></div></div><div class="section" title="2.7. HTML Tags and Watir Methods"><div class="titlepage"><div><div><h3 class="title"><a id="watir.html"></a>2.7. HTML Tags and Watir Methods</h3></div></div></div><div class="section" title="2.7.1. Collections of HTML Elements"><div class="titlepage"><div><div><h4 class="title"><a id="idp874928"></a>2.7.1. Collections of HTML Elements</h4></div></div></div><pre class="screen">
			
If you have a page that looks like this:

&lt;a href="http://google.com"&gt;google.com&lt;/a&gt;
&lt;a href="http://facebook.com"&gt;facebook.com&lt;/a&gt;
You can get href attribute of all links with:

browser.links.each do |link|
  puts link.href
end
When you execute the code, output should be:

http://google.com/
http://facebook.com/
			
			</pre></div></div></div><div xmlns="" id="disqus_thread"></div><script xmlns="" type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

            if(document.domain == 'netkiller.github.com'){
            var disqus_shortname = 'netkiller'; // required: replace example with your forum shortname
            }else{
			var disqus_shortname = 'neochan';
            }

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script><noscript xmlns="">Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a xmlns="" href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a><div xmlns="" id="ckepop"><span class="jiathis_txt">分享到：</span><a class="jiathis_button_fb">Facebook</a><a class="jiathis_button_twitter">Twitter</a><a class="jiathis_button_googleplus">Google+</a><a class="jiathis_button_msn">MSN</a><a class="jiathis_button_linkedin">LinkedIn</a><a class="jiathis_button_digg">Digg</a><a class="jiathis_button_myspace">Myspace</a><a class="jiathis_button_stumbleupon">StumbleUpon</a><a class="jiathis_button_delicious">Delicious</a><a class="jiathis_button_netlog">NetLog</a><a class="jiathis_button_myshare">Myshare</a><a class="jiathis_button_plaxo">Plaxo</a><a class="jiathis_button_pingfm">Ping.fm</a><br /><a class="jiathis_button_qzone">QQ空间</a><a class="jiathis_button_tsina">新浪微博</a><a class="jiathis_button_tqq">腾讯微博</a><a class="jiathis_button_renren">人人网</a><a class="jiathis_button_kaixin001">开心网</a><a class="jiathis_button_xiaoyou">朋友网</a><a class="jiathis_button_douban">豆瓣</a><a class="jiathis_button_t163">网易微博</a><a class="jiathis_button_tsohu">搜狐微博</a><a class="jiathis_button_mop">猫扑推客</a><a class="jiathis_button_google">谷歌</a><a class="jiathis_button_tianya">天涯社区</a><a class="jiathis_button_51">51社区</a><a class="jiathis_button_tifeng">凤凰微博</a><a class="jiathis_button_hi">百度空间</a><a class="jiathis_button_tieba">百度贴吧</a><a class="jiathis_button_baidu">百度搜藏</a><a class="jiathis_button_feixin">飞信</a><a class="jiathis_button_gmail">Gmail邮箱</a><a class="jiathis_button_buzz">谷歌Buzz</a><a class="jiathis_button_ishare">一键分享</a><a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a><a class="jiathis_counter_style"></a></div><script xmlns="" type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1343815502531161" charset="utf-8"></script><script xmlns="" type="text/javascript" src="http://v1.ujian.cc/code/ujian.js?type=slide"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="webtesting.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="webtesting.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="selenium.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">第 60 章 Web Testing </td><td width="20%" align="center"><a accesskey="h" href="../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 3. Selenium - Web Browser Automation</td></tr></table></div></body></html>
