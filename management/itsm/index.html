<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 22 章 ITSM (IT Service Management) IT服务管理</title><link rel="stylesheet" type="text/css" href="..//docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="../index.html" title="Netkiller Management 手札" /><link rel="up" href="../management.html" title="部分 III. IT 管理篇" /><link rel="prev" href="../project/purchasing.html" title="21.11. 采购管理" /><link rel="next" href="delivery.html" title="22.2. Service Delivery Set(服务实施系列)" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> |
		<a xmlns="" href="//netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="https://github.com/netkiller">Github</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://cloud.tencent.com/developer/column/2078">云社区</a> |
	    <a xmlns="" href="https://yq.aliyun.com/u/netkiller/">云栖社区</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/video.html">视频教程</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 22 章 ITSM (IT Service Management) IT服务管理</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../project/purchasing.html">上一页</a> </td><th width="60%" align="center">部分 III. IT 管理篇</th><td width="20%" align="right"> <a accesskey="n" href="delivery.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td></tr></table><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="index"></a>第 22 章 ITSM (IT Service Management) IT服务管理</h2></div><div><h3 class="subtitle"><em>ITIL(IT Infrastructure Library)</em></h3></div></div></div><div class="toc"><p><strong>目录</strong></p><dl class="toc"><dt><span class="section"><a href="index.html#support">22.1. Service Support Set(服务支持系列)</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#desk">22.1.1. Help Desk / Service Desk</a></span></dt><dt><span class="section"><a href="index.html#itsm.problem">22.1.2. Problem Management(问题管理)</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#fta">22.1.2.1. 故障树分析(Fault Tree Analysis，FTA)</a></span></dt><dt><span class="section"><a href="index.html#fishbone">22.1.2.2. 因果图在运维工作中的应用</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#what">22.1.2.2.1. 什么是因果图</a></span></dt><dt><span class="section"><a href="index.html#why">22.1.2.2.2. 为什么使用因果图</a></span></dt><dt><span class="section"><a href="index.html#when">22.1.2.2.3. 何时使用因果图</a></span></dt><dt><span class="section"><a href="index.html#where">22.1.2.2.4. 何处使用因果图</a></span></dt><dt><span class="section"><a href="index.html#who">22.1.2.2.5. 谁来负责制作因果图</a></span></dt><dt><span class="section"><a href="index.html#how">22.1.2.2.6. 怎样使用因果图</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp86">22.1.2.2.6.1. www.example.com, img.example.com</a></span></dt><dt><span class="section"><a href="index.html#idp87">22.1.2.2.6.2. acc.example.com, api.example.com</a></span></dt><dt><span class="section"><a href="index.html#idp88">22.1.2.2.6.3. cch.exampel.com, mq.exampe.com, db.example.com</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="index.html#idp89">22.1.2.3. 员工手册</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#itsm.incident">22.1.3. Incident Management(突发事件管理)</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp90">22.1.3.1. 突发事件处理流程</a></span></dt><dt><span class="section"><a href="index.html#idp91">22.1.3.2. 事件处理方式</a></span></dt><dt><span class="section"><a href="index.html#monitor">22.1.3.3. 监控的艺术</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#background">22.1.3.3.1. 背景</a></span></dt><dt><span class="section"><a href="index.html#overview">22.1.3.3.2. 概述</a></span></dt><dt><span class="section"><a href="index.html#how">22.1.3.3.3. 怎样监控</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp92">22.1.3.3.3.1. 卫星监测</a></span></dt><dt><span class="section"><a href="index.html#idp93">22.1.3.3.3.2. 逐级诊断</a></span></dt><dt><span class="section"><a href="index.html#idp94">22.1.3.3.3.3. 模拟人工</a></span></dt><dt><span class="section"><a href="index.html#idp95">22.1.3.3.3.4. 数据分析</a></span></dt><dt><span class="section"><a href="index.html#idp96">22.1.3.3.3.5. 监控与开发</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#summary">22.1.3.3.4. 总结</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="index.html#itsm.configuration">22.1.4. Configuration Management(配置管理)</a></span></dt><dt><span class="section"><a href="index.html#itsm.change">22.1.5. Change Management(变更管理)</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp97">22.1.5.1. 变更方案</a></span></dt><dt><span class="section"><a href="index.html#idp98">22.1.5.2. 回退计划</a></span></dt><dt><span class="section"><a href="index.html#idp99">22.1.5.3. 变更评估</a></span></dt><dt><span class="section"><a href="index.html#idp100">22.1.5.4. 变更授权</a></span></dt><dt><span class="section"><a href="index.html#idp101">22.1.5.5. 过程记录</a></span></dt><dt><span class="section"><a href="index.html#idp102">22.1.5.6. 结果回顾</a></span></dt><dt><span class="section"><a href="idc/index.html#move">22.1.5.7. 机房迁移</a></span></dt><dd><dl><dt><span class="section"><a href="idc/index.html#topology">22.1.5.7.1. 拓扑确立</a></span></dt><dt><span class="section"><a href="idc/index.html#storage">22.1.5.7.2. 存储规划</a></span></dt><dd><dl><dt><span class="section"><a href="idc/index.html#idp103">22.1.5.7.2.1. RAID Disk Group 规划</a></span></dt><dt><span class="section"><a href="idc/index.html#idp104">22.1.5.7.2.2. 文件系统规划</a></span></dt><dt><span class="section"><a href="idc/index.html#idp105">22.1.5.7.2.3. 目录规划</a></span></dt></dl></dd><dt><span class="section"><a href="idc/index.html#device">22.1.5.7.3. 设备上架</a></span></dt><dt><span class="section"><a href="idc/index.html#os">22.1.5.7.4. 操作系统初始化</a></span></dt><dt><span class="section"><a href="idc/index.html#application">22.1.5.7.5. 服务器及运行环境</a></span></dt><dt><span class="section"><a href="idc/index.html#deployment">22.1.5.7.6. 部署应用程序</a></span></dt><dt><span class="section"><a href="idc/index.html#monitor">22.1.5.7.7. 监控系统</a></span></dt><dt><span class="section"><a href="idc/index.html#log">22.1.5.7.8. 日志中心</a></span></dt><dt><span class="section"><a href="idc/index.html#test">22.1.5.7.9. 测试</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="index.html#itsm.training">22.1.6. 内部培训</a></span></dt><dt><span class="section"><a href="index.html#itsm.resource">22.1.7. IT资源管理</a></span></dt></dl></dd><dt><span class="section"><a href="delivery.html">22.2. Service Delivery Set(服务实施系列)</a></span></dt><dd><dl><dt><span class="section"><a href="delivery.html#idp106">22.2.1. Service Level Management(服务水平管理)</a></span></dt><dt><span class="section"><a href="delivery.html#idp107">22.2.2. Availability Management(可用性管理)</a></span></dt><dt><span class="section"><a href="delivery.html#idp108">22.2.3. Capacity Management(容量管理)</a></span></dt><dt><span class="section"><a href="delivery.html#idp109">22.2.4. IT Continuity Management(IT可持续性管理)</a></span></dt><dt><span class="section"><a href="delivery.html#idp110">22.2.5. IT Financial Management(IT财务管理)</a></span></dt></dl></dd></dl></div>
	
	
	<pre class="screen">
(1)服务级别管理
(2)可用性管理
(3)能力管理
(4)服务连续性管理
(5)财务管理
(6)事件管理
(7)问题管理
(8)变更管理
(9)配置管理
(10)发布管理
	</pre>
	
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="support"></a>22.1. Service Support Set(服务支持系列)</h2></div></div></div>
	

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="desk"></a>22.1.1. Help Desk / Service Desk</h3></div><div><h4 class="subtitle">桌面支持 </h4></div></div></div>
		
		
		<p><a class="ulink" href="http://freehelpdesk.org/" target="_top">Help Desk Software</a></p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="itsm.problem"></a>22.1.2. Problem Management(问题管理)</h3></div></div></div>
		
		<p>“问题管理” 是以解决问题为导向，以挖掘问题、表达问题、归结问题、处理问题为线索和切入点的一套管理理论和管理方法。也可以说，问题管理就是借助问题进行的管理。</p>
		<p>问题管理是事件管理的主要出口，在事件管理中无法根本解决的事件、不断重复的事件、典型或影响范围过大的事件等，通常由事件管理的负责人在问题管理项目中发起问题，交给问题管理处理。问题管理的根本目的是消除或减少同类事件的发生，通过分析所发生的事件或事件的趋势，找出根本原因，然后提出解决办法、解决方案、变通方法、或建议的预防性措施等，来消除或减少事件的再次发生。同时问题管理还可包括主动问题管理和被动问题管理两个部分，问题管理的活动包括问题的发起、确认和分配、问题调查、已知错误确立、提供解决方案、评审、关闭。</p>
		<p>“问题管理”是在挖掘问题的基础上，合适地表达问题，正确地解决问题，以此来防范问题演化为危机的一套管理理论和方法。也可以说，问题管理就是借助问题优化管理。</p>
		<p>“问题管理”的三要素是挖掘问题、表达问题、解决问题。其中，挖掘问题包括发现问题、分析问题和界定问题，解决问题包括制定解决方案、实施解决方案和跟踪反馈，表达问题不是独立的环节，而是体现和融入到挖掘问题和解决问题的每一个环节之中。</p>
		<div class="orderedlist"><p class="title"><strong>问题管理的特点主要有三方面</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p>一是防患于未然，防止问题演化为危机。问题管理强调“从危机管理到问题管理”，并不是要取代危机管理，而是要以危机管理为主转向以问题管理为主，做到“以防为主，防消结合”；</p></li><li class="listitem"><p>二是发现和解决关键问题，过滤假问题，解决真问题；</p></li><li class="listitem"><p>三是跨专业、跨部分地分析和解决问题，打通专业管理或部门之间之间的鸿沟；</p></li></ol></div>
		
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="fta"></a>22.1.2.1. 故障树分析(Fault Tree Analysis，FTA)</h4></div></div></div>
	
	<div><img src="../images/graphics/fta.png" /></div>
</div>
		
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="fishbone"></a>22.1.2.2. 因果图在运维工作中的应用</h4></div></div></div>
	
	
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="what"></a>22.1.2.2.1. 什么是因果图</h5></div></div></div>
		
		<p>鱼骨图，又名因果图，是一种发现问题“根本原因”的分析方法，我们将影响问题的因素与特性，按相互关联性整理而成的层次分明、条理清楚，并标出重要因素的图形就叫特性要因图、特性原因图。因其形状如鱼骨，所以又叫鱼骨图（以下称鱼骨图），它是一种透过现象看本质的分析方法。鱼骨图由日本管理大师石川馨先生所发明，故又名石川图。鱼骨图是一种发现问题“根本原因”的方法，它也可以称之为“Ishikawa”或者“因果图”。其特点是简捷实用，深入直观。它看上去有些像鱼骨，问题或缺陷（即后果）标在“鱼头”外。在鱼骨上长出鱼刺，上面按出现机会多寡列出产生问题的可能原因，有助于说明各个原因之间是如何相互影响的。</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="why"></a>22.1.2.2.2. 为什么使用因果图</h5></div></div></div>
		
		<p>在运维工作中，我们经常使用 过程中“故障树分析”，它主要用于出现故障时找到问题的源头。而因果图则是保证7*24运维有哪些影响因素。我认为将“故障树分析”与“因果图”互补使用更能解决运维中遇到的各种问题。</p>
		<p>“因果图”能未雨绸缪，“故障树分析”可以亡羊补牢。</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="when"></a>22.1.2.2.3. 何时使用因果图</h5></div></div></div>
		
		<p>我认为任何环节都能使用因果图帮我们我们改善IT运维工作。</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="where"></a>22.1.2.2.4. 何处使用因果图</h5></div></div></div>
		
		<p>例如项目的部署先，部署中，部署后等等每个环节。部署前拿出因果图由为重要。</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="who"></a>22.1.2.2.5. 谁来负责制作因果图</h5></div></div></div>
		
		<p>问题总是受到一些因素的影响，我们通过头脑风暴法找出这些因素，并将它们与影响因素的特性值，整理，分类，层次化。</p>
		<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="/graphics/note.png" /></td><th align="left">注意</th></tr><tr><td align="left" valign="top">
			<p>我不喜欢开茶话会（中国式会议），参与人员应该每个人在会议前找出问题因素，会议中拿出问题的因素提交给会议主持者，会议目的是将每个人寻找出的影响问题的因素整理成为鱼骨图，而不是在会议上讨论找问题因素。</p>
		</td></tr></table></div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="how"></a>22.1.2.2.6. 怎样使用因果图</h5></div></div></div>
		
		<p>下面我们提供一个鱼骨图分析案例</p>
		<div><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="1024"><tr><td><img src="../images/ops/fishbone/fishbone.png" width="1024" /></td></tr></table></div>
		<p>上图我们看到保障系统7*24小时运行有哪些因素印象，网站分为几个部分组成</p>
		<div class="orderedlist"><p class="title"><strong>网站</strong></p><ol class="orderedlist" type="1"><li class="listitem">
				<p>www.exampel.com 网站入口，主要是静态内容，或者已经将动态静态化。</p>
			</li><li class="listitem">
				<p>img.exampel.com 图片服务器</p>
			</li><li class="listitem">
				<p>acc.example.com, api.example.com 动态服务器</p>
			</li><li class="listitem">
				<p>cch.exampel.com 缓存服务器， db.example.com 数据库服务器</p>
			</li><li class="listitem">
				<p>mq.example.com 消息服务器</p>
			</li></ol></div>
		<p>我通常给每个服务器指定一个主机名，有些事DNS解析的，有些事hosts文件设置例如 cch.example.com, db.example.com 不需要DNS解析。</p>
		<p>现在我们分别解释每个节点与问题的影响因素，这里仅仅给出的一个简单的例子，也只能让你对因果图有个入门了解。</p>
		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp86"></a>22.1.2.2.6.1. www.example.com, img.example.com</h6></div></div></div>
			
			<p>影响的因素主要是web服务器，IP地址，80端口，防火墙设置，DNS 解析等等</p>
		</div>
		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp87"></a>22.1.2.2.6.2. acc.example.com, api.example.com</h6></div></div></div>
			
			<p>除了web服务器，IP地址，80端口，防火墙设置，DNS 解析。他的影响因素包括</p>
			<p>PHP版本，PHP扩展，PHP配置文件</p>
		</div>
		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp88"></a>22.1.2.2.6.3. cch.exampel.com, mq.exampe.com, db.example.com</h6></div></div></div>
			
			<p>影响的因素是防火墙，端口，数据库同步等等...</p>
		</div>		
	</div>	
	
</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp89"></a>22.1.2.3. 员工手册</h4></div></div></div>
			
			<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>邮箱配置，初始密码</p></li><li class="listitem"><p>开发环境配置</p></li><li class="listitem"><p>版本库地址</p></li></ul></div>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="itsm.incident"></a>22.1.3. Incident Management(突发事件管理)</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp90"></a>22.1.3.1. 突发事件处理流程</h4></div></div></div>
			
			<div><img src="../images/incident.png" /></div>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp91"></a>22.1.3.2. 事件处理方式</h4></div></div></div>
			
			<p>很多人顺着简单而直接的“事件 &gt; 反应 &gt; 结果” 连锁行为来反应。</p>
			<p>遇有状况发生，第一时间不加思索地反映，造成的结果不但于事无补甚至造成二次故障。</p>
			<p>这种不由自主或未经过思考的反映有时会导致灾难性的后果。</p>
			<p>更好的选自是：</p>
			<pre class="screen">
			
事件 -&gt; 结果 -&gt; 反应
			
			</pre>
			<p>说白了就是，遇事想清楚在动手不迟。</p>
		</div>
		

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="monitor"></a>22.1.3.3. 监控的艺术</h4></div><div><h5 class="subtitle"></h5></div></div></div>
	
	
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="background"></a>22.1.3.3.1. 背景</h5></div></div></div>
		
		<p>每个企业都意识到监控工作的重要性，但80%企业的监控工作仍然处在监控的初级阶段。</p>
		<div class="orderedlist"><p class="title"><strong>什么是初级阶段呢？</strong></p><ol class="orderedlist" type="1"><li class="listitem">被动监控，故障发生运维人员永远不是第一个发现故障的人</li><li class="listitem">监控IP地址与TCP端口，很多时候HTTP 80端口正常接受请求，但WEB服务器不能正常工作。</li><li class="listitem">人肉监控（人肉运维），采用人海战术，桌面摆放很多显示器，甚至投影仪，要求监控者盯着各种仪表板界面，制定各种工作流程以及KPI考核监控人员。</li><li class="listitem">人肉测试，要求监控人员每间隔几分钟人工操作一次，以确认系统正常工作，例如（没15分钟登陆一次，下一笔顶单，做一次支付等等）。</li><li class="listitem">万能的重启，定其重启所有的服务器。</li></ol></div>
		<div class="orderedlist"><p class="title"><strong>什么是中级阶段呢？</strong></p><ol class="orderedlist" type="1"><li class="listitem">报警：手机短信更靠谱，因为手机随身携带（邮件不算，邮件到达速度慢，各种因素不稳定）</li><li class="listitem">监控服务：探测服务的可用性，而不是仅仅监控端口，注意我是指私有协议的监控（HTTP，SMTP,FTP,MySQL 不算在内）</li><li class="listitem">故障分析：通过日志与调试工具分析软件BUG，指导开发人员改善软件质量，使其故障不会再次发生，达到不用restart重启方式解决故障</li><li class="listitem">半自动化测试</li></ol></div>
		<div class="orderedlist"><p class="title"><strong>什么是高级阶段呢？</strong></p><ol class="orderedlist" type="1"><li class="listitem">我认为高级阶段是监控与灾备系统打通融合一体。</li><li class="listitem">除此之外监控与开发密切相关，在开发阶段需要为监控数据采集做铺垫，每开发一个新功能就要想到未来这个功能是否需要监控，怎样监控。</li><li class="listitem">数据前期采集与数据挖掘非常重要，监控不仅能做软件与硬件的性能分析，还能提供决策支持，这里又涉及了BI。</li><li class="listitem">除了监控，另一个息息相关的是自动故障转移，有兴趣可以看看我的其他文章 <a class="ulink" href="http://netkiller.github.io/journal/" target="_top">http://netkiller.github.io/journal/</a></li></ol></div>
		<p>监控从初级向中继再到高级，是转被动到主动，从人工到自动化。</p>
		<p>监控不应该局限在硬件与服务，还应该延伸到业务领域。</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="overview"></a>22.1.3.3.2. 概述</h5></div></div></div>
		
		<p>你在百度上搜索监控多半是一些开源或商业软件的安装配置指南。这些文章中会告诉你怎样监控CPU、内存、硬盘空间以及网络IP地址与端口号码。</p>
		<p>开源软件无非是 Nagios, Cacti, Mrtg, Zibbix ..... 这些软件在我的电子出书<a class="ulink" href="http://netkiller.github.io/monitoring/index.html" target="_top">《Netkiller Monitoring 手札》</a>中都有详细说明安装与配置方法。</p>
		<p>商业软件也有很多如 SolarWinds， Whit's Up，PRTG ......</p>
		<p>所有的服务器，网络设备，监控你都做了，那么按照我上面的监控分级，你处于监控的那个阶段？</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="how"></a>22.1.3.3.3. 怎样监控</h5></div></div></div>
		
		<p>监控都有哪些手段跟方式呢？</p>
		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp92"></a>22.1.3.3.3.1. 卫星监测</h6></div></div></div>
			
			<p>中心卫星站为中心站点向外放射，通常是通过IP地址访问远程主机，实施监控，常用方法是SNMP,SSH,以及各种Agent(代理)，方式是请求然后接收返回结果，通过结果判断主机状态。</p>
			<pre class="screen">
			
      Monitor Server
            |
-------------------------------
  |         |           |
[Web]    [Mail]    [Database]
			
			</pre>
			<p>以监控服务器为中心，星型散射连接其他监控节点，没有什么优点，缺点是Web跟Mail节点的通信没有监控</p>
		</div>
		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp93"></a>22.1.3.3.3.2. 逐级诊断</h6></div></div></div>
			
			<p>一级一级的向下探测，寻找故障点，需要在各个节点埋探针。</p>
			<pre class="screen">
			
      Monitor Server
              |
-------------------------------      
  |           |             |
  V           V             V
  |           |             |
[Web] ---&gt; [Cache] ---&gt; [Database]
  \                         ^
   `------------------------|			
			
			</pre>
			<p>首先监控服务器跟星型拓扑一样监控，再让Web节点去访问Cache节点然后返回监控结果，以此类推，让Cache节点访问Database, 让Web访问Database节点。</p>
			<p>将所有业务逻辑都逐一模拟一次，任何一个环节出现问题，立即发出警告。</p>
		</div>
		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp94"></a>22.1.3.3.3.3. 模拟人工</h6></div></div></div>
			
			<p>这里主要监控服务是否可用，可以检查软件的工作情况，涉及测试环节。</p>
			<p>通过自动化测试工具辅助监控，例如模拟鼠标点击，键盘输入，可以监控图形界面程序与网页程序。</p>
			<p>Windows 监控可以通过 Windows Automation API实现，通过程序控制，能够模拟人工操作软件，实现操作匹配返回结果实现自动化监控</p>
			<p>Web页面监控的方案就太多了，比较经典的是Webdriver衍生出的各种工具Selenium - Web Browser Automation最为出名。我通过这个工具模拟用户操作，例如用户注册，登陆，发帖，下单等等，然后匹配返回结果实现自动化监控与报警</p>
		</div>
		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp95"></a>22.1.3.3.3.4. 数据分析</h6></div></div></div>
			
			<p>通过数据分析，将故障消灭在故障发生前。举一个例子，开发人员忘记设置redis 时间，虽然程序一直完好工作，但redis内存不断增长，总一天会出现故障。</p>
			<p>我们通过采集redis状态信息，分析一段时间内数据变化发现了这个问题。</p>
		</div>
 		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp96"></a>22.1.3.3.3.5. 监控与开发</h6></div></div></div>
			
			<p>谈到监控很多人认为这是运维的事情，实则不然，不懂运维的测试不是好开发。</p>
			<p>开发过程中需要考虑到监控，例如Nginx的status模块， MySQL的show status命令, Redis的info命令，都是为监控预留的。那么你开发的程序是否考虑到了监控这块呢？</p>
			<p>你可以通过日志形式或者管道，再或者Socket将程序的运行状态提供给监控采集程序。</p>
		</div>		
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="summary"></a>22.1.3.3.4. 总结</h5></div></div></div>
		
		<p>好的监控的能让你对系统了如指掌，做到心里有数。有数据才好说话。</p>
	</div>
</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="itsm.configuration"></a>22.1.4. Configuration Management(配置管理)</h3></div></div></div>
		
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="itsm.change"></a>22.1.5. Change Management(变更管理)</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp97"></a>22.1.5.1. 变更方案</h4></div></div></div>
			
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp98"></a>22.1.5.2. 回退计划</h4></div></div></div>
			
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp99"></a>22.1.5.3. 变更评估</h4></div></div></div>
			
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp100"></a>22.1.5.4. 变更授权</h4></div></div></div>
			
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp101"></a>22.1.5.5. 过程记录</h4></div></div></div>
			
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp102"></a>22.1.5.6. 结果回顾</h4></div></div></div>
			
		</div>
		
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="move"></a>22.1.5.7. 机房迁移</h4></div><div><h5 class="subtitle"></h5></div></div></div>
	
	
	
	<p>总结一下5年前的工作，在不写下来自己都快忘光了，工作关系现在已经不涉及运维这块的工作。</p>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="topology"></a>22.1.5.7.1. 拓扑确立</h5></div></div></div>
		
		<p>首先制定服务器拓扑图，拓扑图应该有两套，一套是物理拓扑图，另一套是基于业务的虚拟拓扑图。</p>
		<p>物理拓扑图包含机柜，机位，例如防火墙，核心交换机，机柜交换机，服务器，存储等等他们之间的物理关系。如果是云主机也许标注出来。</p>
		<p>接下来分配IP地址以及服务端口号</p>
		<p>最后制定虚拟拓扑图，是各种服务间的关系图，由IP地址和端口组成，标住出他们之间的关系。</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="storage"></a>22.1.5.7.2. 存储规划</h5></div></div></div>
		
		<p>什么东西放在什么地方，怎么规划空间等等。</p>
		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp103"></a>22.1.5.7.2.1. RAID Disk Group 规划</h6></div></div></div>
			
			<p>根据不同用途使用不同的RAID，这主要跟IO密集都与数据安全性有关。</p>
			<p>Virtual Disk 技术很有用，我使用这种技术两RAID划分为两个设备，一个用来安装操作系统，另一个用于数据存储，方便系统重做。</p>
			<p>SSD 机械故障为零，整体故障率低于传统硬盘。我通常做RAID0用与负载均衡场景。</p>
		</div>
		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp104"></a>22.1.5.7.2.2. 文件系统规划</h6></div></div></div>
			
			<p>我通常使用btrfs，LVM/EXT4已经过时。</p>
			<p>/ 分区EXT4 安装操作系统，swap 分区不一定是内存2倍，因为现在的服务器都是8~16GB，OS很少能使用到交换分区，但是像Oracle这样强制交换分区为内存两倍。</p>
			<p>其余所有空间分区格式化为btrfs mount 到 /srv 目录，在通过子卷(subvolume)分配给各个应用。</p>
			<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[提示]" src="/graphics/tip.png" /></td><th align="left">提示</th></tr><tr><td align="left" valign="top">子卷(subvolume) 有个特点是不能rm -rf 删除子卷的，也起到一定的安全性。</td></tr></table></div>
		</div>
		<div class="section"><div class="titlepage"><div><div><h6 class="title"><a id="idp105"></a>22.1.5.7.2.3. 目录规划</h6></div></div></div>
			
			<p>以Tomcat为例</p>
			<p>Tomcat 的虚拟机功能基本没用，因为需要升级需要频繁启动，会影响其他业务，所以采用每个项目一个实例的方式。</p>
			<pre class="screen">
			
/srv/apache-tomcat/ 是Tomcat目录
/srv/apache-tomcat/www.netkiller.cn 每个实例一个目录
/srv/apache-tomcat/other.netkiller.cn
			
			</pre>
			<p>以PHP为例</p>
			<pre class="screen">
/srv/php-7.0.0
ln -s /srv/php-7.0.0 /srv/php
			</pre>
			<p>通过 /srv/php 符号链接可以任意切换PHP版本</p>
			<p>代码目录与服务器目录分开</p>
			<pre class="screen">
			
/www/netkiller.cn/www.netkiller.cn
/www/netkiller.cn/other.netkiller.cn
			
			</pre>
		</div>		
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="device"></a>22.1.5.7.3. 设备上架</h5></div></div></div>
		
		<p>按照物理图谱图，对应机位安装设备，链接网线，整理机柜。</p>
		<p>注意强弱电分离，以免强电磁场干扰弱电。以Dell系列服务器为例，电源通常在右边，网口在中间左边，这样电源走机会右侧理线架，网线走左侧理线架。</p>
		<p>我通常每个机柜放两台千兆交换机，一台放在机柜最顶端，通过10GB万兆以太网链接至核心交换机，走核心业务数据；另一台放在机柜最底端，负责其他次要业务，例如远程控制口，数据库备份等等。</p>
		<p>上电，接通电源，开机。观察机柜的电压/电流变化。</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="os"></a>22.1.5.7.4. 操作系统初始化</h5></div></div></div>
		
		<p>安装操作系统，系统裁剪，内核优化，时区设置，配置history格式（记录每条发出命令的时间点），TCP栈优化</p>
		<p>安装自动化运维客户端，监控客户端</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="application"></a>22.1.5.7.5. 服务器及运行环境</h5></div></div></div>
		
		<p>通过脚本或者自动化运维工具按照并配置。</p>
		<p>安装各种服务器软件如 nginx, apache-httpd, apache-tomcat ......</p>
		<p>软件运行环境，例如Java，PHP, Node.js, Ruby, Python ......</p>
		<p>安装数据库，配置复制策略，备份计划</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="deployment"></a>22.1.5.7.6. 部署应用程序</h5></div></div></div>
		
		<p>配置管理员通过虚拟拓扑提供的IP地址，端口号以及运维提供的账号密码配置应用程序。</p>
		<p>然后部署应用程序到远程服务器</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="monitor"></a>22.1.5.7.7. 监控系统</h5></div></div></div>
		
		<p>应用程序部署完毕后不要急着测试，可能很多IP地址以及端口不通，这时候测试只能是频繁报BUG。</p>
		<p>我们先让将监控系统建立起来，监控所有服务器IP地址与端口，以及各种应用服务监控。</p>
		<p>硬件监控: 温度监控，风扇监控，RAID卡监控，内存监控，PCI设备监控...</p>
		<p>操作监控：负载，CPU，内存，用户登陆监控，磁盘空间监控，网络流量监控，TCP/IP状态监控，进程数量，线程监控，僵尸进程，进程退出...</p>
		<p>服务器监控：连接数，线程数，进程数，内存开销，节点状态...</p>
		<p>日志监控：如果监控到日志中出现某些关键次，发出警报。</p>
		<p>服务监控：HTTP，SMTP，POP，AJAX/JSON，XML</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="log"></a>22.1.5.7.8. 日志中心</h5></div></div></div>
		
		<p>所有的日志应该实时同步到日志中心，便于开发与测试人员实时观察服务器的状态</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="test"></a>22.1.5.7.9. 测试</h5></div></div></div>
		
		<p>当我们看到监控系统报表中的各种服务器都畅通无阻时就可以进行验收测试，测试的时候需要关注监控系统的图标，与日志中心的日志变化。</p>
		<p>安全测试：硬件防火墙规则，服务器防火墙规则，SSL证书，服务器版本号隐藏，操作系统权限检查</p>
		<p>压力与性能测试</p>
		<p>业务功能测试</p>
	</div>
</div>
	</div>
	






	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="itsm.training"></a>22.1.6. 内部培训</h3></div></div></div>
		
		<p>团队培训，指定培训计划等</p>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="itsm.resource"></a>22.1.7. IT资源管理</h3></div></div></div>
		
		
	</div>
	
</div>



</div><div xmlns="" id="disqus_thread"></div><script xmlns="">

var disqus_config = function () {
this.page.url = "http://www.netkiller.cn";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'netkiller'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//netkiller.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><noscript xmlns="">Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><br xmlns="" /><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="../project/purchasing.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="../management.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="delivery.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">21.11. 采购管理 </td><td width="20%" align="center"><a accesskey="h" href="../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 22.2. Service Delivery Set(服务实施系列)</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><script xmlns="" type="text/javascript" src="/js/q.js" async="async"></script></body></html>