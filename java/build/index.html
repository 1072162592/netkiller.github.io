<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 2 章 Build Tools</title><link rel="stylesheet" type="text/css" href="..//docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="../index.html" title="Netkiller Java 手札" /><link rel="up" href="../index.html" title="Netkiller Java 手札" /><link rel="prev" href="../java/network.html" title="1.5. Network" /><link rel="next" href="ivy.html" title="2.2. Apache Ivy" /></head><body><a xmlns="" href="http://www.netkiller.cn/">Home</a> |
		<a xmlns="" href="http://netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="/search.html">Search</a> |
	    <a xmlns="" href="http://netkiller-github-com.iteye.com/">ITEYE 博客</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://zb.oschina.net/profile/725072/market">作品与服务</a> |
		<a xmlns="" href="mailto:netkiller@msn.com">Email</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 2 章 Build Tools</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../java/network.html">上一页</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ivy.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="http://ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="http://ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="http://ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td></tr></table><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="index"></a>第 2 章 Build Tools</h1></div></div></div><div class="toc"><p><strong>目录</strong></p><dl class="toc"><dt><span class="section"><a href="index.html#ant">2.1. Apache Ant</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idm45232600372928">2.1.1. Project</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idm45232600370592">2.1.1.1. ant</a></span></dt><dt><span class="section"><a href="index.html#environment">2.1.1.2. environment</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#path">2.1.2. path</a></span></dt><dt><span class="section"><a href="index.html#copy">2.1.3. copy</a></span></dt><dt><span class="section"><a href="index.html#javac">2.1.4. javac</a></span></dt><dt><span class="section"><a href="index.html#condition">2.1.5. condition</a></span></dt><dt><span class="section"><a href="index.html#exec">2.1.6. exec</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idm45232600351248">2.1.6.1. sshexec</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#if">2.1.7. if</a></span></dt><dt><span class="section"><a href="index.html#macrodef">2.1.8. macrodef</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idm45232600342816">2.1.8.1. Git</a></span></dt><dt><span class="section"><a href="index.html#idm45232600339968">2.1.8.2. Rsync</a></span></dt><dt><span class="section"><a href="index.html#idm45232600337536">2.1.8.3. SSH</a></span></dt><dt><span class="section"><a href="index.html#maven">2.1.8.4. maven</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#javascript">2.1.9. Javascript</a></span></dt><dt><span class="section"><a href="index.html#faq">2.1.10. FAQ</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idm45232600328880">2.1.10.1. warning: 'includeantruntime' was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="ivy.html">2.2. Apache Ivy</a></span></dt><dd><dl><dt><span class="section"><a href="ivy.html#idm45232600324048">2.2.1. Ivy Install</a></span></dt><dd><dl><dt><span class="section"><a href="ivy.html#idm45232600323408">2.2.1.1. source code</a></span></dt><dt><span class="section"><a href="ivy.html#idm45232600320784">2.2.1.2. apt-get</a></span></dt></dl></dd><dt><span class="section"><a href="ivy.html#idm45232600318480">2.2.2. Test example</a></span></dt></dl></dd><dt><span class="section"><a href="maven.html">2.3. maven</a></span></dt><dd><dl><dt><span class="section"><a href="maven.html#install">2.3.1. 安装</a></span></dt><dd><dl><dt><span class="section"><a href="maven.html#idm45232600306576">2.3.1.1. Ubuntu</a></span></dt><dt><span class="section"><a href="maven.html#idm45232600304656">2.3.1.2. 源码安装</a></span></dt></dl></dd><dt><span class="section"><a href="maven.html#mvnrepository">2.3.2. Maven 仓库</a></span></dt><dt><span class="section"><a href="maven.html#pom.xml">2.3.3. pom.xml</a></span></dt><dd><dl><dt><span class="section"><a href="maven.html#properties">2.3.3.1. properties</a></span></dt><dt><span class="section"><a href="maven.html#dependencies">2.3.3.2. dependencies</a></span></dt></dl></dd><dt><span class="section"><a href="maven.html#idm45232600290320">2.3.4. Maven 命令</a></span></dt><dd><dl><dt><span class="section"><a href="maven.html#clean">2.3.4.1. clean</a></span></dt><dt><span class="section"><a href="maven.html#idm45232600287472">2.3.4.2. compile</a></span></dt><dt><span class="section"><a href="maven.html#package">2.3.4.3. package</a></span></dt><dt><span class="section"><a href="maven.html#idm45232600283312">2.3.4.4. install</a></span></dt></dl></dd><dt><span class="section"><a href="maven.html#dependency">2.3.5. dependency</a></span></dt><dd><dl><dt><span class="section"><a href="maven.html#idm45232600280256">2.3.5.1. build-classpath</a></span></dt><dt><span class="section"><a href="maven.html#tree">2.3.5.2. dependency:tree 显示包依赖树</a></span></dt><dt><span class="section"><a href="maven.html#copy-dependencies">2.3.5.3. copy-dependencies 导出依赖包</a></span></dt><dt><span class="section"><a href="maven.html#analyze">2.3.5.4. analyze 查看未被使用的包</a></span></dt><dt><span class="section"><a href="maven.html#sources">2.3.5.5. sources 下载源码</a></span></dt></dl></dd><dt><span class="section"><a href="maven.html#help">2.3.6. help</a></span></dt><dt><span class="section"><a href="maven.html#plugins">2.3.7. plugins</a></span></dt><dd><dl><dt><span class="section"><a href="maven.html#idm45232600257552">2.3.7.1. maven-antrun-plugin</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="gradle.html">2.4. Gradle</a></span></dt><dd><dl><dt><span class="section"><a href="gradle.html#idm45232600247760">2.4.1. gradle 命令</a></span></dt><dd><dl><dt><span class="section"><a href="gradle.html#idm45232600246960">2.4.1.1. tasks 列出任务</a></span></dt></dl></dd><dt><span class="section"><a href="gradle.html#idm45232600242944">2.4.2. build.gradle</a></span></dt><dd><dl><dt><span class="section"><a href="gradle.html#idm45232600241328">2.4.2.1. repositories</a></span></dt><dt><span class="section"><a href="gradle.html#idm45232600239856">2.4.2.2. dependencies</a></span></dt><dt><span class="section"><a href="gradle.html#idm45232600238480">2.4.2.3. jar</a></span></dt></dl></dd><dt><span class="section"><a href="gradle.html#gradle.properties">2.4.3. gradle.properties</a></span></dt><dd><dl><dt><span class="section"><a href="gradle.html#idm45232600235744">2.4.3.1. 列出 properties</a></span></dt><dt><span class="section"><a href="gradle.html#idm45232600230400">2.4.3.2. 自定义 gradle.properties</a></span></dt><dt><span class="section"><a href="gradle.html#idm45232600226288">2.4.3.3. </a></span></dt><dt><span class="section"><a href="gradle.html#idm45232600225104">2.4.3.4. System.properties</a></span></dt></dl></dd><dt><span class="section"><a href="gradle.html#idm45232600222144">2.4.4. Example</a></span></dt></dl></dd></dl></div>
	
	
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ant"></a>2.1. Apache Ant</h2></div></div></div>
	
	<p><a class="ulink" href="http://ant.apache.org/" target="_top">http://ant.apache.org/</a></p>
	<pre class="screen">
cd /usr/local/src
wget http://mirror.bjtu.edu.cn/apache//ant/binaries/apache-ant-1.8.1-bin.tar.gz
tar zxvf apache-ant-1.8.1-bin.tar.gz
mv apache-ant-1.8.1 /usr/local/
cd ..
ln -s apache-ant-1.8.1 apache-ant
	</pre>
	<pre class="screen">
ANT_HOME=/usr/local/apache-ant
export CLASSPATH=$CLASSPATH:$ANT_HOME/lib
	</pre>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm45232600372928"></a>2.1.1. Project</h3></div></div></div>
		
		<p></p>
		<pre class="screen">
		
&lt;description&gt;project Name&lt;/description&gt;
		
		</pre>
		<pre class="screen">
		
&lt;property name="src" value="src"/&gt;
&lt;property name="dest" value="classes"/&gt;
&lt;property name="hello" value="hello.jar"/&gt;		
		
		</pre>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45232600370592"></a>2.1.1.1. ant</h4></div></div></div>
			
			<p>Project name</p>
			<pre class="screen">
			
${ant.project.name}
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="environment"></a>2.1.1.2. environment</h4></div></div></div>
			
			<pre class="screen">
			
&lt;property environment="env"/&gt;
&lt;echo message="JAVA_HOME is set to = ${env.JAVA_HOME}" /&gt;			
			
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="path"></a>2.1.2. path</h3></div></div></div>
		
		<p>定义</p>
		<pre class="screen">
		
	&lt;path id="classpath"&gt;  
        &lt;fileset dir="${env.JAVA_HOME}/lib"&gt;  
            &lt;include name="*.jar" /&gt;  
        &lt;/fileset&gt;  
        &lt;fileset dir="${env.CATALINA_HOME}/lib"&gt;  
            &lt;include name="*.jar" /&gt;  
        &lt;/fileset&gt;  
        &lt;fileset dir="WebRoot/WEB-INF/lib" includes="*.jar"/&gt;
    &lt;/path&gt;    
		
		</pre>
		<p>引用</p>
		<pre class="screen">
		
	&lt;javac srcdir="${src.dir}" destdir="${classes.dir}" source="1.5" target="1.5"&gt;  
		&lt;classpath refid="classpath" /&gt;  
	&lt;/javac&gt;		
		
		</pre>
		<p></p>
		<pre class="screen">
		
    &lt;classpath&gt;
		&lt;path refid="classpath"/&gt;
    &lt;/classpath&gt;		
		
		</pre>
	</div>
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="copy"></a>2.1.3. copy</h3></div></div></div>
		
		<p>复制目录</p>
		<pre class="screen">
		
	&lt;copy todir="${basedir}/WebContent"&gt; 
		&lt;fileset dir="${basedir}/WebRoot" includes="**/*"/&gt;
	&lt;/copy&gt;	    
		
		</pre>
		<p>复制指定扩展名文件</p>
		<pre class="screen">
		
	&lt;copy todir="${dest}"&gt;  
		&lt;fileset dir="${src}"&gt;  
			&lt;include name="**/*.xml" /&gt;  
			&lt;include name="**/*.properties" /&gt;  
		&lt;/fileset&gt;
	&lt;/copy&gt; 	
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="javac"></a>2.1.4. javac</h3></div></div></div>
		
		<pre class="screen">
		
	&lt;path id="classpath"&gt;
		&lt;fileset dir="${env.JAVA_HOME}/lib"&gt;
			&lt;include name="*.jar" /&gt;
		&lt;/fileset&gt;
		&lt;fileset dir="${env.CATALINA_HOME}/lib"&gt;
			&lt;include name="*.jar" /&gt;
		&lt;/fileset&gt;
		&lt;fileset dir="${project.dir}/WebRoot/WEB-INF/lib" includes="*.jar" /&gt;
	&lt;/path&gt;

	&lt;javac srcdir="${project.src}" destdir="${project.build}/WEB-INF/classes" debug="true" listfiles="true"&gt;
			&lt;classpath refid="classpath" /&gt;
			&lt;include name="**/*.java"/&gt;
			&lt;exclude name="**/*.xml"/&gt;
			&lt;exclude name="**/*.properties"/&gt;
	&lt;/javac&gt;
		
		</pre>
		<p>listfiles 显示编译文件列表</p>
		<p>debug 显示调试信息，编译错误信息</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="condition"></a>2.1.5. condition</h3></div></div></div>
		
		<p></p>
		<pre class="screen">
		
&lt;?xml version="1.0"?&gt;
&lt;project name="test" default="doFoo" basedir="."&gt;
  &lt;property name="directory" value="/www/directory"/&gt;

  &lt;target name="doFoo" depends="dir.check" if="dir.exists"&gt;
    &lt;echo&gt;${directory} exists&lt;/echo&gt;
  &lt;/target&gt;

  &lt;target name="doBar" depends="dir.check" unless="dir.exists"&gt;
    &lt;echo&gt;${directory} missing"&lt;/echo&gt;
  &lt;/target&gt;

  &lt;target name="dir.check"&gt;
    &lt;condition property="dir.exists"&gt;
      &lt;available file="${directory}" type="dir"/&gt;
    &lt;/condition&gt;
  &lt;/target&gt;
&lt;/project&gt;		
		
		</pre>		
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="exec"></a>2.1.6. exec</h3></div></div></div>
		
		<pre class="screen">
		
&lt;project name="{{ name }}" default="help" basedir="."&gt;
  
  &lt;property name="username" value="{{ username }}"/&gt;
  &lt;property name="host" value="{{ host }}"/&gt;
  &lt;property name="dir" value="/srv/{{ path }}/"/&gt;

  &lt;tstamp&gt;
    &lt;format property="TODAY_UK" pattern="yyyyMMddhhmmss" locale="en,UK"/&gt;
  &lt;/tstamp&gt;

  &lt;target name="help" description="show available commands" &gt;
    &lt;exec executable="ant" dir="." failonerror="true"&gt;
      &lt;arg value="-p"/&gt;
    &lt;/exec&gt;
  &lt;/target&gt;
  
  &lt;target name="deploy-to" description="show where we are deploying to" &gt;
    &lt;echo&gt;${username}@${host}:${dir}&lt;/echo&gt;
  &lt;/target&gt;

  &lt;target name="deploy" description="deploy usng rsync" &gt;
    &lt;exec executable="rsync" dir="." failonerror="true"&gt;
      &lt;arg value="-r"/&gt;
      &lt;arg value="."/&gt;
      &lt;arg value="${username}@${host}:${dir}"/&gt;
      &lt;arg value="--exclude-from=rsync.excludes"/&gt;
      &lt;arg value="-v"/&gt;
    &lt;/exec&gt;
  &lt;/target&gt;

  &lt;target name="deploy-test" description="test deploy usng rsync with the dry run flag set" &gt;
    &lt;exec executable="rsync" dir="." failonerror="true"&gt;
      &lt;arg value="-r"/&gt;
      &lt;arg value="."/&gt;
      &lt;arg value="${username}@${host}:${dir}"/&gt;
      &lt;arg value="--exclude-from=rsync.excludes"/&gt;
      &lt;arg value="--dry-run"/&gt;
      &lt;arg value="-v"/&gt;
    &lt;/exec&gt;
  &lt;/target&gt;

  &lt;target name="backup" description="backup site" &gt;
    &lt;exec executable="scp" dir="." failonerror="true"&gt;
      &lt;arg value="-r"/&gt;
      &lt;arg value="${username}@${host}:${dir}"/&gt;
      &lt;arg value="backups/${TODAY_UK}"/&gt;
    &lt;/exec&gt;
  &lt;/target&gt;

&lt;/project&gt;		
		
		</pre>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45232600351248"></a>2.1.6.1. sshexec</h4></div></div></div>
			
			<pre class="screen">
			
&lt;sshexec host="${remove}" keyfile="~/.ssh/id_rsa" command="/srv/apache-tomcat/bin/catalina.sh stop -force" /&gt;			
			
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="if"></a>2.1.7. if</h3></div></div></div>
		
		<pre class="screen">
		
		
&lt;if&gt;
  &lt;available file="my_directory" type="dir" /&gt;
  &lt;then&gt;
    &lt;echo message="Directory exists" /&gt;
  &lt;/then&gt;
  &lt;else&gt;
    &lt;echo message="Directory does not exist" /&gt;
  &lt;/else&gt;
&lt;/if&gt;		
		
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="macrodef"></a>2.1.8. macrodef</h3></div></div></div>
		
		<p>arg value 与 arg line</p>
		<p>arg line 可以处理参数的空格， 而arg value则不能. arg line 可以处理空参数， arg value传递空参数会报错.</p>
		<pre class="screen">
		
&lt;exec executable = "sh" dir = "@{dir}"&gt;
	&lt;arg line = "ls -l /var/log" /&gt;
&lt;/exec&gt;


&lt;exec executable = "ls" dir = "@{dir}"&gt;
	&lt;arg value = "-l" /&gt;
	&lt;arg value = "/var/log" /&gt;
&lt;/exec&gt;
		
		</pre>
		<pre class="screen">
		
        &lt;macrodef name="mvn"&gt;
                &lt;attribute name="options" default="" /&gt;
                &lt;attribute name="goal" default="" /&gt;
                &lt;attribute name="phase" default=" " /&gt;
                &lt;attribute name="dir" default="" /&gt;
                &lt;element name="args" optional="false" /&gt;
                &lt;sequential&gt;
                        &lt;exec executable="mvn" dir="@{dir}" &gt;
                                &lt;arg value="@{options}" /&gt;
                                &lt;arg value="@{goal}" /&gt;
                                &lt;arg value="@{phase}" /&gt;
                        &lt;/exec&gt;
                &lt;/sequential&gt;
        &lt;/macrodef&gt;

&lt;!-- 执行下面宏将会出错，你必须传递options，phase参数 --&gt;
&lt;mvn goal="package" dir="${project.dir}"/&gt;
&lt;!-- 将vale改为line后正常 --&gt;
		&lt;exec executable="mvn" dir="@{dir}" &gt;
                                &lt;arg line="@{options}" /&gt;
                                &lt;arg line="@{goal}" /&gt;
                                &lt;arg line="@{phase}" /&gt;
        &lt;/exec&gt;
		
		
		</pre>
		<p>运行方式sequential为顺序执行， parallel为并行执行。</p>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45232600342816"></a>2.1.8.1. Git</h4></div></div></div>
			
			<pre class="screen">
			
&lt;macrodef name = "git"&gt;
    &lt;attribute name = "command" /&gt;
    &lt;attribute name = "dir" default = "" /&gt;
    &lt;element name = "args" optional = "true" /&gt;
    &lt;sequential&gt;
        &lt;echo message = "git @{command}" /&gt;
        &lt;exec executable = "git" dir = "@{dir}"&gt;
            &lt;arg value = "@{command}" /&gt;
            &lt;args/&gt;
        &lt;/exec&gt;
    &lt;/sequential&gt;
&lt;/macrodef&gt;
&lt;macrodef name = "git-clone-pull"&gt;
    &lt;attribute name = "repository" /&gt;
    &lt;attribute name = "dest" /&gt;
    &lt;sequential&gt;
        &lt;git command = "clone"&gt;
            &lt;args&gt;
                &lt;arg value = "@{repository}" /&gt;
                &lt;arg value = "@{dest}" /&gt;
            &lt;/args&gt;
        &lt;/git&gt;
        &lt;git command = "pull" dir = "@{dest}" /&gt;
    &lt;/sequential&gt;
&lt;/macrodef&gt;
			
			</pre>
			
			<pre class="screen">
			
&lt;git command = "clone"&gt;
    &lt;args&gt;
        &lt;arg value = "git://github.com/280north/ojunit.git" /&gt;
        &lt;arg value = "ojunit" /&gt;
    &lt;/args&gt;
&lt;/git&gt;

&lt;git command = "pull" dir = "repository_path" /&gt;		

&lt;git-clone-pull repository="git://github.com/280north/ojunit.git" dest="ojunit" /&gt;	
			
			</pre>
			
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45232600339968"></a>2.1.8.2. Rsync</h4></div></div></div>
			
			<pre class="screen">
			
			
	&lt;macrodef name="rsync"&gt;
		&lt;attribute name="option" default="auzv" /&gt;
		&lt;attribute name="src" default="" /&gt;
		&lt;attribute name="dest" default="" /&gt;
		&lt;element name="args" optional="true" /&gt;
		&lt;sequential&gt;
			&lt;exec executable="rsync"&gt;
				&lt;arg value="@{option}" /&gt;
				&lt;arg value="@{src}" /&gt;
				&lt;arg value="@{dest}" /&gt;
				&lt;args /&gt;
			&lt;/exec&gt;
		&lt;/sequential&gt;
	&lt;/macrodef&gt;			
			
			
			</pre>
			<pre class="screen">
			
	&lt;target name="deploy" depends="compile"&gt;
		&lt;rsync option="-auzv" src="${project.dest}" dest="${remote}:${destination}"&gt;
			&lt;args&gt;
				&lt;arg value="-P" /&gt;
			&lt;/args&gt;
		&lt;/rsync&gt;
	&lt;/target&gt;			
			
			</pre>
			
		</div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45232600337536"></a>2.1.8.3. SSH</h4></div></div></div>
			
			<pre class="screen">
			
	&lt;macrodef name="ssh"&gt;
		&lt;attribute name="host" /&gt;
		&lt;attribute name="command" /&gt;
		&lt;attribute name="keyfile" default="~/.ssh/id_rsa" /&gt;
		&lt;element name="args" optional="true" /&gt;
		&lt;sequential&gt;
			&lt;exec executable="ssh"&gt;
				&lt;arg value="@{host}" /&gt;
				&lt;!-- arg value="-i @{keyfile}" / --&gt;
				&lt;args /&gt;
				&lt;arg value="@{command}" /&gt;
			&lt;/exec&gt;
		&lt;/sequential&gt;
	&lt;/macrodef&gt;
			
			</pre>
			<pre class="screen">
			
	&lt;target name="stop" depends=""&gt;
		&lt;!-- ssh host="${remote}" command="/srv/apache-tomcat/bin/catalina.sh stop -force" keyfile="~/.ssh/id_rsa" / --&gt;
		&lt;ssh host="${remote}" command="/srv/apache-tomcat/bin/shutdown.sh" /&gt;
	&lt;/target&gt;
	&lt;target name="start" depends=""&gt;
		&lt;ssh host="${remote}" command="/srv/apache-tomcat/bin/startup.sh" keyfile="~/.ssh/id_rsa" /&gt;
	&lt;/target&gt;		
			
			</pre>
			
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="maven"></a>2.1.8.4. maven</h4></div></div></div>
			
			<pre class="screen">
			
        &lt;macrodef name="mvn"&gt;
                &lt;attribute name="options" default="" /&gt;
                &lt;attribute name="goal" default="" /&gt;
                &lt;attribute name="phase" default=" " /&gt;
                &lt;attribute name="dir" default="" /&gt;
                &lt;element name="args" optional="false" /&gt;
                &lt;sequential&gt;
                        &lt;exec executable="mvn" dir="@{dir}" &gt;
                                &lt;arg line="@{options}" /&gt;
                                &lt;arg value="@{goal}" /&gt;
                                &lt;arg line="@{phase}" /&gt;
                        &lt;/exec&gt;
                &lt;/sequential&gt;
        &lt;/macrodef&gt;			
			
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="javascript"></a>2.1.9. Javascript</h3></div></div></div>
		
		<pre class="screen">
		

$ cat build.xml 
&lt;project name="Attachments" default="print"&gt;
    &lt;property name="numAttachments" value="20" /&gt;
    &lt;target name="generate"&gt;
        &lt;script language="javascript"&gt;&lt;![CDATA[
            var list = '1';
            var limit = project.getProperty( "numAttachments" );
            for (var i=2;i&lt;limit;i++)
            { 
                list = list + ',' + i;
            }
            project.setNewProperty("list", list);            
		print(list);
        ]] &gt;
        &lt;/script&gt;    
    &lt;/target&gt;
&lt;/project&gt;

		
		</pre>
		<pre class="screen">
		
$ ant generate
Buildfile: /www/testing/build.xml

generate:
   [script] 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19

BUILD SUCCESSFUL
Total time: 0 seconds
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="faq"></a>2.1.10. FAQ</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45232600328880"></a>2.1.10.1. warning: 'includeantruntime' was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds</h4></div></div></div>
			
			<p>includeantruntime="false"</p>
			<pre class="screen">
			
&lt;target name="compile" depends="init"&gt;
   &lt;javac includeantruntime="false" srcdir="${src}" destdir="${dest}"/&gt;
&lt;/target&gt;
			
			</pre>
			<p>or</p>
			<pre class="screen">
			
&lt;property name="build.sysclasspath" value="last"/&gt;
			
			</pre>
		</div>
	</div>
</div>




	

	

</div><div xmlns="" id="disqus_thread"></div><script xmlns="" type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

            //if(document.domain == 'netkiller.github.io'){
            var disqus_shortname = 'netkiller'; // required: replace example with your forum shortname
            //}else{
			//var disqus_shortname = 'neochan';
            //}

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script><noscript xmlns="">Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a xmlns="" href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a><br xmlns="" /><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="../java/network.html">上一页</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ivy.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">1.5. Network </td><td width="20%" align="center"><a accesskey="h" href="../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 2.2. Apache Ivy</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F997cd4a7320a82d72cb74d179118f697' type='text/javascript'%3E%3C/script%3E"));
</script><script xmlns="" type="text/javascript" src="/js/q.js"></script></body></html>