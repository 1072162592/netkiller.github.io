<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>以太坊私链入门</title><link rel="stylesheet" type="text/css" href="docbook.css"/><link rel="stylesheet" type="text/css" href="/journal/journal.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/><meta name="description" content="本文采用碎片化写作，原文会不定期更新，请尽量阅读原文。 http://www.netkiller.cn/journal/ethereum.html"/><meta name="keywords" content=", , , "/></head><body><section xml:lang="zh-cn" class="article" id="idp1"><div class="titlepage"><div><div><h2 class="title">以太坊私链入门</h2></div><div><h3 class="subtitle"><em>本文作者最近我在找工作，有意向致电 13113668890</em></h3></div><div><div class="author"><h3 class="author"><span class="honorific">Mr</span>. <span class="firstname">Neo Chen</span> <span class="surname">(陈景峯)</span>, <span class="lineage">netkiller, BG7NYT</span></h3><div class="affiliation">
			<div class="address"><p><br/>
				<span class="country">中国</span><span class="state">广东省</span><span class="city">深圳市</span><span class="street">龙华新区民治街道溪山美地</span><br/>
				<span class="postcode">518131</span><br/>
				<span class="phone">+86 13113668890</span><br/>
				<br/>
				<code class="email">&lt;<a class="email" href="mailto:netkiller@msn.com">netkiller@msn.com</a>&gt;</code><br/>
			</p></div>
		</div></div></div><div><div class="legalnotice" id="legalnotice">
	<p class="legalnotice-title"><strong>版权声明</strong></p>
	<p>转载请与作者联系，转载时请务必标明文章原始出处和作者信息及本声明。</p>
	<table style="border: 0; " class="simplelist"><tr><td>
		<a class="ulink" href="http://creativecommons.org/licenses/by/3.0/" target="_top">
			<div><table style="border: 0; width: 180px; cellpadding: 0; cellspacing: 0;"><tr><td><img src="/images/by-nc-sa.png" width="180"/></td></tr></table></div>
		</a>
		</td><td>
			<table style="border: 0; " class="simplelist"><tr><td>
					文档出处:
				</td></tr><tr><td>
					<a class="ulink" href="http://netkiller.github.io/" target="_top">http://netkiller.github.io</a>
				</td></tr><tr><td>
					<a class="ulink" href="http://netkiller.sourceforge.net/" target="_top">http://netkiller.sourceforge.net</a>
				</td></tr></table>
		</td><td>
			<a class="ulink" href="/images/weixin.jpg" target="_top"><div><table style="border: 0; width: 80px; cellpadding: 0; cellspacing: 0;"><tr><td><img src="/images/weixin.jpg" width="80"/></td></tr></table></div></a>
		</td><td>
			<p>微信扫描二维码进入 Netkiller 微信订阅号 </p>
			<p>QQ群：128659835 请注明“读者”</p>
		</td></tr></table>
	<p/>
</div></div><div><p class="pubdate">2018-02-02</p></div><div><div class="abstract"><div class="abstract-title">摘要</div>
			<p>本文采用碎片化写作，原文会不定期更新，请尽量阅读原文。</p>
			<p>
				<a class="ulink" href="http://www.netkiller.cn/journal/ethereum.html" target="_top">http://www.netkiller.cn/journal/ethereum.html</a>
			</p>
		</div></div></div><hr/></div><div class="toc"><div class="toc-title">目录</div><ul class="toc"><li><span class="section"><a href="#background">1. 背景</a></span></li><li><span class="section"><a href="#overview">2. 软件安装与配置</a></span><ul><li><span class="section"><a href="#ubuntu">2.1. Ubuntu</a></span><ul><li><span class="section"><a href="#geth">2.1.1. 安装 geth</a></span></li><li><span class="section"><a href="#solc">2.1.2. 安装 solc</a></span></li></ul></li><li><span class="section"><a href="#windows">2.2. Windows</a></span></li><li><span class="section"><a href="#">2.3. Mac OS</a></span></li><li><span class="section"><a href="#make">2.4. 编译安装</a></span></li></ul></li><li><span class="section"><a href="#genesis.json">3. 创世区块</a></span><ul><li><span class="section"><a href="#genesis.json.init">3.1. 初始化创世区块</a></span></li><li><span class="section"><a href="#genesis.json.startup">3.2. 启动节点</a></span><ul><li><span class="section"><a href="#rpcaddr">3.2.1. rpcaddr</a></span></li></ul></li><li><span class="section"><a href="#miner">3.3. 使用节点进行挖矿</a></span><ul><li><span class="section"><a href="#miner.start">3.3.1. 启动矿工开始挖矿</a></span></li><li><span class="section"><a href="#miner.stop">3.3.2. 停止挖矿</a></span></li><li><span class="section"><a href="#eth.getBalance">3.3.3. 查看所挖金额</a></span></li></ul></li></ul></li><li><span class="section"><a href="#geth">4. geth 命令</a></span><ul><li><span class="section"><a href="#geth.console">4.1. 控制台</a></span></li><li><span class="section"><a href="#geth.attach">4.2. 连接控制台</a></span></li><li><span class="section"><a href="#geth.account">4.3. 账号管理</a></span><ul><li><span class="section"><a href="#new">4.3.1. 新建账号</a></span></li><li><span class="section"><a href="#list">4.3.2. 查看账号</a></span></li></ul></li><li><span class="section"><a href="#rpc">4.4. rpc 相关参数</a></span></li><li><span class="section"><a href="#password">4.5. 配置自动解锁账号</a></span></li><li><span class="section"><a href="#geth.exec">4.6. 运行JS</a></span></li><li><span class="section"><a href="#geth.bootnodes">4.7. --bootnodes</a></span></li></ul></li><li><span class="section"><a href="#javascript.console">5. JavaScript Console</a></span><ul><li><span class="section"><a href="#personal">5.1. personal 管理</a></span><ul><li><span class="section"><a href="#personal.newAccount">5.1.1. 创建账号</a></span></li><li><span class="section"><a href="#personal.listAccounts">5.1.2. 显示账号</a></span></li></ul></li><li><span class="section"><a href="#eth">5.2. eth 管理</a></span><ul><li><span class="section"><a href="#eth.coinbase">5.2.1. 矿工账号</a></span></li><li><span class="section"><a href="#eth.getBalance">5.2.2. 余额</a></span><ul><li><span class="section"><a href="#">5.2.2.1. 单位转换</a></span></li><li><span class="section"><a href="#">5.2.2.2. 一次检查所有账号余额</a></span></li></ul></li><li><span class="section"><a href="#eth.sendTransaction">5.2.3. 转账</a></span></li><li><span class="section"><a href="#eth.blockNumber">5.2.4. 查看当前区块总数</a></span></li><li><span class="section"><a href="#eth.getBlock">5.2.5. 查看区块信息</a></span></li></ul></li><li><span class="section"><a href="#web3">5.3. web3</a></span><ul><li><span class="section"><a href="#">5.3.1. Ether币的基本单位</a></span><ul><li><span class="section"><a href="#web3.toWei">5.3.1.1. web3.toWei</a></span></li><li><span class="section"><a href="#web3.fromWei">5.3.1.2. web3.fromWei</a></span></li></ul></li></ul></li><li><span class="section"><a href="#admin">5.4. admin 管理</a></span><ul><li><span class="section"><a href="#">5.4.1. 节点管理</a></span><ul><li><span class="section"><a href="#admin.nodeInfo">5.4.1.1. 显示节点</a></span></li><li><span class="section"><a href="#admin.peers">5.4.1.2. 查看节点</a></span></li><li><span class="section"><a href="#admin.addPeer">5.4.1.3. 添加节点</a></span></li></ul></li></ul></li><li><span class="section"><a href="#miner">5.5. miner 挖矿管理</a></span><ul><li><span class="section"><a href="#miner.start">5.5.1. 开始挖矿</a></span></li><li><span class="section"><a href="#miner.stop">5.5.2. 停止挖矿</a></span></li></ul></li><li><span class="section"><a href="#txpool.status ">5.6. txpool 管理</a></span><ul><li><span class="section"><a href="#">5.6.1. txpool.status</a></span></li></ul></li></ul></li><li><span class="section"><a href="#solidity">6. 智能合约</a></span><ul><li><span class="section"><a href="#">6.1. browser-solidity</a></span></li></ul></li><li><span class="section"><a href="#web3j">7. Jave Client</a></span><ul><li><span class="section"><a href="#pom.xml">7.1. Maven pom.xml 文件</a></span></li><li><span class="section"><a href="#connect">7.2. 连接到服务器获取版本号</a></span></li><li><span class="section"><a href="#account">7.3. </a></span><ul><li><span class="section"><a href="#">7.3.1. 获得账号列表</a></span></li><li><span class="section"><a href="#">7.3.2. 获得账号信息</a></span></li><li><span class="section"><a href="#">7.3.3. 获取余额</a></span></li><li><span class="section"><a href="#">7.3.4. </a></span></li><li><span class="section"><a href="#web3j.account.example">7.3.5. 例子</a></span></li></ul></li><li><span class="section"><a href="#Credentials">7.4. Credentials</a></span></li></ul></li><li><span class="section"><a href="#summary">8. 总结</a></span></li><li><span class="section"><a href="#faq">9. FAQ</a></span><ul><li><span class="section"><a href="#">9.1. Error: authentication needed: password or unlock</a></span></li></ul></li></ul></div>
	
	<section class="section" id="background"><div class="titlepage"><div><div><h2 class="title" style="clear: both">1. 背景</h2></div></div></div>
		
		<p>区块链是什么？一句话，它是一种特殊的（非关系型）分布式数据库，这种数据库只能做插入和查找操作，并且没有管理员。</p>
		<p>首先，区块链的主要作用是储存信息。任何需要保存的信息，都可以写入区块链，也可以从里面读取，所以它是数据库。</p>
		<p>其次，任何人都可以架设服务器，加入区块链网络，成为一个节点。区块链的世界里面，没有中心节点，每个节点都是平等的，都保存着整个数据库。你可以向任何一个节点，写入/读取数据，因为所有节点最后都会同步，保证区块链一致。</p>
	</section>

	<section class="section" id="overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both">2. 软件安装与配置</h2></div></div></div>
		
		<section class="section" id="ubuntu"><div class="titlepage"><div><div><h3 class="title">2.1. Ubuntu</h3></div></div></div>
			
			<section class="section" id="geth"><div class="titlepage"><div><div><h4 class="title">2.1.1. 安装 geth</h4></div></div></div>
				
				<p>安装环境</p>
				<div class="literallayout"><p><br/>
				<br/>
Ubuntu 17.10				<br/>
				<br/>
				</p></div>
				<pre class="screen">
				
sudo apt upgrade -y				
sudo apt install software-properties-common
sudo add-apt-repository -y ppa:ethereum/ethereum
sudo apt update
sudo apt install ethereum			
				
				</pre>
				<pre class="screen">
				
neo@netkiller ~ % geth version
Geth
Version: 1.7.3-stable
Git Commit: 4bb3c89d44e372e6a9ab85a8be0c9345265c763a
Architecture: amd64
Protocol Versions: [63 62]
Network Id: 1
Go Version: go1.9.1
Operating System: linux
GOPATH=
GOROOT=/usr/lib/go-1.9
				
				</pre>

			</section>
			<section class="section" id="solc"><div class="titlepage"><div><div><h4 class="title">2.1.2. 安装 solc</h4></div></div></div>
				
				<pre class="screen">
				
sudo apt install solc -y
				
				</pre>
				<pre class="screen">
				
neo@netkiller ~ % solc --version
solc, the solidity compiler commandline interface
Version: 0.4.19+commit.c4cbbb05.Linux.g++				
				
				</pre>
			</section>
		</section>
		<section class="section" id="windows"><div class="titlepage"><div><div><h3 class="title">2.2. Windows</h3></div></div></div>
			
			<pre class="screen">
				
访问 https://geth.ethereum.org/downloads/
下载并安装 Geth for Windows				
				
			</pre>
		</section>
		<section class="section" id=""><div class="titlepage"><div><div><h3 class="title">2.3. Mac OS</h3></div></div></div>
			
			<pre class="screen">
				
brew update
brew upgrade				
brew tap ethereum/ethereum
brew install ethereum
				
			</pre>
		</section>
		<section class="section" id="make"><div class="titlepage"><div><div><h3 class="title">2.4. 编译安装</h3></div></div></div>
			
			<pre class="screen">
				
git clone https://github.com/ethereum/go-ethereum
sudo apt-get install -y build-essential golang
cd go-ethereum
make geth				
				
			</pre>


		</section>

	</section>
	<section class="section" id="genesis.json"><div class="titlepage"><div><div><h2 class="title" style="clear: both">3. 创世区块</h2></div></div></div>
		
		<pre class="screen">
		
cd ~
mkdir -p ethereum
cd ethereum		
		
		</pre>
		<section class="section" id="genesis.json.init"><div class="titlepage"><div><div><h3 class="title">3.1. 初始化创世区块</h3></div></div></div>
			
			<p>创建文件 genesis.json</p>
			<pre class="screen">
			
{
  "nonce": "0x0000000000000042",
  "difficulty": "0x020000",
  "mixhash": "0x0000000000000000000000000000000000000000000000000000000000000000",
  "coinbase": "0x0000000000000000000000000000000000000000",
  "timestamp": "0x00",
  "parentHash": "0x0000000000000000000000000000000000000000000000000000000000000000",
  "extraData": "0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa",
  "gasLimit": "0x4c4b40",
  "config": {
      "chainId": 15,
      "homesteadBlock": 0,
      "eip155Block": 0,
      "eip158Block": 0
  },
  "alloc": { }
}
			
			</pre>
			<div class="literallayout"><p><br/>
			<br/>
mixhash: 与nonce配合用于挖矿，由上一个区块的一部分生成的hash。注意他和nonce的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。.<br/>
<br/>
nonce: nonce就是一个64位随机数，用于挖矿，注意他和mixhash的设置需要满足以太坊的Yellow paper, 4.3.4. Block Header Validity, (44)章节所描述的条件。<br/>
<br/>
difficulty: 设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度<br/>
<br/>
alloc: 用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以。<br/>
<br/>
coinbase: 矿工的账号，随便填<br/>
<br/>
timestamp: 设置创世块的时间戳<br/>
<br/>
parentHash: 上一个区块的hash值，因为是创世块，所以这个值是0<br/>
<br/>
extraData: 附加信息，随便填，可以填你的个性信息<br/>
<br/>
gasLimit: 该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们是私有链，所以填最大。		<br/>
			<br/>
			</p></div>
			<p>初始化创世区块</p>
			<pre class="screen">
			
neo@netkiller ~/ethereum % geth init genesis.json 
WARN [01-19|17:35:17] No etherbase set and no accounts found as default 
INFO [01-19|17:35:17] Allocated cache and file handles         database=/home/neo/.ethereum/geth/chaindata cache=16 handles=16
INFO [01-19|17:35:17] Writing custom genesis block 
INFO [01-19|17:35:17] Successfully wrote genesis state         database=chaindata                          hash=611596…424d04
INFO [01-19|17:35:17] Allocated cache and file handles         database=/home/neo/.ethereum/geth/lightchaindata cache=16 handles=16
INFO [01-19|17:35:18] Writing custom genesis block 
INFO [01-19|17:35:18] Successfully wrote genesis state         database=lightchaindata                          hash=611596…424d04		
			
			</pre>
			<p>默认目录是 /home/neo/.ethereum/ 你可以通过 --datadir 参数指定目录</p>
			<pre class="screen">
			
neo@netkiller ~/ethereum % geth --datadir data init genesis.json
WARN [01-19|17:38:16] No etherbase set and no accounts found as default 
INFO [01-19|17:38:16] Allocated cache and file handles         database=/home/neo/ethereum/data/geth/chaindata cache=16 handles=16
INFO [01-19|17:38:17] Writing custom genesis block 
INFO [01-19|17:38:17] Successfully wrote genesis state         database=chaindata                              hash=611596…424d04
INFO [01-19|17:38:17] Allocated cache and file handles         database=/home/neo/ethereum/data/geth/lightchaindata cache=16 handles=16
INFO [01-19|17:38:17] Writing custom genesis block 
INFO [01-19|17:38:17] Successfully wrote genesis state         database=lightchaindata                              hash=611596…424d04		

neo@netkiller ~/ethereum % find data 
data
data/keystore
data/geth
data/geth/chaindata
data/geth/chaindata/LOCK
data/geth/chaindata/LOG
data/geth/chaindata/MANIFEST-000000
data/geth/chaindata/CURRENT
data/geth/chaindata/000001.log
data/geth/lightchaindata
data/geth/lightchaindata/LOCK
data/geth/lightchaindata/LOG
data/geth/lightchaindata/MANIFEST-000000
data/geth/lightchaindata/CURRENT
data/geth/lightchaindata/000001.log		
			
			</pre>
			<p>目录结构</p>
			<pre class="screen">
			
data
├── geth
│  ├── chaindata
│  │  ├── 000001.log
│  │  ├── CURRENT
│  │  ├── LOCK
│  │  ├── LOG
│  │  └── MANIFEST-000000
│  └── lightchaindata
│      ├── 000001.log
│      ├── CURRENT
│      ├── LOCK
│      ├── LOG
│      └── MANIFEST-000000
└── keystore		
		
			</pre>
		</section>
		<section class="section" id="genesis.json.startup"><div class="titlepage"><div><div><h3 class="title">3.2. 启动节点</h3></div></div></div>
			
			<pre class="screen">
			
neo@netkiller ~/ethereum % geth --networkid 123456 --rpc --rpccorsdomain "*" --nodiscover console 
WARN [01-19|17:47:06] No etherbase set and no accounts found as default 
INFO [01-19|17:47:06] Starting peer-to-peer node               instance=Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.1
INFO [01-19|17:47:06] Allocated cache and file handles         database=/home/neo/.ethereum/geth/chaindata cache=128 handles=1024
INFO [01-19|17:47:06] Initialised chain configuration          config="{ChainID: 15 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Byzantium: &lt;nil&gt; Engine: unknown}"
INFO [01-19|17:47:06] Disk storage enabled for ethash caches   dir=/home/neo/.ethereum/geth/ethash count=3
INFO [01-19|17:47:06] Disk storage enabled for ethash DAGs     dir=/home/neo/.ethash               count=2
INFO [01-19|17:47:06] Initialising Ethereum protocol           versions="[63 62]" network=123456
INFO [01-19|17:47:06] Loaded most recent local header          number=0 hash=611596…424d04 td=131072
INFO [01-19|17:47:06] Loaded most recent local full block      number=0 hash=611596…424d04 td=131072
INFO [01-19|17:47:06] Loaded most recent local fast block      number=0 hash=611596…424d04 td=131072
INFO [01-19|17:47:06] Loaded local transaction journal         transactions=0 dropped=0
INFO [01-19|17:47:06] Regenerated local transaction journal    transactions=0 accounts=0
INFO [01-19|17:47:06] Starting P2P networking 
INFO [01-19|17:47:06] RLPx listener up                         self="enode://9f6490ffb5236f2ddc5710ae73d47c740e0a3644bbd2d67029cf4a6c4693d2f470b642fd2cc3507f7e851df60aaeb730a1270b7a477f91ec5b6b17a8a4b40527@[::]:30303?discport=0"
INFO [01-19|17:47:06] IPC endpoint opened: /home/neo/.ethereum/geth.ipc 
INFO [01-19|17:47:06] HTTP endpoint opened: http://127.0.0.1:8545 
Welcome to the Geth JavaScript console!

instance: Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.1
 modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0

&gt; INFO [01-19|17:47:09] Mapped network port                      proto=tcp extport=30303 intport=30303 interface="UPNP IGDv1-IP1"			
			
			</pre>
			<div class="literallayout"><p><br/>
			<br/>
identity: 区块链的标示，随便填写，用于标示目前网络的名字<br/>
<br/>
init: 指定创世块文件的位置，并创建初始块<br/>
<br/>
datadir: 设置当前区块链网络数据存放的位置<br/>
<br/>
port: 网络监听端口<br/>
<br/>
rpc: 启动rpc通信，可以进行智能合约的部署和调试<br/>
<br/>
rpcapi: 设置允许连接的rpc的客户端，一般为db,eth,net,web3<br/>
<br/>
networkid: 设置当前区块链的网络ID，用于区分不同的网络，是一个数字<br/>
<br/>
console: 启动命令行模式，可以在Geth中执行命令			<br/>
			<br/>
			</p></div>
			<section class="section" id="rpcaddr"><div class="titlepage"><div><div><h4 class="title">3.2.1. rpcaddr</h4></div></div></div>
				
				<p>默认是 127.0.0.1 </p>
				<p>HTTP endpoint closed: http://127.0.0.1:8545</p>
				<p>通过 --rpcaddr="0.0.0.0" 指定监听地址</p>
				<p>HTTP endpoint opened: http://0.0.0.0:8545</p>
				<pre class="screen">
				
neo@netkiller ~/ethereum % geth --networkid 123456 --rpc --rpcaddr="0.0.0.0" --rpccorsdomain "*" --nodiscover console  
INFO [01-20|01:41:33] Starting peer-to-peer node               instance=Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.1
INFO [01-20|01:41:33] Allocated cache and file handles         database=/home/neo/.ethereum/geth/chaindata cache=128 handles=1024
INFO [01-20|01:41:34] Initialised chain configuration          config="{ChainID: 15 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Byzantium: &lt;nil&gt; Engine: unknown}"
INFO [01-20|01:41:34] Disk storage enabled for ethash caches   dir=/home/neo/.ethereum/geth/ethash count=3
INFO [01-20|01:41:34] Disk storage enabled for ethash DAGs     dir=/home/neo/.ethash               count=2
INFO [01-20|01:41:34] Initialising Ethereum protocol           versions="[63 62]" network=123456
INFO [01-20|01:41:34] Loaded most recent local header          number=531 hash=1a2707…3a27bc td=79083846
INFO [01-20|01:41:34] Loaded most recent local full block      number=531 hash=1a2707…3a27bc td=79083846
INFO [01-20|01:41:34] Loaded most recent local fast block      number=531 hash=1a2707…3a27bc td=79083846
INFO [01-20|01:41:34] Loaded local transaction journal         transactions=0 dropped=0
INFO [01-20|01:41:34] Regenerated local transaction journal    transactions=0 accounts=0
WARN [01-20|01:41:34] Blockchain not empty, fast sync disabled 
INFO [01-20|01:41:34] Starting P2P networking 
INFO [01-20|01:41:34] RLPx listener up                         self="enode://9f6490ffb5236f2ddc5710ae73d47c740e0a3644bbd2d67029cf4a6c4693d2f470b642fd2cc3507f7e851df60aaeb730a1270b7a477f91ec5b6b17a8a4b40527@[::]:30303?discport=0"
INFO [01-20|01:41:34] IPC endpoint opened: /home/neo/.ethereum/geth.ipc 
INFO [01-20|01:41:34] HTTP endpoint opened: http://0.0.0.0:8545 
Welcome to the Geth JavaScript console!

instance: Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.1
coinbase: 0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6
at block: 531 (Tue, 14 Nov 2017 17:36:05 HST)
 datadir: /home/neo/.ethereum
 modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0

&gt; INFO [01-20|01:41:40] Mapped network port                      proto=tcp extport=30303 intport=30303 interface="UPNP IGDv1-IP1"
				
				</pre>
			</section>
		</section>
		<section class="section" id="miner"><div class="titlepage"><div><div><h3 class="title">3.3. 使用节点进行挖矿</h3></div></div></div>
			
			<section class="section" id="miner.start"><div class="titlepage"><div><div><h4 class="title">3.3.1. 启动矿工开始挖矿</h4></div></div></div>
				
				<pre class="screen">
				
&gt; miner.start(1)		
				
				</pre>
				<p>这里的1表示只使用一个线程运行,第一次运行时将开始创建DAG文件，只需等待进度条到100，则将开始挖矿。
					实际你看到的挖矿速度很快，这是因为我们已经在初始化创世区块时配置为:"nonce": "0x0000000000000042"。
					“0x42”难度能让你在私有测试网链上快速挖以太币。</p>
				<div class="tip"><h3 class="title">提示</h3>
					<p>挖矿时必然有矿工账户，而系统默认使用创建的第一个账号。</p>
				</div>
				<pre class="screen">
				
&gt; miner.start(1)
INFO [01-19|21:06:43] Updated mining threads                   threads=1
INFO [01-19|21:06:43] Transaction pool price threshold updated price=18000000000
INFO [01-19|21:06:43] Starting mining operation 
null
&gt; INFO [01-19|21:06:43] Commit new mining work                   number=1 txs=0 uncles=0 elapsed=717.552µs
INFO [01-19|21:06:46] Generating ethash verification cache     epoch=0 percentage=91 elapsed=3.000s
INFO [01-19|21:06:46] Generated ethash verification cache      epoch=0 elapsed=3.273s
INFO [01-19|21:06:51] Generating DAG in progress               epoch=0 percentage=0  elapsed=5.056s
INFO [01-19|21:06:56] Generating DAG in progress               epoch=0 percentage=1  elapsed=10.140s
INFO [01-19|21:07:01] Generating DAG in progress               epoch=0 percentage=2  elapsed=15.119s
INFO [01-19|21:07:06] Generating DAG in progress               epoch=0 percentage=3  elapsed=19.924s
INFO [01-19|21:07:11] Generating DAG in progress               epoch=0 percentage=4  elapsed=24.739s
INFO [01-19|21:07:16] Generating DAG in progress               epoch=0 percentage=5  elapsed=29.473s
INFO [01-19|21:07:22] Generating DAG in progress               epoch=0 percentage=6  elapsed=35.641s
INFO [01-19|21:07:26] Generating DAG in progress               epoch=0 percentage=7  elapsed=40.374s
INFO [01-19|21:07:31] Generating DAG in progress               epoch=0 percentage=8  elapsed=45.134s
INFO [01-19|21:07:36] Generating DAG in progress               epoch=0 percentage=9  elapsed=49.908s
INFO [01-19|21:07:41] Generating DAG in progress               epoch=0 percentage=10 elapsed=54.633s	
......
......
......
INFO [01-19|21:22:43] Generated ethash verification cache      epoch=0 elapsed=15m57.328s
INFO [01-19|21:22:47] Generating ethash verification cache     epoch=1 percentage=17 elapsed=3.031s
INFO [01-19|21:22:50] Generating ethash verification cache     epoch=1 percentage=34 elapsed=6.056s
INFO [01-19|21:22:53] Generating ethash verification cache     epoch=1 percentage=49 elapsed=9.562s
INFO [01-19|21:22:57] Generating ethash verification cache     epoch=1 percentage=70 elapsed=13.115s
INFO [01-19|21:23:00] Generating ethash verification cache     epoch=1 percentage=90 elapsed=16.123s
INFO [01-19|21:23:01] Generated ethash verification cache      epoch=1 elapsed=17.576s
INFO [01-19|21:23:19] Generating DAG in progress               epoch=1 percentage=0  elapsed=18.198s
INFO [01-19|21:23:32] Successfully sealed new block            number=1 hash=e2b5b9…9b1bfe
INFO [01-19|21:23:32] 🔨 mined potential block                  number=1 hash=e2b5b9…9b1bfe
INFO [01-19|21:23:32] Commit new mining work                   number=2 txs=0 uncles=0 elapsed=1.188ms
INFO [01-19|21:23:37] Generating DAG in progress               epoch=1 percentage=1  elapsed=35.913s
INFO [01-19|21:23:41] Successfully sealed new block            number=2 hash=62db3f…e27b50
INFO [01-19|21:23:41] 🔨 mined potential block                  number=2 hash=62db3f…e27b50
INFO [01-19|21:23:41] Commit new mining work                   number=3 txs=0 uncles=0 elapsed=772.239µs
INFO [01-19|21:23:43] Successfully sealed new block            number=3 hash=34384b…c387f2
INFO [01-19|21:23:43] 🔨 mined potential block                  number=3 hash=34384b…c387f2
INFO [01-19|21:23:43] Commit new mining work                   number=4 txs=0 uncles=0 elapsed=1.002ms
INFO [01-19|21:23:55] Generating DAG in progress               epoch=1 percentage=2  elapsed=53.757s
INFO [01-19|21:24:13] Generating DAG in progress               epoch=1 percentage=3  elapsed=1m11.561s
INFO [01-19|21:24:30] Generating DAG in progress               epoch=1 percentage=4  elapsed=1m28.986s
INFO [01-19|21:24:30] Successfully sealed new block            number=4 hash=681970…462135
INFO [01-19|21:24:30] 🔨 mined potential block                  number=4 hash=681970…462135
INFO [01-19|21:24:30] Commit new mining work                   number=5 txs=0 uncles=0 elapsed=833.629µs
INFO [01-19|21:24:36] Successfully sealed new block            number=5 hash=7b058b…d2f07a
INFO [01-19|21:24:36] 🔨 mined potential block                  number=5 hash=7b058b…d2f07a
INFO [01-19|21:24:36] Commit new mining work                   number=6 txs=0 uncles=0 elapsed=897.815µs
INFO [01-19|21:24:43] Successfully sealed new block            number=6 hash=a5fc3d…b1221e
INFO [01-19|21:24:43] 🔗 block reached canonical chain          number=1 hash=e2b5b9…9b1bfe
INFO [01-19|21:24:43] 🔨 mined potential block                  number=6 hash=a5fc3d…b1221e
INFO [01-19|21:24:43] Commit new mining work                   number=7 txs=0 uncles=0 elapsed=758.061µs
INFO [01-19|21:24:47] Successfully sealed new block            number=7 hash=003b02…e886fd
INFO [01-19|21:24:47] 🔗 block reached canonical chain          number=2 hash=62db3f…e27b50
INFO [01-19|21:24:47] 🔨 mined potential block                  number=7 hash=003b02…e886fd
INFO [01-19|21:24:47] Commit new mining work                   number=8 txs=0 uncles=0 elapsed=920.862µs
INFO [01-19|21:24:48] Generating DAG in progress               epoch=1 percentage=5  elapsed=1m46.827s
INFO [01-19|21:25:06] Generating DAG in progress               epoch=1 percentage=6  elapsed=2m4.338s
INFO [01-19|21:25:23] Successfully sealed new block            number=8 hash=fd23c9…361c65
INFO [01-19|21:25:23] 🔗 block reached canonical chain          number=3 hash=34384b…c387f2
INFO [01-19|21:25:23] 🔨 mined potential block                  number=8 hash=fd23c9…361c65
INFO [01-19|21:25:23] Commit new mining work                   number=9 txs=0 uncles=0 elapsed=825.737µs
INFO [01-19|21:25:23] Generating DAG in progress               epoch=1 percentage=7  elapsed=2m22.061s
				
				</pre>
			</section>
			<section class="section" id="miner.stop"><div class="titlepage"><div><div><h4 class="title">3.3.2. 停止挖矿</h4></div></div></div>
				
				<pre class="screen">
				
&gt; miner.stop()
true
&gt;
				
				</pre>
			</section>
			<section class="section" id="eth.getBalance"><div class="titlepage"><div><div><h4 class="title">3.3.3. 查看所挖金额</h4></div></div></div>
				
				<pre class="screen">
				
&gt; eth.getBalance(eth.accounts[0])
70000000000000000000				
				
				</pre>
			</section>
		</section>
	</section>

	<section class="section" id="geth"><div class="titlepage"><div><div><h2 class="title" style="clear: both">4. geth 命令</h2></div></div></div>
		
		<section class="section" id="geth.console"><div class="titlepage"><div><div><h3 class="title">4.1. 控制台</h3></div><div><h4 class="subtitle">Geth JavaScript console</h4></div></div></div>
			
			
			<pre class="screen">
			
neo@netkiller ~/ethereum % geth  --networkid 123456 console
INFO [01-19|22:14:52] Starting peer-to-peer node               instance=Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.1
INFO [01-19|22:14:52] Allocated cache and file handles         database=/home/neo/.ethereum/geth/chaindata cache=128 handles=1024
INFO [01-19|22:14:52] Initialised chain configuration          config="{ChainID: 15 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Byzantium: &lt;nil&gt; Engine: unknown}"
INFO [01-19|22:14:52] Disk storage enabled for ethash caches   dir=/home/neo/.ethereum/geth/ethash count=3
INFO [01-19|22:14:52] Disk storage enabled for ethash DAGs     dir=/home/neo/.ethash               count=2
INFO [01-19|22:14:52] Initialising Ethereum protocol           versions="[63 62]" network=123456
INFO [01-19|22:14:52] Loaded most recent local header          number=14 hash=70d7f1…45850a td=1966848
INFO [01-19|22:14:52] Loaded most recent local full block      number=14 hash=70d7f1…45850a td=1966848
INFO [01-19|22:14:52] Loaded most recent local fast block      number=14 hash=70d7f1…45850a td=1966848
INFO [01-19|22:14:52] Loaded local transaction journal         transactions=0 dropped=0
INFO [01-19|22:14:52] Regenerated local transaction journal    transactions=0 accounts=0
WARN [01-19|22:14:52] Blockchain not empty, fast sync disabled 
INFO [01-19|22:14:52] Starting P2P networking 

INFO [01-19|22:14:56] UDP listener up                          self=enode://9f6490ffb5236f2ddc5710ae73d47c740e0a3644bbd2d67029cf4a6c4693d2f470b642fd2cc3507f7e851df60aaeb730a1270b7a477f91ec5b6b17a8a4b40527@101.232.64.12:30303
INFO [01-19|22:14:56] RLPx listener up                         self=enode://9f6490ffb5236f2ddc5710ae73d47c740e0a3644bbd2d67029cf4a6c4693d2f470b642fd2cc3507f7e851df60aaeb730a1270b7a477f91ec5b6b17a8a4b40527@101.232.64.12:30303
INFO [01-19|22:14:56] IPC endpoint opened: /home/neo/.ethereum/geth.ipc 
Welcome to the Geth JavaScript console!

instance: Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.1
coinbase: 0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6
at block: 14 (Fri, 19 Jan 2018 21:27:16 HST)
 datadir: /home/neo/.ethereum
 modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0

&gt; 
&gt; INFO [01-19|22:14:56] Mapped network port                      proto=udp extport=30303 intport=30303 interface="UPNP IGDv1-IP1"			
			
			</pre>
		</section>
		<section class="section" id="geth.attach"><div class="titlepage"><div><div><h3 class="title">4.2. 连接控制台</h3></div></div></div>
			
			<p>一般测试启动我们使用 console，如果是正式启动无需使用 console。同事我们使用&amp;符号使其进入后台运行。</p>
			<pre class="screen">
			
neo@netkiller ~/ethereum % geth --networkid 123456 --rpc --rpcaddr="0.0.0.0" --rpccorsdomain "*" --nodiscover &amp;			
			
			</pre>
			<p>进入控制台</p>
			<pre class="screen">
			
neo@netkiller ~/ethereum % geth attach
Welcome to the Geth JavaScript console!

instance: Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.1
coinbase: 0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6
at block: 531 (Tue, 14 Nov 2017 17:36:05 HST)
 datadir: /home/neo/.ethereum
 modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0
			
			</pre>
			<p>退出控制台</p>
			<pre class="screen">
			
&gt; exit
			
			</pre>
			<p>连接远程控制台</p>
			<pre class="screen">
			
neo@netkiller ~/ethereum % geth --exec 'eth.coinbase' attach http://172.16.0.10:8545
"0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6"			
			
			</pre>
		</section>
		<section class="section" id="geth.account"><div class="titlepage"><div><div><h3 class="title">4.3. 账号管理</h3></div></div></div>
			
			<section class="section" id="new"><div class="titlepage"><div><div><h4 class="title">4.3.1. 新建账号</h4></div></div></div>
				

				<p>查看账号</p>
				<pre class="screen">
				
neo@netkiller ~/ethereum % geth account list 
Account #0: {83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6} keystore:///home/neo/.ethereum/keystore/UTC--2018-01-20T04-04-06.786586541Z--83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6				
				
				</pre>

				<p>创建账号</p>
				<pre class="screen">
				
neo@netkiller ~/ethereum % geth account new
Your new account is locked with a password. Please give a password. Do not forget this password.
Passphrase: 
Repeat passphrase: 
Address: {e8abf98484325fd6afc59b804ac15804b978e607}				
				
				</pre>
				<p>指定密码</p>
				<pre class="screen">
				
$ echo "abc123" &gt; password 
$ geth --password /path/to/password account new
				
				</pre>
				<p>账号创建在 ~/.ethereum/keystore 目录下</p>
				<pre class="screen">
				
Mac: ~/Library/Ethereum/keystore
Linux: ~/.ethereum/keystore
Windows: %APPDATA%/Ethereum/keystore				
				
				</pre>
				<pre class="programlisting">
				
neo@netkiller ~/.ethereum/keystore % ll
total 8.0K
-rw------- 1 neo neo 491 Jan 19 18:04 UTC--2018-01-20T04-04-06.786586541Z--83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6
-rw------- 1 neo neo 491 Jan 19 20:11 UTC--2018-01-20T06-11-23.608902164Z--e8abf98484325fd6afc59b804ac15804b978e607				
				
				</pre>
			</section>
			<section class="section" id="list"><div class="titlepage"><div><div><h4 class="title">4.3.2. 查看账号</h4></div></div></div>
				
				<pre class="screen">
				
neo@netkiller ~/ethereum % geth account list 
Account #0: {83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6} keystore:///home/neo/.ethereum/keystore/UTC--2018-01-20T04-04-06.786586541Z--83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6
Account #1: {e8abf98484325fd6afc59b804ac15804b978e607} keystore:///home/neo/.ethereum/keystore/UTC--2018-01-20T06-11-23.608902164Z--e8abf98484325fd6afc59b804ac15804b978e607				
				
				</pre>
			</section>

		</section>
		<section class="section" id="rpc"><div class="titlepage"><div><div><h3 class="title">4.4. rpc 相关参数</h3></div></div></div>
			
			<p>rpcapi 启动后允许连接到系统的API协议</p>
			<pre class="screen">
			
geth --networkid 100000 --rpc --rpcapi "db,eth,net,web3" --rpccorsdomain "*" --datadir "/app/chain" --port "30303" console	
			
			</pre>
			
			<p>系统默认监听 127.0.0.1 如果希望外部访问本机，需要通过--rpcaddr指定监听地址。</p>
			<pre class="screen">
			
geth --networkid 123456 --rpc --rpcaddr="0.0.0.0" --rpccorsdomain "*" --nodiscover		
			
			</pre>
			
			<p>--rpcapi 可以控制访问内容</p>
			<pre class="screen">
			
$ geth --rpcapi personal,db,eth,net,web3 --rpc --rinkeby	
			
			
			</pre>
		</section>
		<section class="section" id="password"><div class="titlepage"><div><div><h3 class="title">4.5. 配置自动解锁账号</h3></div></div></div>
			
			<p>创建password文件，在里面输入密码，每个账号一行密码如：</p>
			<pre class="screen">
			
123456
123456
123456			
			
			</pre>
			<p>启动参数</p>
			<pre class="screen">
			
geth --rpc --rpcaddr="0.0.0.0" --rpccorsdomain="*" --unlock '0,1,2' --password ~/.ethereum/password   --nodiscover --maxpeers '5' --networkid '12345' --datadir '~/.ethereum'  console			
			
			</pre>
		</section>
		<section class="section" id="geth.exec"><div class="titlepage"><div><div><h3 class="title">4.6. 运行JS</h3></div></div></div>
			
			<pre class="screen">
			
neo@netkiller ~/ethereum % geth --exec "eth.blockNumber" attach
531
			
			</pre>
			<pre class="screen">
			
$ geth --exec 'loadScript("/tmp/checkbalances.js")' attach http://123.123.123.123:8545
$ geth --jspath "/tmp" --exec 'loadScript("checkbalances.js")' attach http://123.123.123.123:8545			
			
			</pre>
		</section>
		<section class="section" id="geth.bootnodes"><div class="titlepage"><div><div><h3 class="title">4.7. --bootnodes</h3></div></div></div>
			
		</section>
	</section>
	<section class="section" id="javascript.console"><div class="titlepage"><div><div><h2 class="title" style="clear: both">5. JavaScript Console</h2></div></div></div>
		
		<section class="section" id="personal"><div class="titlepage"><div><div><h3 class="title">5.1. personal 管理</h3></div></div></div>
			
			<section class="section" id="personal.newAccount"><div class="titlepage"><div><div><h4 class="title">5.1.1. 创建账号</h4></div></div></div>
				
				<pre class="screen">
				
&gt; personal.newAccount()
Passphrase: 
Repeat passphrase: 
"0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6"				
				
				</pre>
				<p>指定密码创建用户</p>
				<pre class="screen">
				
personal.newAccount("123")				
				
				</pre>

			</section>
			<section class="section" id="personal.listAccounts"><div class="titlepage"><div><div><h4 class="title">5.1.2. 显示账号</h4></div></div></div>
				
				<p>列出所有账号</p>
				<pre class="screen">
				
&gt; personal.listAccounts
["0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6", "0xe8abf98484325fd6afc59b804ac15804b978e607"]				
				
				</pre>
				<p>列出指定账号</p>
				<pre class="screen">
				
&gt; personal.listAccounts[1]
"0xe8abf98484325fd6afc59b804ac15804b978e607"

&gt; personal.listAccounts[0]
"0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6"				
				
				</pre>

			</section>
		</section>
		<section class="section" id="eth"><div class="titlepage"><div><div><h3 class="title">5.2. eth 管理</h3></div></div></div>
			
			<section class="section" id="eth.coinbase"><div class="titlepage"><div><div><h4 class="title">5.2.1. 矿工账号</h4></div></div></div>
				
				<p>查看默认旷工账号，系统中的第一个账号。</p>
				<pre class="screen">
				
&gt; eth.coinbase
"0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6"				
				
				</pre>
				<p>查看账号列表</p>
				<pre class="screen">
				
&gt; eth.accounts
["0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6", "0xe8abf98484325fd6afc59b804ac15804b978e607"]	

&gt; eth.accounts[0]
"0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6"			
				
				</pre>
			</section>
			<section class="section" id="eth.getBalance"><div class="titlepage"><div><div><h4 class="title">5.2.2. 余额</h4></div></div></div>
				
				<pre class="screen">
				
&gt; eth.getBalance(eth.accounts[0])
70000000000000000000
				
				</pre>
				<section class="section" id=""><div class="titlepage"><div><div><h5 class="title">5.2.2.1. 单位转换</h5></div></div></div>
					
					<p>eth.getBalance()返回的余额是以太币的最小面额wei，将wei转换为以太币ether。</p>
					<pre class="programlisting">
					
primary = eth.accounts[0]
balance = web3.fromWei(eth.getBalance(primary), "ether");	
					
					</pre>
					<p>演示</p>
					<pre class="screen">
					
&gt; primary = eth.accounts[0]
"0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6"
&gt; balance = web3.fromWei(eth.getBalance(primary), "ether");
70			
					
					</pre>
				</section>
				<section class="section" id=""><div class="titlepage"><div><div><h5 class="title">5.2.2.2. 一次检查所有账号余额</h5></div></div></div>
					
					<p>定义函数</p>
					<pre class="programlisting">
					
function checkAllBalances() {
  web3.eth.getAccounts(function(err, accounts) {
   accounts.forEach(function(id) {
    web3.eth.getBalance(id, function(err, balance) {
     console.log("" + id + ":\tbalance: " + web3.fromWei(balance, "ether") + " ether");
   });
  });
 });
};					
					
					</pre>
					<p>运行函数</p>
					<pre class="screen">
					
checkAllBalances()					
					
					</pre>
					<p>输出演示</p>
					<pre class="screen">
					
&gt; function checkAllBalances() {
...   web3.eth.getAccounts(function(err, accounts) {
.........    accounts.forEach(function(id) {
...............     web3.eth.getBalance(id, function(err, balance) {
.....................      console.log("" + id + ":\tbalance: " + web3.fromWei(balance, "ether") + " ether");
.....................    });
...............   });
.........  });
... };
undefined
&gt; checkAllBalances()
0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6:	balance: 929 ether
0xe8abf98484325fd6afc59b804ac15804b978e607:	balance: 11 ether
undefined					
					
					</pre>
				</section>
			</section>
			<section class="section" id="eth.sendTransaction"><div class="titlepage"><div><div><h4 class="title">5.2.3. 转账</h4></div></div></div>
				
				<pre class="screen">
				
personal.unlockAccount("0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6", "", 300)	
eth.sendTransaction({from: '0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6', to: '0xe8abf98484325fd6afc59b804ac15804b978e607', value: web3.toWei(1, "ether")})
				
				</pre>
				<pre class="screen">
				
默认矿工账号
				
&gt; eth.coinbase
"0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6"

查看系统中的账号，如果没有请参考上面章节创建

&gt; eth.accounts
["0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6", "0xe8abf98484325fd6afc59b804ac15804b978e607"]

转出账号中又 285 个以太币

&gt; web3.fromWei(eth.getBalance(eth.accounts[0]))
285

转入账号目前是 0 

&gt; web3.fromWei(eth.getBalance(eth.accounts[1]))
0

解锁传出账号，否则不能转出。personal.unlockAccount(账号, 密码, 300)

&gt; personal.unlockAccount("0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6", "", 300)
true

转账操作

&gt; eth.sendTransaction({from: '0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6', to: '0xe8abf98484325fd6afc59b804ac15804b978e607', value: web3.toWei(10, "ether")})
"0xb0674a7fee52555d8712f3a1f0f30fbbbf67ff7b5b4b53ab5d131262613215c6"

如果你现在查看转入账号，你会发现余额仍然是 0 ，交易还未成功写进区块，写进区块的方式是挖矿，所以你必须执行挖矿

&gt; miner.start(1)
null

稍后几分钟，再次查看转入账号，将会看到有10个以太币入账。传出账号会减少10个以太币，同时仍然继续挖矿中。

&gt; web3.fromWei(eth.getBalance(eth.accounts[1]))
10
				
				</pre>
			</section>
			<section class="section" id="eth.blockNumber"><div class="titlepage"><div><div><h4 class="title">5.2.4. 查看当前区块总数</h4></div></div></div>
				
				<pre class="screen">
				
&gt; eth.blockNumber 
719			
				
				</pre>
			</section>
			<section class="section" id="eth.getBlock"><div class="titlepage"><div><div><h4 class="title">5.2.5. 查看区块信息</h4></div></div></div>
				
				<pre class="screen">
				
&gt; eth.getBlock(1) 
{
  difficulty: 131072,
  extraData: "0xd783010702846765746885676f312e398777696e646f7773",
  gasLimit: 4995119,
  gasUsed: 0,
  hash: "0x62bc2fc0fd647b43013ba75e65a3f16520cebb60cadc0995965c891d4266a88c",
  logsBloom: "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
  miner: "0xba1821227ebad7e88a51078f6219b392fd601822",
  mixHash: "0x80ad2e29d057e0f6bb9d03f12a252fdc65cb520248fa0023ae6624c997b5d5f2",
  nonce: "0x3d743ef28ba8c8c8",
  number: 1,
  parentHash: "0x611596e7979cd4e7ca1531260fa706093a5492ecbdf58f20a39545397e424d04",
  receiptsRoot: "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
  sha3Uncles: "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
  size: 535,
  stateRoot: "0x418d9f66e33cbd41fd524b87c10c5fc75f8a6360896967d827a2d56a0c8aadda",
  timestamp: 1510715249,
  totalDifficulty: 262144,
  transactions: [],
  transactionsRoot: "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
  uncles: []
}
&gt; eth.getBlock(2)
{
  difficulty: 131072,
  extraData: "0xd783010702846765746885676f312e398777696e646f7773",
  gasLimit: 4990242,
  gasUsed: 0,
  hash: "0x3323c566fd3501c29e8b026c4a9d2e83a8dd62d153a32b5f879120e999013d07",
  logsBloom: "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
  miner: "0xba1821227ebad7e88a51078f6219b392fd601822",
  mixHash: "0xc415fc64f1bc13842455f8289d33842260c1578a32b5befded5b4293e7a92276",
  nonce: "0x4f4a0e65412663db",
  number: 2,
  parentHash: "0x62bc2fc0fd647b43013ba75e65a3f16520cebb60cadc0995965c891d4266a88c",
  receiptsRoot: "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
  sha3Uncles: "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
  size: 535,
  stateRoot: "0x39ccb22ff5ca19a2340e137fa64acedb704d42827a753780b53a0aff8922e403",
  timestamp: 1510715341,
  totalDifficulty: 393216,
  transactions: [],
  transactionsRoot: "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
  uncles: []
}
				
				
				</pre>
			</section>
		</section>

		<section class="section" id="web3"><div class="titlepage"><div><div><h3 class="title">5.3. web3</h3></div></div></div>
			
			<section class="section" id=""><div class="titlepage"><div><div><h4 class="title">5.3.1. Ether币的基本单位</h4></div></div></div>
				
				<p>Ether币最小的单位是Wei，也是命令行默认的单位, 然后每1000个进一个单位，依次是</p>
				<div class="literallayout"><p><br/>
					<br/>
kwei (1000 Wei)<br/>
mwei (1000 KWei)<br/>
gwei (1000 mwei)<br/>
szabo (1000 gwei)<br/>
finney (1000 szabo)<br/>
ether (1000 finney)<br/>
					<br/>
				</p></div>
				<p>如何进行ether 和 Wei之间的转换，简单地说就是就是1 以太币 = 1000000000000000000 Wei
					（这就是上一站章中为何我们转移0.01个以太币，结果却显示很长的原因）</p>
				<p>单位转换</p>
				<pre class="screen">
					
&gt; web3.fromWei(10000000000000000,"ether")
"0.01"				
					
				</pre>

				<section class="section" id="web3.toWei"><div class="titlepage"><div><div><h5 class="title">5.3.1.1. web3.toWei</h5></div></div></div>
					
					<pre class="screen">
						
Ether–&gt; Wei

&gt; web3.toWei(1)
"1000000000000000000"
&gt; web3.toWei(1.3423423)
"1342342300000000000"
&gt; web3.toWei(0.00034)
"340000000000000"						
						
					</pre>
				</section>
				<section class="section" id="web3.fromWei"><div class="titlepage"><div><div><h5 class="title">5.3.1.2. web3.fromWei</h5></div></div></div>
					
					<pre class="screen">
						
Wei –&gt; Ether

&gt; web3.fromWei(10000000000000000)
"0.01"
&gt; web3.fromWei(1000000000000000000)
"1"
&gt;
						
					</pre>
				</section>
			</section>

		</section>
		<section class="section" id="admin"><div class="titlepage"><div><div><h3 class="title">5.4. admin 管理</h3></div></div></div>
			
			<section class="section" id=""><div class="titlepage"><div><div><h4 class="title">5.4.1. 节点管理</h4></div></div></div>
				
				<p>可以通过admin.addPeer()方法连接到其他节点，两个节点要想联通，必须保证网络是相通的，并且要指定相同的networkid</p>


				<section class="section" id="admin.nodeInfo"><div class="titlepage"><div><div><h5 class="title">5.4.1.1. 显示节点</h5></div></div></div>
					
					<p>显示当前节点信息</p>
					<pre class="screen">
				
&gt; admin.nodeInfo
{
  enode: "enode://9f6490ffb5236f2ddc5710ae73d47c740e0a3644bbd2d67029cf4a6c4693d2f470b642fd2cc3507f7e851df60aaeb730a1270b7a477f91ec5b6b17a8a4b40527@[::]:30303?discport=0",
  id: "9f6490ffb5236f2ddc5710ae73d47c740e0a3644bbd2d67029cf4a6c4693d2f470b642fd2cc3507f7e851df60aaeb730a1270b7a477f91ec5b6b17a8a4b40527",
  ip: "::",
  listenAddr: "[::]:30303",
  name: "Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.1",
  ports: {
    discovery: 0,
    listener: 30303
  },
  protocols: {
    eth: {
      difficulty: 131072,
      genesis: "0x611596e7979cd4e7ca1531260fa706093a5492ecbdf58f20a39545397e424d04",
      head: "0x611596e7979cd4e7ca1531260fa706093a5492ecbdf58f20a39545397e424d04",
      network: 123456
    }
  }
}
&gt; 

				
					</pre>
					<p>节点地址</p>
					<pre class="screen">
					
&gt; admin.nodeInfo.enode 
"enode://9f6490ffb5236f2ddc5710ae73d47c740e0a3644bbd2d67029cf4a6c4693d2f470b642fd2cc3507f7e851df60aaeb730a1270b7a477f91ec5b6b17a8a4b40527@[::]:30303?discport=0"
					
					</pre>
					<p>[::] 是 ipv6 地址，可以改为 ipv4 地址。</p>
				</section>
				<section class="section" id="admin.peers"><div class="titlepage"><div><div><h5 class="title">5.4.1.2. 查看节点</h5></div></div></div>
					
					<p>查看节点数量</p>
					<pre class="screen">
					
&gt; net.peerCount
0					
					
					</pre>
					<p>查看节点地址</p>
					<pre class="screen">
					
&gt; admin.peers
[]				
					
					</pre>

				</section>
				<section class="section" id="admin.addPeer"><div class="titlepage"><div><div><h5 class="title">5.4.1.3. 添加节点</h5></div></div></div>
					
					<pre class="screen">
				
&gt; admin.addPeer('enode://9f6490ffb5236f2ddc5710ae73d47c740e0a3644bbd2d67029cf4a6c4693d2f470b642fd2cc3507f7e851df60aaeb730a1270b7a477f91ec5b6b17a8a4b40527@172.16.0.1:30303')				
				
					</pre>
				</section>
			</section>
		</section>

		<section class="section" id="miner"><div class="titlepage"><div><div><h3 class="title">5.5. miner 挖矿管理</h3></div></div></div>
			
			<section class="section" id="miner.start"><div class="titlepage"><div><div><h4 class="title">5.5.1. 开始挖矿</h4></div></div></div>
				
				<pre class="screen">
				
&gt; miner.start(2)
null			
				
				</pre>
				<p>过几分钟后运行</p>
				<pre class="screen">
				
&gt; web3.fromWei(eth.getBalance(eth.coinbase), "ether")
30					
				
				</pre>
				<p>这时我们已经看到已经产生了30个以太币。</p>
			</section>
			<section class="section" id="miner.stop"><div class="titlepage"><div><div><h4 class="title">5.5.2. 停止挖矿</h4></div></div></div>
				
				<pre class="screen">
				
&gt; miner.stop()
true
&gt;
				
				</pre>
			</section>
		</section>
		<section class="section" id="txpool.status "><div class="titlepage"><div><div><h3 class="title">5.6. txpool 管理</h3></div></div></div>
			
			<section class="section" id=""><div class="titlepage"><div><div><h4 class="title">5.6.1. txpool.status</h4></div></div></div>
				
				<p>查看状态</p>
				<pre class="screen">
				
&gt; txpool.status 
{
  pending: 0,
  queued: 0
}
				
				</pre>
				<p>例如做一笔转账</p>
				<pre class="screen">
				
&gt; amount = web3.toWei(5,'ether')  
"5000000000000000000"  
&gt; eth.sendTransaction({from:eth.accounts[0],to:eth.accounts[1],value:amount})	

&gt; txpool.status 
{
  pending: 1,
  queued: 0
}

&gt; miner.start(1);admin.sleepBlocks(1);miner.stop(); 

&gt; txpool.status 
{
  pending: 0,
  queued: 0
}

&gt; web3.fromWei(eth.getBalance(eth.accounts[1]),'ether')  
5  
				
				</pre>
			</section>
		</section>
	</section>
	<section class="section" id="solidity"><div class="titlepage"><div><div><h2 class="title" style="clear: both">6. 智能合约</h2></div></div></div>
		
		<p>Solidity是什么？Solidity是以太坊智能合约的编程语言。</p>
		<section class="section" id=""><div class="titlepage"><div><div><h3 class="title">6.1. browser-solidity</h3></div></div></div>
			
			<a class="ulink" href="https://ethereum.github.io/browser-solidity/" target="_top">https://ethereum.github.io/browser-solidity/</a>
		</section>



	</section>
	<section class="section" id="web3j"><div class="titlepage"><div><div><h2 class="title" style="clear: both">7. Jave Client</h2></div></div></div>
		
		<p>Java 客户端与 Server 之间采用json-rpc协议连接。</p>
		<p>首先启动服务</p>
		<pre class="screen">
		
neo@netkiller ~ % geth --networkid 123456 --rpc --rpcaddr="0.0.0.0" --rpccorsdomain "*" --nodiscover 
INFO [02-01|23:35:12] Starting peer-to-peer node               instance=Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.1
INFO [02-01|23:35:12] Allocated cache and file handles         database=/home/neo/.ethereum/geth/chaindata cache=128 handles=1024
INFO [02-01|23:35:12] Initialised chain configuration          config="{ChainID: 15 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Byzantium: &lt;nil&gt; Engine: unknown}"
INFO [02-01|23:35:12] Disk storage enabled for ethash caches   dir=/home/neo/.ethereum/geth/ethash count=3
INFO [02-01|23:35:12] Disk storage enabled for ethash DAGs     dir=/home/neo/.ethash               count=2
INFO [02-01|23:35:12] Initialising Ethereum protocol           versions="[63 62]" network=123456
INFO [02-01|23:35:12] Loaded most recent local header          number=719 hash=61330b…82786e td=108754979
INFO [02-01|23:35:12] Loaded most recent local full block      number=719 hash=61330b…82786e td=108754979
INFO [02-01|23:35:12] Loaded most recent local fast block      number=719 hash=61330b…82786e td=108754979
INFO [02-01|23:35:12] Loaded local transaction journal         transactions=0 dropped=0
INFO [02-01|23:35:12] Regenerated local transaction journal    transactions=0 accounts=0
WARN [02-01|23:35:12] Blockchain not empty, fast sync disabled 
INFO [02-01|23:35:12] Starting P2P networking 
INFO [02-01|23:35:12] RLPx listener up                         self="enode://9f6490ffb5236f2ddc5710ae73d47c740e0a3644bbd2d67029cf4a6c4693d2f470b642fd2cc3507f7e851df60aaeb730a1270b7a477f91ec5b6b17a8a4b40527@[::]:30303?discport=0"
INFO [02-01|23:35:12] IPC endpoint opened: /home/neo/.ethereum/geth.ipc 
INFO [02-01|23:35:12] HTTP endpoint opened: http://0.0.0.0:8545 
INFO [02-01|23:35:15] Mapped network port                      proto=tcp extport=30303 intport=30303 interface="UPNP IGDv1-IP1"		
		
		</pre>
		<section class="section" id="pom.xml"><div class="titlepage"><div><div><h3 class="title">7.1. Maven pom.xml 文件</h3></div></div></div>
			
			<pre class="screen">
			
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
	&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

	&lt;groupId&gt;cn.netkiller&lt;/groupId&gt;
	&lt;artifactId&gt;ethereum&lt;/artifactId&gt;
	&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
	&lt;packaging&gt;jar&lt;/packaging&gt;

	&lt;name&gt;ethereum&lt;/name&gt;
	&lt;url&gt;http://maven.apache.org&lt;/url&gt;

	&lt;properties&gt;
		&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
	&lt;/properties&gt;

	&lt;dependencies&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.web3j&lt;/groupId&gt;
			&lt;artifactId&gt;core&lt;/artifactId&gt;
			&lt;version&gt;3.2.0&lt;/version&gt;
		&lt;/dependency&gt;
	&lt;/dependencies&gt;
&lt;/project&gt;
			
			
			</pre>
		</section>
		<section class="section" id="connect"><div class="titlepage"><div><div><h3 class="title">7.2. 连接到服务器获取版本号</h3></div></div></div>
			
			<pre class="programlisting">
			
package cn.netkiller.ethereum;

import java.io.IOException;

import org.web3j.protocol.Web3j;
import org.web3j.protocol.core.methods.response.Web3ClientVersion;
import org.web3j.protocol.http.HttpService;

public class Web3JClient {
	// TODO Auto-generated method stub

	public static void main(String[] args) {
		String url = "http://172.16.0.1:8545/";
		Web3j web3j = Web3j.build(new HttpService(url)); // defaults to http://localhost:8545/

		try {
			Web3ClientVersion web3ClientVersion = web3j.web3ClientVersion().send();
			String clientVersion = web3ClientVersion.getWeb3ClientVersion();
			System.out.println(clientVersion);
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

}
			
			</pre>
			<p>运行结果</p>
			<pre class="screen">
			
Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.1			
			
			</pre>
			<p>除了 TCP 方式连接，还支持 IPC 方式。这种方式比较少用，可以使用 localhost 替代。</p>
			<pre class="programlisting">
			
// OS X/Linux/Unix:
Web3j web3 = Web3j.build(new UnixIpcService("/path/to/socketfile"));
...

// Windows
Web3j web3 = Web3j.build(new WindowsIpcService("/path/to/namedpipefile"));
...			
			
			</pre>
		</section>
		<section class="section" id="account"><div class="titlepage"><div><div><h3 class="title">7.3. </h3></div></div></div>
			
			<section class="section" id=""><div class="titlepage"><div><div><h4 class="title">7.3.1. 获得账号列表</h4></div></div></div>
				
				<pre class="programlisting">
				
	public List&lt;String&gt; getAccountlist() {

		try {
			return web3j.ethAccounts().send().getAccounts();
		} catch (Exception e) {
			e.printStackTrace();
		}
		return null;
	}				
				
				</pre>
			</section>
			<section class="section" id=""><div class="titlepage"><div><div><h4 class="title">7.3.2. 获得账号信息</h4></div></div></div>
				
				<pre class="programlisting">
				
	public String getAccount(int index) {
		String account = null;

		try {
			account = web3j.ethAccounts().send().getAccounts().get(index);

		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return account;
	}				
				
				
				</pre>
			</section>
			<section class="section" id=""><div class="titlepage"><div><div><h4 class="title">7.3.3. 获取余额</h4></div></div></div>
				
				<pre class="programlisting">
				
	public BigInteger getBalance(String account) throws IOException {

		EthGetBalance ethGetBalance = web3j.ethGetBalance(account, DefaultBlockParameterName.LATEST).send();
		BigInteger balance = ethGetBalance.getBalance();
		return balance;

	}				
				
				</pre>
			</section>
			<section class="section" id=""><div class="titlepage"><div><div><h4 class="title">7.3.4. </h4></div></div></div>
				
				<pre class="programlisting">
				
	public void transfer(String account, float coin)
			throws InterruptedException, IOException, TransactionException, Exception {
		String password = "";
		String walletfile = "/Users/neo/netkiller/UTC--2018-01-20T04-04-06.786586541Z--83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6";
		Credentials credentials = WalletUtils.loadCredentials(password, walletfile);
		TransactionReceipt transactionReceipt = Transfer
				.sendFunds(web3j, credentials, account, BigDecimal.valueOf(coin), Unit.ETHER).send();
		System.out.println(transactionReceipt.getStatus());
	}
				
				</pre>
			</section>
			<section class="section" id="web3j.account.example"><div class="titlepage"><div><div><h4 class="title">7.3.5. 例子</h4></div></div></div>
				
			</section>
		</section>
		<section class="section" id="Credentials"><div class="titlepage"><div><div><h3 class="title">7.4. Credentials</h3></div></div></div>
			
			<pre class="programlisting">
			
package cn.netkiller.ethereum.credentials;

import java.io.IOException;
import java.math.BigInteger;

import org.web3j.crypto.Credentials;
import org.web3j.crypto.ECKeyPair;
import org.web3j.protocol.Web3j;
import org.web3j.protocol.http.HttpService;

public class CredentialsTest {

	public static void main(String[] args) {
		// TODO Auto-generated method stub

		String url = "http://172.16.0.1:8545/";
		Web3j web3j = Web3j.build(new HttpService(url)); // defaults to http://localhost:8545/

		try {
			String account = web3j.ethAccounts().send().getAccounts().get(0);
			Credentials credentials = Credentials.create(account);
			ECKeyPair keyPair = credentials.getEcKeyPair();
			BigInteger privateKey = keyPair.getPrivateKey();
			BigInteger publicKey = keyPair.getPublicKey();

			System.out.println(privateKey);
			System.out.println("---");
			System.out.println(publicKey);
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

}
			
			
			</pre>
		</section>
	</section>
	<section class="section" id="summary"><div class="titlepage"><div><div><h2 class="title" style="clear: both">8. 总结</h2></div></div></div>
		
	</section>
	<section class="section" id="faq"><div class="titlepage"><div><div><h2 class="title" style="clear: both">9. FAQ</h2></div></div></div>
		
		<section class="section" id=""><div class="titlepage"><div><div><h3 class="title">9.1. Error: authentication needed: password or unlock</h3></div></div></div>
			
			<pre class="screen">
			
&gt; eth.sendTransaction({from: '0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6', to: '0xe8abf98484325fd6afc59b804ac15804b978e607', value: web3.toWei(1, "ether")})
Error: authentication needed: password or unlock
    at web3.js:3143:20
    at web3.js:6347:15
    at web3.js:5081:36
    at &lt;anonymous&gt;:1:1			
			
			</pre>
			<p>解锁转出账号</p>
			<pre class="screen">
			
&gt; personal.unlockAccount("0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6", "your_password", 300)
true
&gt; eth.sendTransaction({from: '0x83fda0ba7e6cfa8d7319d78fa0e6b753a2bcb5a6', to: '0xe8abf98484325fd6afc59b804ac15804b978e607', value: web3.toWei(1, "ether")})
"0xd9e8c8fdc71e24ee8052048de4ff0acd7157b872393f37344c8ec2083f3fe48f"			
			
			</pre>
		</section>
	</section>
</section><div xmlns="" id="disqus_thread"/><script xmlns="">

var disqus_config = function () {
this.page.url = "http://www.netkiller.cn";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'netkiller'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//netkiller.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><noscript xmlns="">Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><br xmlns=""/><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"/></body></html>