<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>20.7. Text Processing</title><link rel="stylesheet" type="text/css" href="..//docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="../index.html" title="Netkiller Linux Basics 手札" /><link rel="up" href="index.html" title="第 20 章 Shell command" /><link rel="prev" href="numeric.html" title="20.6. Numeric" /><link rel="next" href="log.html" title="20.8. Logging" /></head><body><a xmlns="" href="http://netkiller.github.io/">Home</a> |
		<a xmlns="" href="http://netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="/search.html">Search</a> |
	    <a xmlns="" href="http://netkiller-github-com.iteye.com/">ITEYE 博客</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
		<a xmlns="" href="mailto:netkiller@msn.com">Email</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">20.7. Text Processing</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="numeric.html">上一页</a> </td><th width="60%" align="center">第 20 章 Shell command</th><td width="20%" align="right"> <a accesskey="n" href="log.html">下一页</a></td></tr></table><hr /><table width="100%" border="0"><tr><td align="left"><a href="http://netkiller.sourceforge.net/">Home</a> | 
		<a href="http://netkiller.github.com/">Mirror</a> |		
		<a href="/search.html">Search</a></td><td align="right"></td></tr></table></div><table xmlns=""><tr><td><iframe src="http://ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.com&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="http://ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.com&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="http://ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td></tr></table><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="text"></a>20.7. Text Processing</h2></div></div></div>
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="iconv"></a>20.7.1. iconv - Convert encoding of given files from one encoding to another</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp60168960"></a>20.7.1.1. cconv - A iconv based simplified-traditional chinese conversion tool</h4></div></div></div>
			
			<p>cconv是建立在iconv之上，可以UTF8编码直接转换，并增加了词转换。</p>
			<pre class="screen">
sudo apt-get install cconv
			</pre>
			<p>使用cconv进行简繁转换的方法为：</p>
			<pre class="screen">
cconv -f UTF8-CN -t UTF8-HK zh-cn.txt -o zh-hk.txt
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp60171872"></a>20.7.1.2. uconv - convert data from one encoding to another</h4></div></div></div>
			
			<p>安装</p>
			<pre class="screen">
sudo apt-get install libicu-dev
			</pre>
			<p>例子</p>
			<pre class="screen">
$ uconv -f cp1252 -t UTF-8 -o file_in_utf8.txt file_in_cp1252_encoding.txt
			</pre>
		</div>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="expr"></a>20.7.2. 字符串处理命令expr</h3></div></div></div>
		
		<pre class="screen">
		
字符串处理命令expr用法简介:
名称：expr
用途:求表达式变量的值。
语法: expr Expression
实例如下:
例子1:字串长度
shell&gt;&gt; expr length "this is a test content";
22
例子2:求余数
shell&gt;&gt; expr 20 % 9
2
例子3:从指定位置处截取字符串
shell&gt;&gt; expr substr "this is a test content" 3 5
is is
例子4:指定字符串第一次出现的位置
shell&gt;&gt; expr index "testforthegame" s
3
例子5:字符串真实重现
shell&gt;&gt; expr quote thisisatestformela
thisisatestformela
		
		</pre>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="cat"></a>20.7.3. cat - concatenate files and print on the standard output</h3></div></div></div>
		
		<pre class="screen">
-b	不对空白行编号。
-e	使用 $ 字符显示行尾。
-n	从 1 开始对所有输出行编号。
-q	使用静默操作（禁止错误消息）。
-r	将所有多个空行替换为单行（“压缩”空白）。
-t	将制表符显示为 ^I。
-u	不对输出进行缓冲。
-v	可视地显示非打印控制字符。
		</pre>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp60178416"></a>20.7.3.1. -s, --squeeze-blank suppress repeated empty output lines</h4></div></div></div>
			
			<p>-S	将多个空白行压缩到单行中（与 -r 相同）</p>
			<pre class="screen">
			
$ cat &gt;&gt; /tmp/test &lt;&lt;EOF
Line1

Line2


Line3




Line4


Line5

EOF

$ cat -s /tmp/test
Line1

Line2

Line3

Line4

Line5

			
			</pre>
		</div>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="nl"></a>20.7.4. nl - number lines of files</h3></div></div></div>
		
		<pre class="screen">
$ nl /etc/issue
     1  CentOS release 5.4 (Final)
     2  Kernel \r on an \m
		</pre>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="od"></a>20.7.5. od - dump files in octal and other formats</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp60183808"></a>20.7.5.1. 16进制</h4></div></div></div>
			
			<pre class="screen">
$ echo "helloworld" | od -x
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="tr"></a>20.7.6. tr - translate or delete characters</h3></div></div></div>
		
		<p>":"替换为"\n"</p>
		<pre class="screen">
$ cat /etc/passwd |tr ":" "\n"
		</pre>
	</div>
    <div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="cut"></a>20.7.7. cut - remove sections from each line of files</h3></div></div></div>
        
        <p>列操作</p>
        <pre class="screen">
$ last | grep  'neo' | cut -d ' ' -f1
        </pre>
        <pre class="screen">
$ cat /etc/passwd | cut -d ':' -f1
root
daemon
bin
sys
sync
games
man
lp
mail
news
uucp
proxy

$ cat /etc/passwd | cut -d ':' -f1,3,4

# cat /etc/passwd | cut -d ':' -f1,6
root:/root
bin:/bin
daemon:/sbin
adm:/var/adm
lp:/var/spool/lpd
sync:/sbin
shutdown:/sbin
halt:/sbin
mail:/var/spool/mail
uucp:/var/spool/uucp
operator:/root
games:/usr/games
gopher:/var/gopher
ftp:/var/ftp
nobody:/
vcsa:/dev
saslauth:/var/empty/saslauth
postfix:/var/spool/postfix
sshd:/var/empty/sshd
rpc:/var/cache/rpcbind
rpcuser:/var/lib/nfs
nfsnobody:/var/lib/nfs
ntp:/etc/ntp
nagios:/var/log/nagios

        </pre>
        <p>行操作</p>
        <pre class="screen">
$ cat /etc/passwd | cut -c 1-4
root
daem
bin:
sys:
sync
game
man:

$ echo "No such file or directory"| cut -c4-7
such

$ echo "No such file or directory"| cut -c -8
No such

$ echo "No such file or directory"| cut -c-8
No such

        </pre>
    </div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="printf"></a>20.7.8. printf - format and print data</h3></div></div></div>
		
		<pre class="screen">
printf "%d\n" 1234
		</pre>
		<pre class="screen">
$ printf "\033[1;33m TEST COLOR \n\033[m"
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="recode"></a>20.7.9. Free `recode' converts files between various character sets and surfaces.</h3></div></div></div>
		
		<p>Following will convert text files between DOS, Mac, and Unix line ending styles:</p>
		<pre class="screen">
		
$ recode /cl../cr &lt;dos.txt &gt;mac.txt
$ recode /cr.. &lt;mac.txt &gt;unix.txt
$ recode ../cl &lt;unix.txt &gt;dos.txt
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="urandom"></a>20.7.10. /dev/urandom 随机字符串</h3></div></div></div>
		
		<pre class="screen">
		
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc A-Z-a-z-0-9 | head -c 8`
GidAuuNN
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc A-Z-a-z-0-9 | head -c 8`
UyGaWSKr
		
		</pre>
		<p>我常常使用这样的随机字符初始化密码</p>
		<pre class="screen">
		
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:alnum:] | head -c 8`
xig8Meym
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:alnum:] | head -c 8`
23Ac1vZg
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:digit:] | head -c 8`
73652314
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:graph:] | head -c 8`
GO_o&gt;OnJ
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:graph:] | head -c 10`
iGy0FS/aO5
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:graph:] | head -c 50`
;`E^{5(T4v~5$YovW.?%_?9la&lt;`+qPcRh@7mD\!Whx;MJZVQ\K
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:print:] | head -c 50`
fy$[#:'(')jt'gp1/g-)d~p]8 :r9i;MO2d!8M&lt;?Qs3t:QgK$O
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:graph:] | head -c 50`
6SivJ5y$/FTi8mf}rrqE&amp;s0"WkA}r;uK-=MT!Wp0UlL_lF0|bL
		
		</pre>
		<p>批量生成</p>
		<pre class="screen">
		
for i in {1..10}
do
echo `&lt; /dev/urandom tr -dc A-Z-a-z-0-9 | head -c 8`
done
		
		</pre>
		<pre class="screen">
		
# cat /dev/urandom | tr -cd [:alnum:] | fold -w30 | head -n 20
AVqROzjF6ZATJGv2J6PzDHp3jLpKV4
ONt68UFNDwgXpSnLBV7oRDX3VLRYsX
EZTWCGvZc3mIEeuw9sxMtV8ZkzVRJv
BhUiv0a7utsjZFLYpKGZrY5aDXcZL4
5YfUl2hmDT1O9X61DRYg4wSp4lXoXX
ykyPJxH47PzxnNGlujIUF98ZtB01H0
QyP53mksQN8bCNNo1fSD3RtqhhEGfa
u2RkT1M9GUQF4a6O18tG5WD97OOXze
Whm5X7398Q8L9BONN8k2oLy9CL37JO
TmGQz7WB6WnkjhyB4wrBHBJ3HMIRyf
hww43yvddUDYUnbNOKjhv3sLhCA4YD
uY6zQtBC6miwLUl3jkCVVA0Xu8ASgj
jv58qu46VW7LvRIq4txNE8bG9NBlZl
pzaMkydAiCHCF5H2oQVqMn4DTTYgNL
yoN2A9LyrCwLfjP1ad9HMAwxExJL5i
J27iy2L90m9dpcPLJ8tl46GGb9xqmQ
6YwFCvuPHyyEwnctUTpqLFcvUafVZ2
Nuq9XgIgRQGynjlVqGLMOpO0MkGpsn
tChkRG7eoRuKVXgW7ccTGx45E54K3Y
qPv48XqdGlOrdULCOGZ45kwJ1v5kVX		
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="col"></a>20.7.11. col - filter reverse line feeds from input</h3></div></div></div>
		
		<p>清除 ^M 字符</p>
		<pre class="screen">
$ cat oldfile | col -b &gt; newfile
		</pre>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="apg"></a>20.7.12. apg - generates several random passwords</h3></div></div></div>
		
		<pre class="screen">
sudo apt-get install apg

$ apg

Please enter some random data (only first 16 are significant)
(eg. your old password):&gt;
imlogNukcel5 (im-log-Nuk-cel-FIVE)
Drocdaf1 (Droc-daf-ONE)
fagJook0 (fag-Jook-ZERO)
heabugJer4 (heab-ug-Jer-FOUR)
5OsEsudy (FIVE-Os-Es-ud-y)
IrjOgneagOc9 (Irj-Og-neag-Oc-NINE)


$ apg -M SNCL -m 16
WoidWemFut6dryn,
byRowpEus-Flutt0
|QuogCagFaycsic0
ojHoadCyct4Freg_
Vir9blir`orhohoo
bapOip?Ibreawov2
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="head"></a>20.7.13. head/tail</h3></div></div></div>
		
		<pre class="screen">
head -c 17 | tail -c 1
		</pre>
	</div>
	

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="grep"></a>20.7.14. grep, egrep, fgrep, rgrep - print lines matching a pattern</h3></div></div></div>
	
	<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp60208960"></a>20.7.14.1. 删除空行</h4></div></div></div>
		
		<pre class="screen">
$ cat file | grep '.'
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="miscellaneous"></a>20.7.14.2. -v, --invert-match</h4></div></div></div>
		
		<p>grep -v "grep"</p>
		<pre class="screen">
[root@development ~]# ps ax | grep httpd
 6284 ?        Ss     0:10 /usr/local/httpd-2.2.14/bin/httpd -k start
 8372 ?        S      0:00 perl ./wrapper.pl -chdir -name httpd -class com.caucho.server.resin.Resin restart
19136 ?        S      0:00 /usr/local/httpd-2.2.14/bin/httpd -k start
19749 pts/1    R+     0:00 grep httpd
31530 ?        Sl     0:57 /usr/local/httpd-2.2.14/bin/httpd -k start
31560 ?        Sl     1:12 /usr/local/httpd-2.2.14/bin/httpd -k start
31623 ?        Sl     1:06 /usr/local/httpd-2.2.14/bin/httpd -k start
[root@development ~]# ps ax | grep httpd | grep -v grep
 6284 ?        Ss     0:10 /usr/local/httpd-2.2.14/bin/httpd -k start
 8372 ?        S      0:00 perl ./wrapper.pl -chdir -name httpd -class com.caucho.server.resin.Resin restart
19136 ?        S      0:00 /usr/local/httpd-2.2.14/bin/httpd -k start
31530 ?        Sl     0:57 /usr/local/httpd-2.2.14/bin/httpd -k start
31560 ?        Sl     1:12 /usr/local/httpd-2.2.14/bin/httpd -k start
31623 ?        Sl     1:06 /usr/local/httpd-2.2.14/bin/httpd -k start
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="grep.output"></a>20.7.14.3. Output control</h4></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp60214544"></a>20.7.14.3.1. -o, --only-matching       show only the part of a line matching PATTERN</h5></div></div></div>
			
			<pre class="screen">
			
$ curl -s http://www.example.com | egrep -o '&lt;a href="(.*)"&gt;.*&lt;/a&gt;' | sed -e 's/.*href="\([^"]*\)".*/\1/'
			
			</pre>
			<pre class="screen">
$ mysqlshow | egrep -o "|\w(.*)\w|"
Databases
information_schema
test
			</pre>
			<pre class="screen">
			
$ cat file.html | grep -o \
    -E '\b(([\w-]+://?|www[.])[^\s()&lt;&gt;]+(?:\([\w\d]+\)|([^[:punct:]\s]|/)))'

$ cat file.html | grep -o -E 'href="([^"#]+)"'

$ cat sss.html | grep -o -E 'thunder://([^&lt;]+)'
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp60217360"></a>20.7.14.3.2. 递归操作</h5></div></div></div>
			
			<p>递归查询</p>
			<pre class="screen">
$ sudo grep -r 'neo' /etc/*
			</pre>
			<p>递归替换</p>
			<pre class="screen">
			
for file in $( grep -rl '8800.org' *  | grep -v .svn ); do
    echo item: $file
	[ -f $file ] &amp;&amp; sed -e 's/8800\.org/sf\.net/g' -e 's/netkiller/neo/g' $file &gt;$file.bak; cp $file.bak $file;
done
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp60220160"></a>20.7.14.3.3. -c, --count               print only a count of matching lines per FILE</h5></div></div></div>
			
			<pre class="screen">
$ cat /etc/resolv.conf
nameserver localhost
nameserver 208.67.222.222
nameserver 208.67.220.220
nameserver 202.96.128.166
nameserver 202.96.134.133
$ grep -c nameserver /etc/resolv.conf
5
			</pre>
			<pre class="screen">
# grep -c GET /www/logs/access.log
188460

# grep -c POST /www/logs/access.log
421
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="grep.context"></a>20.7.14.4. Context control</h4></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp60223552"></a>20.7.14.4.1. -A, --after-context=NUM   print NUM lines of trailing context</h5></div></div></div>
			
			<p>返回匹配当前行至下面N行</p>
			<pre class="screen">
# grep -A1 game /etc/passwd
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin

# grep -A2 game /etc/passwd
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp60225616"></a>20.7.14.4.2. -B, --before-context=NUM  print NUM lines of leading context</h5></div></div></div>
			
			<p>返回匹配当前行至上面N行</p>
			<pre class="screen">
# grep -B1 game /etc/passwd
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin

# grep -B2 game /etc/passwd
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin

			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp60227648"></a>20.7.14.4.3. -C, --context=NUM         print NUM lines of output context</h5></div><div><h6 class="subtitle">-NUM                   same as --context=NUM</h6></div></div></div>
			
			
			<pre class="screen">
neo@neo-OptiPlex-380:~$ grep -C 1 new /etc/passwd
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh

neo@neo-OptiPlex-380:~$ grep -C 5 new /etc/passwd
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh

# grep -3 game /etc/passwd
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin

			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp60230544"></a>20.7.14.4.4. --color</h5></div></div></div>
			
			<pre class="screen">
# grep --color root  /etc/passwd
root:x:0:0:root:/root:/bin/bash
operator:x:11:0:operator:/root:/sbin/nologin
			</pre>
			<p>可以通过alias别名启用--color选项</p>
			<pre class="screen">
alias egrep='egrep --color=auto'
alias fgrep='fgrep --color=auto'
alias grep='grep --color=auto'
			</pre>
			<p>加入.bashrc中，每次用户登录将自动生效</p>
			<pre class="screen">
			
# enable color support of ls and also add handy aliases
if [ -x /usr/bin/dircolors ]; then
    test -r ~/.dircolors &amp;&amp; eval "$(dircolors -b ~/.dircolors)" || eval "$(dircolors -b)"
    alias ls='ls --color=auto'
    #alias dir='dir --color=auto'
    #alias vdir='vdir --color=auto'

    alias grep='grep --color=auto'
    alias fgrep='fgrep --color=auto'
    alias egrep='egrep --color=auto'
fi
			
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="regexp"></a>20.7.14.5. Regexp selection and interpretation</h4></div></div></div>
		
		<p>n 开头</p>
		<pre class="screen">
$ grep '^n' /etc/passwd
news:x:9:9:news:/var/spool/news:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
neo:x:1000:1000:neo chan,,,:/home/neo:/bin/bash
nagios:x:116:127::/var/run/nagios2:/bin/false
		</pre>
		<p>bash 结尾</p>
		<pre class="screen">
$ grep 'bash$' /etc/passwd
root:x:0:0:root:/root:/bin/bash
neo:x:1000:1000:neo chan,,,:/home/neo:/bin/bash
postgres:x:114:124:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
cvsroot:x:1001:1001:cvsroot,,,,:/home/cvsroot:/bin/bash
svnroot:x:1002:1002:subversion,,,,:/home/svnroot:/bin/bash
		</pre>
		<p>中间包含 root</p>
		<pre class="screen">
$ grep '.*root' /etc/passwd
root:x:0:0:root:/root:/bin/bash
cvsroot:x:1001:1001:cvsroot,,,,:/home/cvsroot:/bin/bash
svnroot:x:1002:1002:subversion,,,,:/home/svnroot:/bin/bash
		</pre>
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp60239152"></a>20.7.14.5.1. .*</h5></div></div></div>
			
			<pre class="screen">
			
$ curl -s http://www.example.com | egrep -o '&lt;a href=(.*)&gt;.*&lt;/a&gt;'
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp60240528"></a>20.7.14.5.2. 2010:(13|14|15|16)</h5></div></div></div>
			
			<p>regular 匹配一组</p>
			<pre class="screen">
egrep "2010:(13|14|15|16)"  access.2010-11-18.log &gt; apache.log
			</pre>
			<pre class="screen">
ps ax |grep -E "mysqld|httpd|resin"
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h5 class="title"><a id="idp60242832"></a>20.7.14.5.3. []与{}</h5></div></div></div>
			
			<p>源文件</p>
			<pre class="screen">
# cat /etc/fstab

#
# /etc/fstab
# Created by anaconda on Sat Sep 10 00:25:46 2011
#
# Accessible filesystems, by reference, are maintained under '/dev/disk'
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info
#
UUID=091f295e-ea6d-4f57-9314-e2333f7ebff7 /                       ext4    defaults        1 1
UUID=b3661a0b-2c50-4e18-8030-be2d043cbfc4 /www                    ext4    defaults        1 2
UUID=4d3468de-a2ac-451c-b693-3bdca8832096 swap                    swap    defaults        0 0
tmpfs                   /dev/shm                tmpfs   defaults        0 0
devpts                  /dev/pts                devpts  gid=5,mode=620  0 0
sysfs                   /sys                    sysfs   defaults        0 0
proc                    /proc                   proc    defaults        0 0

			</pre>
			<p>匹配每行包含4个连续字符的字符串的行。</p>
			<pre class="screen">
# grep '[A-Z]\{4\}' /etc/fstab
UUID=091f295e-ea6d-4f57-9314-e2333f7ebff7 /                       ext4    defaults        1 1
UUID=b3661a0b-2c50-4e18-8030-be2d043cbfc4 /www                    ext4    defaults        1 2
UUID=4d3468de-a2ac-451c-b693-3bdca8832096 swap                    swap    defaults        0 0
			</pre>

		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp60235040"></a>20.7.14.6. ^M</h4></div></div></div>
		
		<pre class="screen">
fgrep -rl `echo -ne '\r'` .

find . -type f -exec grep $'\r' {} +
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="egrep"></a>20.7.14.7. egrep</h4></div></div></div>
		
		<p>egrep = grep -E 在egrep中不许看使用转意字符，例如</p>
			<pre class="screen">
# grep '\(oo\).*\1' /etc/passwd
root:x:0:0:root:/root:/bin/bash

# grep -E '(oo).*\1' /etc/passwd
root:x:0:0:root:/root:/bin/bash

# egrep '(oo).*\1' /etc/passwd
root:x:0:0:root:/root:/bin/bash
			</pre>

		<pre class="screen">
$ snmpwalk -v2c -c public 172.16.1.254 | egrep -i 'if(in|out)'

for pid in $(ps -axf |grep 'php-cgi' | egrep egrep "0:00.(6|7|8|9)"'{print $1}'); do kill -9 $pid; done

for pid in $(ps -axf |grep 'php-cgi' | egrep "0:(0|1|2|3|4|5)0.(6|7|8|9)" |awk '{print $1}'); do kill -9 $pid; done
		</pre>
	</div>
</div>

	

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sort"></a>20.7.15. sort - sort lines of text files</h3></div></div></div>
	
	<pre class="screen">
$ du -s * | sort -k1,1rn
	</pre>
	<pre class="screen">
$ rpm -q -a --qf '%10{SIZE}\t%{NAME}\n' | sort -k1,1n
$ dpkg-query -W -f='${Installed-Size;10}\t${Package}\n' | sort -k1,1n
	</pre>
	<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp60253456"></a>20.7.15.1. 对列排序</h4></div></div></div>
		
		<pre class="screen">
# sort -t ':' -k 1 /etc/passwd
		</pre>
		<pre class="screen">
ort -n -t ‘ ‘ -k 2 file.txt
		</pre>
		<p>多列排序</p>
		<pre class="screen">
$ sort -n -t ‘ ‘ -k 2 -k 3 file.txt
		</pre>
	</div>
</div>


 <div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="uniq"></a>20.7.16. uniq</h3></div></div></div>
 	
 	<pre class="screen">
history | cut -c 8- |sort -r | uniq -u
 	</pre>
 	<pre class="screen">
# netstat -ant|fgrep ":"|cut -b 77-90|sort |uniq -c
      1 CLOSE_WAIT
      1 CLOSING
     88 ESTABLISHED
      7 FIN_WAIT1
      7 FIN_WAIT2
      3 LAST_ACK
      4 LISTEN
      1 SYN_RECV
      1 SYN_SENT
    177 TIME_WAIT
 	</pre>
 </div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="table"></a>20.7.17. 行列转换,表格操作</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp60265600"></a>20.7.17.1. column - columnate lists</h4></div></div></div>
			
			<pre class="screen">
$ (printf "PERM LINKS OWNER GROUP SIZE MONTH DAY HH:MM/YEAR NAME\n" ; ls -l | sed 1d) | column -t

$ cat /etc/passwd |tr ':' ' ' | column -t

$ cat /etc/passwd |tr ':' ' ' | column -t | colrm  20 20
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp60267296"></a>20.7.17.2. paste - merge lines of files</h4></div></div></div>
			
			<pre class="screen">
# vim test
aaaaa   bbbbb   ccccc   ddddd
1111    2222    3333    444

# paste -s test
aaaaa   bbbbb   ccccc   ddddd   1111    2222    3333    444
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rev"></a>20.7.18. 反转字符串或文件内容</h3></div><div><h4 class="subtitle">rev - reverse lines of a file or files</h4></div></div></div>
		
		
		<p>反转字符串 </p>
		<pre class="screen">
# echo hello | rev
olleh

# echo "hello world" | rev
dlrow olleh
		</pre>
		<p>反转文件内容 </p>
		<pre class="screen">
# rev /etc/passwd
hsab/nib/:toor/:toor:0:0:x:toor
nigolon/nibs/:nib/:nib:1:1:x:nib
nigolon/nibs/:nibs/:nomead:2:2:x:nomead
nigolon/nibs/:mda/rav/:mda:4:3:x:mda
nigolon/nibs/:dpl/loops/rav/:pl:7:4:x:pl
cnys/nib/:nibs/:cnys:0:5:x:cnys
nwodtuhs/nibs/:nibs/:nwodtuhs:0:6:x:nwodtuhs
tlah/nibs/:nibs/:tlah:0:7:x:tlah
nigolon/nibs/:liam/loops/rav/:liam:21:8:x:liam
nigolon/nibs/:pcuu/loops/rav/:pcuu:41:01:x:pcuu
nigolon/nibs/:toor/:rotarepo:0:11:x:rotarepo
nigolon/nibs/:semag/rsu/:semag:001:21:x:semag
nigolon/nibs/:rehpog/rav/:rehpog:03:31:x:rehpog
nigolon/nibs/:ptf/rav/:resU PTF:05:41:x:ptf
nigolon/nibs/:/:ydoboN:99:99:x:ydobon
nigolon/nibs/:ved/:renwo yromem elosnoc lautriv:96:96:x:ascv
nigolon/nibs/:ptn/cte/::83:83:x:ptn
nigolon/nibs/:htualsas/ytpme/rav/:"resu dhtualsaS":67:994:x:htualsas
nigolon/nibs/:xiftsop/loops/rav/::98:98:x:xiftsop
nigolon/nibs/:dhss/ytpme/rav/:HSS detarapes-egelivirP:47:47:x:dhss
hsab/nib/:lqsym/bil/rav/:revres LQSyM:994:894:x:lqsym
hsab/nib/:www/:noitacilppA beW:08:08:x:www
nigolon/nibs/:xnign/ehcac/rav/:resu xnign:894:794:x:xnign
		</pre>
	</div>
</div><div xmlns="" id="disqus_thread"></div><script xmlns="" type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

            //if(document.domain == 'netkiller.github.com'){
            var disqus_shortname = 'netkiller'; // required: replace example with your forum shortname
            //}else{
			//var disqus_shortname = 'neochan';
            //}

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script><noscript xmlns="">Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a xmlns="" href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a><br xmlns="" /><div xmlns="" id="clustrmaps-widget"></div><script xmlns="" type="text/javascript">var _clustrmaps = {'url' : 'http://netkiller.github.io', 'user' : 1107643, 'server' : '2', 'id' : 'clustrmaps-widget', 'version' : 1, 'date' : '2013-08-14', 'lang' : 'en', 'corners' : 'square' };(function (){ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'http://www2.clustrmaps.com/counter/map.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x);})();</script><noscript xmlns=""><a href="http://www2.clustrmaps.com/user/87410e6bb"><img src="http://www2.clustrmaps.com/stats/maps-no_clusters/netkiller.github.io-thumb.jpg" alt="Locations of visitors to this page" /></a></noscript><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="numeric.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="log.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">20.6. Numeric </td><td width="20%" align="center"><a accesskey="h" href="../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 20.8. Logging</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F997cd4a7320a82d72cb74d179118f697' type='text/javascript'%3E%3C/script%3E"));
</script><script xmlns="" type="text/javascript" src="/js/q.js"></script></body></html>