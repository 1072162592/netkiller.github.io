<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>13.2. SSL Tunnel</title><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><meta name="keywords" content="md5sum, openssl, openpgp, opengpg, md5, sha1, des, rsa, uuid, base64, quoted-printable, uuencode, x509,smime"><link rel="home" href="index.html" title="Netkiller Cryptography 手札"><link rel="up" href="ch13.html" title="Chapter 13. Secure Tunnel"><link rel="prev" href="ch13.html" title="Chapter 13. Secure Tunnel"><link rel="next" href="ch14.html" title="Chapter 14. 硬盘分区与文件系统加密"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section" title="13.2. SSL Tunnel"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tunnel.ssl"></a>13.2. SSL Tunnel</h2></div></div></div>
		
		<p>http://www.stunnel.org/</p>
		<div class="section" title="13.2.1. 通过SSL访问POP、IMAP、SMTP"><div class="titlepage"><div><div><h3 class="title"><a name="idp543344"></a>13.2.1. 通过SSL访问POP、IMAP、SMTP</h3></div></div></div>
			
			<div class="example"><a name="idp544192"></a><p class="title"><b>Example 13.1. stunnel.conf</b></p><div class="example-contents">
				
				<pre class="screen">
				
# Sample stunnel configuration file
# Copyright by Michal Trojnara 2002

# Comment it out on Win32
cert = /etc/stunnel/stunnel.pem
# chroot = /usr/var/run/stunnel/
# PID is created inside chroot jail
pid = /stunnel.pid
#setuid = nobody
#setgid = nogroup

setuid = root
setgid = root

# Workaround for Eudora bug
#options = DONT_INSERT_EMPTY_FRAGMENTS

# Authentication stuff
#verify = 2
# don't forget about c_rehash CApath
# it is located inside chroot jail:
#CApath = /certs
# or simply use CAfile instead:
#CAfile = /usr/etc/stunnel/certs.pem

# Some debugging stuff
debug = 7
output = stunnel.log

# Use it for client mode
#client = yes

# Service-level configuration

[pop3s]
accept  = 995
connect = 110

[imaps]
accept  = 993
connect = 143

[ssmtp]
accept  = 465
connect = 25

#[https]
#accept  = 443
#connect = 80
#TIMEOUTclose = 0

[nntps]
accept  = 563
connect = 119
				
				</pre>
			</div></div><br class="example-break">
			<pre class="screen">
# SMTP
/sbin/iptables -A INPUT -p tcp --dport 25 -j ACCEPT
# SMTPS
/sbin/iptables -A INPUT -p tcp --dport 465 -j ACCEPT
# POP3
/sbin/iptables -A INPUT -p tcp --dport 110 -j ACCEPT
# POP3S
/sbin/iptables -A INPUT -p tcp --dport 995 -j ACCEPT
# IMAP
/sbin/iptables -A INPUT -p tcp --dport 143 -j ACCEPT
# IMAPS
/sbin/iptables -A INPUT -p tcp --dport 993 -j ACCEPT
			</pre>
			<p></p>
			<pre class="screen">
[root@linuxas3 stunnel]# nmap localhost

Starting nmap V. 3.00 ( www.insecure.org/nmap/ )
Interesting ports on linuxas3.9812.net (127.0.0.1):
(The 1582 ports scanned but not shown below are in state: closed)
Port       State       Service
22/tcp     open        ssh
25/tcp     open        smtp
80/tcp     open        http
110/tcp    open        pop-3
111/tcp    open        sunrpc
119/tcp    open        nntp
143/tcp    open        imap2
443/tcp    open        https
465/tcp    open        smtps
563/tcp    open        snews
631/tcp    open        ipp
783/tcp    open        hp-alarm-mgr
993/tcp    open        imaps
995/tcp    open        pop3s
3306/tcp   open        mysql
5000/tcp   open        UPnP
5001/tcp   open        commplex-link
8009/tcp   open        ajp13
8080/tcp   open        http-proxy

Nmap run completed -- 1 IP address (1 host up) scanned in 3 seconds
[root@linuxas3 stunnel]#
			</pre>
		</div>
	</div></body></html>
