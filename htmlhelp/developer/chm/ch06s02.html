<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>6.2. CMake</title><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><meta name="keywords" content="PHP, Python, Perl, Ruby, Java, HTML, XHTML, HTML5, CSS, Javascript, JQuery, C, C++, D"><link rel="home" href="index.html" title="Netkiller Developer 手札"><link rel="up" href="ch06.html" title="第 6 章 Build tool"><link rel="prev" href="ch06.html" title="第 6 章 Build tool"><link rel="next" href="ch06s03.html" title="6.3. scons - a software construction tool"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section" title="6.2. CMake"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cmake"></a>6.2. CMake</h2></div></div></div>
	
	<p><a class="ulink" href="http://www.cmake.org/" target="_top">http://www.cmake.org/</a></p>
	<div class="section" title="6.2.1. helloworld"><div class="titlepage"><div><div><h3 class="title"><a name="idp368496"></a>6.2.1. helloworld</h3></div></div></div>
		
		<p>安装CMake</p>
		<pre class="screen">
$ sudo yum install gcc gcc-c++
$ sudo yum install make

$ sudo yum install cmake28
$ sudo ln -s /usr/bin/cmake28 /usr/bin/cmake
$ cmake --version
cmake version 2.8.9
		</pre>
		<p>创建 CMakeLists.txt 文件</p>
		<pre class="screen">
$ cat CMakeLists.txt
PROJECT(example)
ADD_EXECUTABLE(example main.c)
		</pre>
		<p>创建 main.c 文件</p>
		<pre class="screen">
		
$ cat main.c
#include &lt;stdio.h&gt;
int main() {
   printf("helloworld!\n");
   return 0;
}
		
		</pre>
		<p>编译程序</p>
		<pre class="screen">
$ cmake .
-- Configuring done
-- Generating done
-- Build files have been written to: /home/neo/example

$ make
Scanning dependencies of target example
[100%] Building C object CMakeFiles/example.dir/main.c.o
Linking C executable example
[100%] Built target example

$ ./example
helloworld!
		</pre>
	</div>
	<div class="section" title="6.2.2. cmake_minimum_required"><div class="titlepage"><div><div><h3 class="title"><a name="idp374256"></a>6.2.2. cmake_minimum_required</h3></div></div></div>
		
		<pre class="screen">
cmake_minimum_required(VERSION 2.8.7)
		</pre>
	</div>
	<div class="section" title="6.2.3. SET"><div class="titlepage"><div><div><h3 class="title"><a name="idp375472"></a>6.2.3. SET</h3></div></div></div>
		
		<pre class="screen">
SET(CMAKE_INSTALL_PREFIX /usr/local)
		</pre>
		<p>改变 CMAKE_INSTALL_PREFIX 变量</p>
		<pre class="screen">
cmake -DCMAKE_INSTALL_PREFIX=/usr ..
		</pre>
	</div>
	<div class="section" title="6.2.4. ADD_SUBDIRECTORY"><div class="titlepage"><div><div><h3 class="title"><a name="idp377840"></a>6.2.4. ADD_SUBDIRECTORY</h3></div></div></div>
		
		<pre class="screen">
ADD_SUBDIRECTORY(src bin)
		</pre>
	</div>
	<div class="section" title="6.2.5. INCLUDE_DIRECTORIES"><div class="titlepage"><div><div><h3 class="title"><a name="idp379152"></a>6.2.5. INCLUDE_DIRECTORIES</h3></div></div></div>
		
		<pre class="screen">
INCLUDE_DIRECTORIES(/usr/include/xen)
		</pre>
	</div>
	<div class="section" title="6.2.6. ADD_EXECUTABLE / ADD_LIBRARY"><div class="titlepage"><div><div><h3 class="title"><a name="idp380592"></a>6.2.6. ADD_EXECUTABLE / ADD_LIBRARY</h3></div></div></div>
		
		<pre class="screen">
SET(SRC_LIST main.cc
        src/file1.c
        src/file2.c
        )

ADD_EXECUTABLE(hello ${SRC_LIST})
		</pre>
	</div>
	<div class="section" title="6.2.7. EXECUTABLE_OUTPUT_PATH / LIBRARY_OUTPUT_PATH"><div class="titlepage"><div><div><h3 class="title"><a name="idp381872"></a>6.2.7. EXECUTABLE_OUTPUT_PATH / LIBRARY_OUTPUT_PATH</h3></div></div></div>
		
		<pre class="screen">
SET(EXECUTABLE_OUTPUT_PATH ${PROJECT_BINARY_DIR}/bin)
SET(LIBRARY_OUTPUT_PATH ${PROJECT_BINARY_DIR}/lib)
		</pre>
	</div>
	<div class="section" title="6.2.8. TARGET_LINK_LIBRARIES"><div class="titlepage"><div><div><h3 class="title"><a name="idp383344"></a>6.2.8. TARGET_LINK_LIBRARIES</h3></div></div></div>
		
		<pre class="screen">
TARGET_LINK_LIBRARIES(hello log4cpp)
		</pre>
	</div>
	<div class="section" title="6.2.9. INSTALL"><div class="titlepage"><div><div><h3 class="title"><a name="idp384816"></a>6.2.9. INSTALL</h3></div></div></div>
		
		<pre class="screen">
INSTALL(PROGRAMS hello DESTINATION bin)

INSTALL(FILES COPYRIGHT README DESTINATION share/doc/hello)

INSTALL(DIRECTORY doc/ DESTINATION share/doc/hello)
		</pre>
	</div>
</div></body></html>
