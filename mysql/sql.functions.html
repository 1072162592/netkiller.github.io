<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>6. Functions and Operators</title><link rel="stylesheet" href="/docbook.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.75.2" /><link rel="home" href="index.html" title="Netkiller MySQL 手札" /><link rel="up" href="sql.html" title="第 6 章 SQL Statement Syntax" /><link rel="prev" href="sql.92.html" title="5. SQL 92" /><link rel="next" href="backup.snapshot.html" title="2. Snapshot Backup" /><script xmlns="" type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11694057-1']);
  _gaq.push(['_setDomainName', 'netkiller.sourceforge.net']);
  _gaq.push(['_setAllowHash', 'false']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6. Functions and Operators</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="sql.92.html">上一页</a> </td><th width="60%" align="center">第 6 章 SQL Statement Syntax</th><td width="20%" align="right"> <a accesskey="n" href="backup.snapshot.html">下一页</a></td></tr></table><hr /></div><table xmlns="" width="100%" border="0"><tr><td align="left"><a href="http://netkiller.sourceforge.net/">Home</a> |
                <a href="http://netkiller.github.com/">Mirror</a> |
                <a href="/search.html">Search</a></td><td align="right"><form id="searchbox_008589143145807374698:f5uprauilyy" action="/search.html"><input type="hidden" name="cx" value="008589143145807374698:f5uprauilyy" /><input type="hidden" name="cof" value="FORID:11" /><input name="q" type="text" size="25" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: rgb(126, 157, 185); border-right-color: rgb(126, 157, 185); border-bottom-color: rgb(126, 157, 185); border-left-color: rgb(126, 157, 185); padding-top: 2px; padding-right: 2px; padding-bottom: 2px; padding-left: 2px; background-image: url(http://www.google.com/cse/intl/en/images/google_custom_search_watermark.gif); background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(255, 255, 255); background-position: 0% 50%; background-repeat: no-repeat no-repeat; " /><input type="submit" name="sa" value="Search" /><input name="siteurl" type="hidden" value="http://netkiller.sourceforge.net/" /></form><script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=searchbox_008589143145807374698%3Af5uprauilyy"></script></td></tr></table><div class="section" title="6. Functions and Operators"><div class="titlepage"><div><div><h3 class="title"><a id="sql.functions"></a>6. Functions and Operators</h3></div></div></div><div class="section" title="6.1. COUNT"><div class="titlepage"><div><div><h4 class="title"><a id="fun.count"></a>6.1. COUNT</h4></div></div></div><p>count()</p><pre class="screen">
SELECT (SELECT count(1) FROM ecs_category) as 'Export category count',
	(SELECT count(1) FROM ecs_goods) as 'Goods count',
	(SELECT count(1) FROM ecs_goods_attr) as 'Attr count';
		</pre></div><div class="section" title="6.2. String"><div class="titlepage"><div><div><h4 class="title"><a id="fun.string"></a>6.2. String</h4></div></div></div><div class="section" title="6.2.1. LEFT/RIGHT"><div class="titlepage"><div><div><h5 class="title"><a id="fun.left"></a>6.2.1. LEFT/RIGHT</h5></div></div></div><p>LEFT(str,len)</p><pre class="screen">
mysql&gt; select left(concat('1','0000000'),5) as number;
+--------+
| number |
+--------+
| 10000  |
+--------+
1 row in set (0.00 sec)
			</pre><p>RIGHT(str,len)</p><pre class="screen">
mysql&gt; select right(concat('0000000','1'),5) as number;
+--------+
| number |
+--------+
| 00001  |
+--------+
1 row in set (0.00 sec)
			</pre></div><div class="section" title="6.2.2. RPAD/LPAD"><div class="titlepage"><div><div><h5 class="title"><a id="fun.rpad"></a>6.2.2. RPAD/LPAD</h5></div></div></div><p>补齐长度用'0'填充</p><span class="command"><strong>RPAD(str,len,padstr)</strong></span><pre class="screen">
mysql&gt; select rpad('10',5,'0') as txt;
+-------+
| txt   |
+-------+
| 10000 |
+-------+
1 row in set (0.01 sec)
			</pre><span class="command"><strong>LPAD(str,len,padstr)</strong></span><pre class="screen">
mysql&gt; select lpad('10',5,'0') as txt;
+-------+
| txt   |
+-------+
| 00010 |
+-------+
1 row in set (0.00 sec)
			</pre></div><div class="section" title="6.2.3. CONCAT"><div class="titlepage"><div><div><h5 class="title"><a id="fun.concat"></a>6.2.3. CONCAT</h5></div></div></div><p>CONCAT(str1,str2,...) </p><pre class="screen">
mysql&gt; select concat('Neo',' ','Chen') as Name;
+----------+
| Name     |
+----------+
| Neo Chen |
+----------+
1 row in set (0.00 sec)
			</pre></div><div class="section" title="6.2.4. GROUP_CONCAT"><div class="titlepage"><div><div><h5 class="title"><a id="fun.group_concat"></a>6.2.4. GROUP_CONCAT</h5></div></div></div><p></p><pre class="screen">
mysql&gt; select GROUP_CONCAT(CONVERT( username , CHAR (16)) order by username desc) as username from test;
+-------------------------------------------+
| username                                  |
+-------------------------------------------+
| jam,jam2,john,john2,john3,neo,neo1,neo2   |
+-------------------------------------------+
6 rows in set, 1 warning (0.01 sec)
			</pre></div><div class="section" title="6.2.5. replace"><div class="titlepage"><div><div><h5 class="title"><a id="fun.replace"></a>6.2.5. replace</h5></div></div></div><pre class="screen">
select replace(goods_desc,':8000','') from ecs_goods;

update ecs_goods set goods_desc=replace(goods_desc,':8000','');
			</pre></div></div><div class="section" title="6.3. Data and Time"><div class="titlepage"><div><div><h4 class="title"><a id="fun.data"></a>6.3. Data and Time</h4></div></div></div><div class="section" title="6.3.1. year/month/day hour:minite:second"><div class="titlepage"><div><div><h5 class="title"><a id="idp377600"></a>6.3.1. year/month/day hour:minite:second</h5></div></div></div><pre class="screen">
			
mysql&gt; select year('2012-03-20');
+--------------------+
| year('2012-03-20') |
+--------------------+
|               2012 |
+--------------------+
1 row in set (0.00 sec)

mysql&gt; select month('2012-03-20');
+---------------------+
| month('2012-03-20') |
+---------------------+
|                   3 |
+---------------------+
1 row in set (0.00 sec)

mysql&gt; select day('2012-03-20');
+-------------------+
| day('2012-03-20') |
+-------------------+
|                20 |
+-------------------+
1 row in set (0.00 sec)

mysql&gt; select hour('12:30:55');
+------------------+
| hour('12:30:55') |
+------------------+
|               12 |
+------------------+
1 row in set (0.00 sec)

mysql&gt; select minute('12:30:55');
+--------------------+
| minute('12:30:55') |
+--------------------+
|                 30 |
+--------------------+
1 row in set (0.00 sec)

mysql&gt; select second('12:30:55');
+--------------------+
| second('12:30:55') |
+--------------------+
|                 55 |
+--------------------+
1 row in set (0.00 sec)
			
			
			</pre></div><div class="section" title="6.3.2. Unix time"><div class="titlepage"><div><div><h5 class="title"><a id="idp379200"></a>6.3.2. Unix time</h5></div></div></div><pre class="screen">
			
mysql&gt; SELECT UNIX_TIMESTAMP('2005-03-27 02:00:00');
+---------------------------------------+
| UNIX_TIMESTAMP('2005-03-27 02:00:00') |
+---------------------------------------+
|                            1111885200 |
+---------------------------------------+
mysql&gt; SELECT FROM_UNIXTIME(1111885200);
+---------------------------+
| FROM_UNIXTIME(1111885200) |
+---------------------------+
| 2005-03-27 03:00:00       |
+---------------------------+
			
			</pre></div><div class="section" title="6.3.3. DATE_SUB"><div class="titlepage"><div><div><h5 class="title"><a id="idp380152"></a>6.3.3. DATE_SUB</h5></div></div></div><p>当前时间向后推10天</p><pre class="programlisting">
			
mysql&gt; select DATE_SUB(now(), INTERVAL 240 HOUR);
+------------------------------------+
| DATE_SUB(now(), INTERVAL 240 HOUR) |
+------------------------------------+
| 2012-03-09 10:26:03                |
+------------------------------------+
1 row in set (0.00 sec)

mysql&gt; select DATE_SUB(now(), INTERVAL 24 HOUR);
+-----------------------------------+
| DATE_SUB(now(), INTERVAL 24 HOUR) |
+-----------------------------------+
| 2012-03-18 10:28:43               |
+-----------------------------------+
1 row in set (0.00 sec)
			
			</pre><pre class="programlisting">
			
DELETE from Message where created &lt; DATE_sub(now(), INTERVAL 240 HOUR);			
			
			</pre></div><div class="section" title="6.3.4. datediff / timediff"><div class="titlepage"><div><div><h5 class="title"><a id="idp381712"></a>6.3.4. datediff / timediff</h5></div></div></div><p>计算时间差，两个时间相减结果</p><pre class="screen">
			
mysql&gt; select timediff('22:20:00','17:30:00');
+---------------------------------+
| timediff('22:20:00','17:30:00') |
+---------------------------------+
| 04:50:00                        |
+---------------------------------+
1 row in set (0.00 sec)

mysql&gt; select datediff('2008-08-08 12:00:00', '2008-08-01 00:00:00');
+--------------------------------------------------------+
| datediff('2008-08-08 12:00:00', '2008-08-01 00:00:00') |
+--------------------------------------------------------+
|                                                      7 |
+--------------------------------------------------------+
1 row in set (0.00 sec)
			
			</pre></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sql.92.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="sql.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="backup.snapshot.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">5. SQL 92 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 2. Snapshot Backup</td></tr></table></div></body></html>
