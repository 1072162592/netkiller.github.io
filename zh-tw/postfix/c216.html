<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML
><HEAD
><TITLE
>域名</TITLE
>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="Postfix Integrated Solution"
HREF="book1.html" tppabs="http://www.9812.net/article/postfix/book1.html"><LINK
REL="PREVIOUS"
TITLE="卸載現有的郵件系統"
HREF="x201.html" tppabs="http://www.9812.net/article/postfix/x201.html"><LINK
REL="NEXT"
TITLE="BIND 9 例子"
HREF="x303.html" tppabs="http://www.9812.net/article/postfix/x303.html"></HEAD
><BODY
CLASS="CHAPTER"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Postfix Integrated Solution</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x201.html" tppabs="http://www.9812.net/article/postfix/x201.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x303.html" tppabs="http://www.9812.net/article/postfix/x303.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="CHAPTER"
><H1
><A
NAME="DOMAINNAME"
></A
>域名</H1
><DIV
CLASS="SECTION"
><H1
CLASS="SECTION"
><A
NAME="AEN221"
></A
>域名設置</H1
><P
>注意！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！</P
><P
>域名設置這一步驟非常重要，如果設置不當，就會出現郵件發不出，收不到等等問題……</P
><P
>以中國萬網的域名管理為例,下面是<A
HREF="javascript:if(confirm('http://www.net.cn/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.net.cn/'" tppabs="http://www.net.cn/"
TARGET="_top"
><I
CLASS="CITETITLE"
>中國萬網</I
></A
>的域名管理面板</P
><DIV
CLASS="FIGURE"
><A
NAME="AEN228"
></A
><P
><IMG
SRC="domainname.png" tppabs="http://www.9812.net/article/postfix/images/domainname.png"></P
><P
><B
>Figure 1. Domain Name</B
></P
></DIV
><DIV
CLASS="PROCEDURE"
><OL
TYPE="1"
><LI
><P
><B
>A 記錄</B
></P
><P
>添加mail A記錄，並解析到你伺服器的IP</P
></LI
><LI
><P
><B
>MX 郵件交換記錄</B
></P
><P
>添加mx 記錄，並解析到你mail主機</P
></LI
><LI
><P
><B
>保存設置</B
></P
><P
>保存設置後，一般會在48小時後生效</P
></LI
><LI
><P
><B
>注意事項</B
></P
><P
>有一些域名提供商的mx 記錄要在主機後加".",中國萬網的不用，他們會自動給你加上。如果你的域名是在外國註冊的。如美國，域名更新要4-7個工作日。</P
></LI
></OL
></DIV
><P
>如果不想等48個小時，你可以修改你的系統DNS，設為你的域名提供商的DNS。這裡以中國萬網為例：</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>C:\&#62;<TT
CLASS="USERINPUT"
><B
>nslookup</B
></TT
>
Default Server:  apngw.sz002.nfht
Address:  192.168.0.253

&#62; <TT
CLASS="USERINPUT"
><B
>set type=ns</B
></TT
>
&#62; <TT
CLASS="USERINPUT"
><B
>net.cn</B
></TT
>
Server:  apngw.sz002.nfht
Address:  192.168.0.253

Non-authoritative answer:
net.cn  nameserver = sld-ns2.cnnic.net.cn
net.cn  nameserver = sld-ns3.cnnic.net.cn
net.cn  nameserver = sld-ns4.cnnic.net.cn
net.cn  nameserver = sld-ns5.cnnic.net.cn
net.cn  nameserver = cns.cernet.net
net.cn  nameserver = sld-ns1.cnnic.net.cn

sld-ns2.cnnic.net.cn    internet address = 202.97.16.197
sld-ns3.cnnic.net.cn    internet address = 210.52.214.85
sld-ns4.cnnic.net.cn    internet address = 61.145.114.119
sld-ns5.cnnic.net.cn    internet address = 61.139.76.54
cns.cernet.net  internet address = 202.112.0.24
sld-ns1.cnnic.net.cn    internet address = 159.226.1.3
&#62; <TT
CLASS="USERINPUT"
><B
>set querytype=ns</B
></TT
>
&#62; <TT
CLASS="USERINPUT"
><B
>www.net.cn</B
></TT
>
Server:  apngw.sz002.nfht
Address:  192.168.0.253

Non-authoritative answer:
www.net.cn      nameserver = dns2.hichina.com
www.net.cn      nameserver = dns1.hichina.com

dns2.hichina.com        internet address = 202.106.169.100
dns1.hichina.com        internet address = 218.30.103.50
&#62; <TT
CLASS="USERINPUT"
><B
>dns1.hichina.com</B
></TT
>
Server:  apngw.sz002.nfht
Address:  192.168.0.253

hichina.com
        primary name server = dns1.hichina.com
        responsible mail addr = hostmaster.hichina.com
        serial  = 2004040801
        refresh = 21601 (6 hours 1 sec)
        retry   = 3600 (1 hour)
        expire  = 1728000 (20 days)
        default TTL = 43200 (12 hours)
&#62; <TT
CLASS="USERINPUT"
><B
>dns2.hichina.com</B
></TT
>
Server:  apngw.sz002.nfht
Address:  192.168.0.253

hichina.com
        primary name server = dns1.hichina.com
        responsible mail addr = hostmaster.hichina.com
        serial  = 2004040801
        refresh = 21601 (6 hours 1 sec)
        retry   = 3600 (1 hour)
        expire  = 1728000 (20 days)
        default TTL = 43200 (12 hours)
&#62; <TT
CLASS="USERINPUT"
><B
>set type=a</B
></TT
>
&#62; <TT
CLASS="USERINPUT"
><B
>dns1.hichina.com</B
></TT
>
Server:  apngw.sz002.nfht
Address:  192.168.0.253

Non-authoritative answer:
Name:    dns1.hichina.com
Address:  218.30.103.50

&#62; <TT
CLASS="USERINPUT"
><B
>dns2.hichina.com</B
></TT
>
Server:  apngw.sz002.nfht
Address:  192.168.0.253

Non-authoritative answer:
Name:    dns2.hichina.com
Address:  202.106.169.100

&#62;
&#62; exit

C:\&#62;
		</PRE
></TD
></TR
></TABLE
><P
>首先，單擊開始菜單-&#62;運行-&#62;輸入cmd。進入CLI(命令行界面)然後運行nslookup程序，nslookup會顯示"&#62;"命令提示符</P
><P
></P
><UL
><LI
><P
>set type=ns</P
><P
>設計查詢類型，ns是查詢dns伺服器</P
><P
>net.cn</P
><P
>顯示net.cn域名的上級dns,可以看得出net.cn上級是cnnic(<A
HREF="javascript:if(confirm('http://www.cnnic.net.cn/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.cnnic.net.cn/'" tppabs="http://www.cnnic.net.cn/"
TARGET="_top"
><I
CLASS="CITETITLE"
>中國互聯網絡信息中心</I
></A
>)</P
></LI
><LI
><P
>set querytype=ns</P
><P
>與set type=ns相同</P
><P
>www.net.cn</P
><P
>顯示www.net.cn的dns伺服器</P
><P
>dns2.hichina.com</P
><P
>dns1.hichina.com</P
><P
>這就是我們要的dns伺服器,你可以使用ping命令得到dns的IP,也可以使用正向解析得到它的IP。</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="SCREEN"
>C:\&#62;ping dns2.hichina.com

Pinging dns2.hichina.com [202.106.169.100] with 32 bytes of data:

Reply from 202.106.169.100: bytes=32 time=243ms TTL=241
Reply from 202.106.169.100: bytes=32 time=233ms TTL=241
Reply from 202.106.169.100: bytes=32 time=312ms TTL=241
Reply from 202.106.169.100: bytes=32 time=236ms TTL=241

Ping statistics for 202.106.169.100:
    Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 233ms, Maximum = 312ms, Average = 256ms

C:\&#62;
				</PRE
></TD
></TR
></TABLE
></LI
><LI
><P
>set type=a</P
><P
>dns1.hichina.com</P
><P
>通過正向解析得到dns1.hichina.com的IP</P
></LI
></UL
><P
>設置Internet 協議（TCP/IP）</P
><DIV
CLASS="FIGURE"
><A
NAME="AEN280"
></A
><P
><IMG
SRC="network_tcp_ip.png" tppabs="http://www.9812.net/article/postfix/images/network_tcp_ip.png"></P
><P
><B
>Figure 2. Internet 協議（TCP/IP）屬性</B
></P
></DIV
><P
>Linux</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>[root@linux root]# <TT
CLASS="USERINPUT"
><B
>vi /etc/resolv.conf</B
></TT
>
nameserver 218.30.103.50
nameserver 202.106.169.100
		</PRE
></TD
></TR
></TABLE
><P
>測試你的域名</P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>C:\&#62;<TT
CLASS="USERINPUT"
><B
>nslookup</B
></TT
>
Default Server:  apngw.sz002.nfht
Address:  192.168.0.253

&#62; <TT
CLASS="USERINPUT"
><B
>9812.net</B
></TT
>
Server:  apngw.sz002.nfht
Address:  192.168.0.253

Name:    9812.net
Address:  202.103.190.130
&#62; <TT
CLASS="USERINPUT"
><B
>set type=ns</B
></TT
>
&#62; <TT
CLASS="USERINPUT"
><B
>9812.net</B
></TT
>
Server:  apngw.sz002.nfht
Address:  192.168.0.253

Non-authoritative answer:
9812.net        nameserver = dns1.hichina.com
9812.net        nameserver = dns2.hichina.com

dns1.hichina.com        internet address = 218.30.103.50
dns2.hichina.com        internet address = 202.106.169.100
&#62; <TT
CLASS="USERINPUT"
><B
>set type=mx</B
></TT
>
&#62; <TT
CLASS="USERINPUT"
><B
>9812.net</B
></TT
>
Server:  apngw.sz002.nfht
Address:  192.168.0.253

9812.net        MX preference = 10, mail exchanger = mail.9812.net
9812.net        nameserver = dns2.hichina.com
9812.net        nameserver = dns1.hichina.com
mail.9812.net   internet address = 202.103.190.130
dns2.hichina.com        internet address = 202.106.169.100
dns1.hichina.com        internet address = 218.30.103.50
&#62;		
		</PRE
></TD
></TR
></TABLE
><P
>Linux CLI </P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="SCREEN"
>[root@linux root]# <TT
CLASS="USERINPUT"
><B
>nslookup</B
></TT
>
Note:  nslookup is deprecated and may be removed from future releases.
Consider using the `dig' or `host' programs instead.  Run nslookup with
the `-sil[ent]' option to prevent this message from appearing.
&#62; <TT
CLASS="USERINPUT"
><B
>9812.net</B
></TT
>
Server:         202.96.128.68
Address:        202.96.128.68#53

Non-authoritative answer:
Name:   9812.net
Address: 202.103.190.130
&#62; <TT
CLASS="USERINPUT"
><B
>set type=mx</B
></TT
>
&#62; <TT
CLASS="USERINPUT"
><B
>9812.net</B
></TT
>
Server:         218.30.103.50
Address:        218.30.103.50#53

9812.net        mail exchanger = 10 mail.9812.net.
&#62; <TT
CLASS="USERINPUT"
><B
>set type=ns</B
></TT
>
&#62; <TT
CLASS="USERINPUT"
><B
>9812.net</B
></TT
>
Server:         202.96.128.68
Address:        202.96.128.68#53

Non-authoritative answer:
9812.net        nameserver = dns1.hichina.com.
9812.net        nameserver = dns2.hichina.com.

Authoritative answers can be found from:
&#62; 
		</PRE
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x201.html" tppabs="http://www.9812.net/article/postfix/x201.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="book1.html" tppabs="http://www.9812.net/article/postfix/book1.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x303.html" tppabs="http://www.9812.net/article/postfix/x303.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>卸載現有的郵件系統</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
>&nbsp;</TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>BIND 9 例子</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>