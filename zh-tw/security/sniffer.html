<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 1 章 Sniffer</title><link rel="stylesheet" type="text/css" href="/docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.76.1" /><meta name="keywords" content="Sniffer, Scanner, Vulnerability, Penetration, nmap, tcpdump, sqlmap, Nessus, Backtrack" /><link rel="home" href="index.html" title="Netkiller Security 手札" /><link rel="up" href="index.html" title="Netkiller Security 手札" /><link rel="prev" href="reader.html" title="3. 寫給讀者" /><link rel="next" href="tcpdump.html" title="2. tcpdump - A powerful tool for network monitoring and data acquisition" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 1 章 Sniffer</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="reader.html">上一頁</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="tcpdump.html">下一頁</a></td></tr></table><hr /></div><table xmlns="" width="100%" border="0"><tr><td align="left"><a href="http://netkiller.github.io/">Home</a> |
                <a href="http://netkiller.sourceforge.net/">Mirror</a> |
                <a href="/search.html">Search</a></td><td><div id="bdshare" class="bdshare_t bds_tools_32 get-codes-bdshare"><a class="bds_fbook"></a><a class="bds_twi"></a><a class="bds_ms"></a><a class="bds_msn"></a><a class="bds_buzz"></a><a class="bds_linkedin"></a><a class="bds_deli"></a><a class="bds_qzone"></a><a class="bds_qq"></a><a class="bds_tqq"></a><a class="bds_tqf"></a><a class="bds_tsina"></a><a class="bds_baidu"></a><a class="bds_renren"></a><a class="bds_t163"></a><a class="bds_tfh"></a><a class="bds_ty"></a><a class="bds_s51"></a><a class="bds_douban"></a><a class="bds_hi"></a><a class="bds_tieba"></a><a class="bds_tsohu"></a><a class="bds_zx"></a><a class="bds_tuita"></a><span class="bds_more"></span><a class="shareCount"></a></div><script type="text/javascript" id="bdshare_js" data="type=tools"></script><script type="text/javascript" id="bdshell_js"></script><script type="text/javascript">
	document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + new Date().getHours();
</script></td><td><form id="searchbox_008589143145807374698:f5uprauilyy" action="/search.html"><input type="hidden" name="cx" value="008589143145807374698:f5uprauilyy" /><input type="hidden" name="cof" value="FORID:11" /><input name="q" type="text" size="25" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: rgb(126, 157, 185); border-right-color: rgb(126, 157, 185); border-bottom-color: rgb(126, 157, 185); border-left-color: rgb(126, 157, 185); padding-top: 2px; padding-right: 2px; padding-bottom: 2px; padding-left: 2px; background-image: url(http://www.google.com/cse/intl/en/images/google_custom_search_watermark.gif); background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(255, 255, 255); background-position: 0% 50%; background-repeat: no-repeat no-repeat; " /><input type="submit" name="sa" value="Search" /><input name="siteurl" type="hidden" value="http://netkiller.sourceforge.net/" /></form><script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=searchbox_008589143145807374698%3Af5uprauilyy"></script></td></tr></table><div class="chapter" title="第 1 章 Sniffer"><div class="titlepage"><div><div><h2 class="title"><a id="sniffer"></a>第 1 章 Sniffer</h2></div></div></div><div class="toc"><p><strong>目錄</strong></p><dl><dt><span class="section"><a href="sniffer.html#nmap">1. nmap - Network exploration tool and security / port scanner</a></span></dt><dd><dl><dt><span class="section"><a href="sniffer.html#idp180400">1.1. HOST DISCOVERY</a></span></dt><dd><dl><dt><span class="section"><a href="sniffer.html#idp181536">1.1.1. -sP: Ping Scan - go no further than determining if host is online</a></span></dt></dl></dd><dt><span class="section"><a href="sniffer.html#idp186800">1.2. SCAN TECHNIQUES</a></span></dt><dd><dl><dt><span class="section"><a href="sniffer.html#idp187504">1.2.1. -sU: UDP Scan 掃瞄</a></span></dt><dt><span class="section"><a href="sniffer.html#idp191360">1.2.2. -b &lt;FTP relay host&gt;: FTP bounce scan</a></span></dt></dl></dd><dt><span class="section"><a href="sniffer.html#idp192768">1.3. PORT SPECIFICATION AND SCAN ORDER</a></span></dt><dd><dl><dt><span class="section"><a href="sniffer.html#idp193504">1.3.1. -p &lt;port ranges&gt;: Only scan specified ports</a></span></dt></dl></dd><dt><span class="section"><a href="sniffer.html#idp197392">1.4. SCRIPT SCAN</a></span></dt><dd><dl><dt><span class="section"><a href="sniffer.html#idp201616">1.4.1. ftp-anon</a></span></dt><dt><span class="section"><a href="sniffer.html#idp203136">1.4.2. mysql-info</a></span></dt><dt><span class="section"><a href="sniffer.html#idp205056">1.4.3. http</a></span></dt><dt><span class="section"><a href="sniffer.html#idp210000">1.4.4. snmp</a></span></dt><dt><span class="section"><a href="sniffer.html#idp211824">1.4.5. SSHv1</a></span></dt><dt><span class="section"><a href="sniffer.html#idp218400">1.4.6. --script-updatedb 更新腳本</a></span></dt></dl></dd><dt><span class="section"><a href="sniffer.html#idp197648">1.5. OS DETECTION</a></span></dt><dd><dl><dt><span class="section"><a href="sniffer.html#idp220480">1.5.1. -O: Enable OS detection 操作系統探測</a></span></dt></dl></dd><dt><span class="section"><a href="sniffer.html#idp222112">1.6. OUTPUT</a></span></dt><dd><dl><dt><span class="section"><a href="sniffer.html#idp222752">1.6.1. --open: Only show open (or possibly open) ports 操作系統探測</a></span></dt></dl></dd><dt><span class="section"><a href="sniffer.html#idp224416">1.7. MISC</a></span></dt><dd><dl><dt><span class="section"><a href="sniffer.html#idp225056">1.7.1. -6: Enable IPv6 scanning</a></span></dt><dt><span class="section"><a href="sniffer.html#idp226080">1.7.2. -A: Enables OS detection and Version detection, Script scanning and Traceroute</a></span></dt></dl></dd><dt><span class="section"><a href="sniffer.html#idp228704">1.8. Nmap Scripting Engine (NSE)</a></span></dt></dl></dd><dt><span class="section"><a href="tcpdump.html">2. tcpdump - A powerful tool for network monitoring and data acquisition</a></span></dt><dd><dl><dt><span class="section"><a href="tcpdump.html#idp235456">2.1. 監控網絡適配器介面</a></span></dt><dt><span class="section"><a href="tcpdump.html#idp236864">2.2. 監控主機</a></span></dt><dt><span class="section"><a href="tcpdump.html#idp238992">2.3. 監控TCP連接埠</a></span></dt><dt><span class="section"><a href="tcpdump.html#idp239152">2.4. 監控協議</a></span></dt><dt><span class="section"><a href="tcpdump.html#idp245584">2.5. 輸出到檔案</a></span></dt><dt><span class="section"><a href="tcpdump.html#tcpdump.save">2.6. 保存結果</a></span></dt><dt><span class="section"><a href="tcpdump.html#tcpdump.cdp">2.7. Cisco Discovery Protocol (CDP)</a></span></dt><dt><span class="section"><a href="tcpdump.html#idp255952">2.8. 案例</a></span></dt><dd><dl><dt><span class="section"><a href="tcpdump.html#idp256768">2.8.1. 監控80連接埠與icmp,arp</a></span></dt><dt><span class="section"><a href="tcpdump.html#idp258176">2.8.2. monitor mysql tcp package</a></span></dt><dt><span class="section"><a href="tcpdump.html#tcpdump.http">2.8.3. HTTP 包</a></span></dt><dt><span class="section"><a href="tcpdump.html#idp261632">2.8.4. 顯示SYN、FIN和ACK-only包</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="cdpr.html">3. cdpr - Cisco Discovery Protocol Reporter</a></span></dt><dt><span class="section"><a href="nc.html">4. nc - TCP/IP swiss army knife</a></span></dt><dt><span class="section"><a href="ch01s05.html">5. Unicornscan，Zenmap，nast</a></span></dt><dt><span class="section"><a href="ch01s06.html">6. netstat-nat - Show the natted connections on a linux iptable firewall</a></span></dt><dt><span class="section"><a href="wireshark.html">7. Wireshark</a></span></dt></dl></div>
	

<div class="section" title="1. nmap - Network exploration tool and security / port scanner"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="nmap"></a>1. nmap - Network exploration tool and security / port scanner</h2></div></div></div>
	
	<span class="command"><strong>nmap</strong></span>
	<pre class="screen">
$ nmap localhost

Starting Nmap 4.20 ( http://insecure.org ) at 2007-11-19 05:20 EST
Interesting ports on localhost (127.0.0.1):
Not shown: 1689 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
25/tcp   open  smtp
80/tcp   open  http
139/tcp  open  netbios-ssn
443/tcp  open  https
445/tcp  open  microsoft-ds
3306/tcp open  mysql
	</pre>
	<div class="section" title="1.1. HOST DISCOVERY"><div class="titlepage"><div><div><h3 class="title"><a id="idp180400"></a>1.1. HOST DISCOVERY</h3></div></div></div>
		
		<div class="section" title="1.1.1. -sP: Ping Scan - go no further than determining if host is online"><div class="titlepage"><div><div><h4 class="title"><a id="idp181536"></a>1.1.1. -sP: Ping Scan - go no further than determining if host is online</h4></div></div></div>
			
			<p>掃瞄一個網段</p>
			<pre class="screen">
$ nmap  -v -sP 172.16.0.0/24

Starting Nmap 4.62 ( http://nmap.org ) at 2010-11-27 10:00 CST
Initiating Ping Scan at 10:00
Scanning 256 hosts [1 port/host]
Completed Ping Scan at 10:00, 0.80s elapsed (256 total hosts)
Initiating Parallel DNS resolution of 256 hosts. at 10:00
Completed Parallel DNS resolution of 256 hosts. at 10:00, 2.77s elapsed
Host 172.16.0.0 appears to be down.
Host 172.16.0.1 appears to be up.
Host 172.16.0.2 appears to be up.
Host 172.16.0.3 appears to be down.
Host 172.16.0.4 appears to be down.
Host 172.16.0.5 appears to be up.
Host 172.16.0.6 appears to be down.
Host 172.16.0.7 appears to be down.
Host 172.16.0.8 appears to be down.
Host 172.16.0.9 appears to be up.
...
...
Host 172.16.0.253 appears to be down.
Host 172.16.0.254 appears to be down.
Host 172.16.0.255 appears to be down.
Read data files from: /usr/share/nmap
Nmap done: 256 IP addresses (8 hosts up) scanned in 3.596 seconds
			</pre>
			<p>掃瞄正在使用的IP地址</p>
			<pre class="screen">
$ nmap  -v -sP 172.16.0.0/24 | grep up
Host 172.16.0.1 appears to be up.
Host 172.16.0.2 appears to be up.
Host 172.16.0.5 appears to be up.
Host 172.16.0.9 appears to be up.
Host 172.16.0.19 appears to be up.
Host 172.16.0.40 appears to be up.
Host 172.16.0.188 appears to be up.
Host 172.16.0.252 appears to be up.
Nmap done: 256 IP addresses (8 hosts up) scanned in 6.574 seconds


$ nmap -sn -oG - 172.16.1.0/24 | grep Up
Host: 172.16.1.1 ()	Status: Up
Host: 172.16.1.2 ()	Status: Up
Host: 172.16.1.3 ()	Status: Up
Host: 172.16.1.4 ()	Status: Up
Host: 172.16.1.5 ()	Status: Up
Host: 172.16.1.6 ()	Status: Up

			</pre>
			<p>掃瞄MAC地址</p>
			<pre class="screen">
nmap -sP -PI -PT -oN ipandmaclist.txt 192.168.80.0/24
			</pre>
		</div>
	</div>

	<div class="section" title="1.2. SCAN TECHNIQUES"><div class="titlepage"><div><div><h3 class="title"><a id="idp186800"></a>1.2. SCAN TECHNIQUES</h3></div></div></div>
		
		<div class="section" title="1.2.1. -sU: UDP Scan 掃瞄"><div class="titlepage"><div><div><h4 class="title"><a id="idp187504"></a>1.2.1. -sU: UDP Scan 掃瞄</h4></div></div></div>
			
			<p>掃瞄DNS連接埠</p>
			<span class="command"><strong>$ sudo nmap -sU -p 53 xxx.xxx.xxx.xxx</strong></span>
			<pre class="screen">
neo@deployment:~$ sudo nmap -sU -p 53 localhost

Starting Nmap 5.00 ( http://nmap.org ) at 2012-02-02 15:24 CST
Warning: Hostname localhost resolves to 2 IPs. Using 127.0.0.1.
Interesting ports on localhost (127.0.0.1):
PORT   STATE         SERVICE
53/udp open|filtered domain

Nmap done: 1 IP address (1 host up) scanned in 2.14 seconds


neo@deployment:~$ sudo nmap -sU -p 1194 localhost

Starting Nmap 5.00 ( http://nmap.org ) at 2012-02-02 15:24 CST
Warning: Hostname localhost resolves to 2 IPs. Using 127.0.0.1.
Interesting ports on localhost (127.0.0.1):
PORT     STATE  SERVICE
1194/udp closed unknown

Nmap done: 1 IP address (1 host up) scanned in 0.13 seconds


neo@deployment:~$ sudo nmap -sU -v localhost

Starting Nmap 5.00 ( http://nmap.org ) at 2012-02-02 15:22 CST
NSE: Loaded 0 scripts for scanning.
Warning: Hostname localhost resolves to 2 IPs. Using 127.0.0.1.
Initiating UDP Scan at 15:22
Scanning localhost (127.0.0.1) [1000 ports]
Completed UDP Scan at 15:22, 1.26s elapsed (1000 total ports)
Host localhost (127.0.0.1) is up (0.000010s latency).
Interesting ports on localhost (127.0.0.1):
Not shown: 993 closed ports
PORT     STATE         SERVICE
53/udp   open|filtered domain
111/udp  open|filtered rpcbind
123/udp  open|filtered ntp
137/udp  open|filtered netbios-ns
138/udp  open|filtered netbios-dgm
1812/udp open|filtered radius
1813/udp open|filtered radacct

Read data files from: /usr/share/nmap
Nmap done: 1 IP address (1 host up) scanned in 1.33 seconds
           Raw packets sent: 1007 (28.196KB) | Rcvd: 993 (55.608KB)

			</pre>
		</div>
		<div class="section" title="1.2.2. -b &lt;FTP relay host&gt;: FTP bounce scan"><div class="titlepage"><div><div><h4 class="title"><a id="idp191360"></a>1.2.2. -b &lt;FTP relay host&gt;: FTP bounce scan</h4></div></div></div>
			
			<pre class="screen">

			</pre>
		</div>
	</div>
	<div class="section" title="1.3. PORT SPECIFICATION AND SCAN ORDER"><div class="titlepage"><div><div><h3 class="title"><a id="idp192768"></a>1.3. PORT SPECIFICATION AND SCAN ORDER</h3></div></div></div>
		
		<div class="section" title="1.3.1. -p &lt;port ranges&gt;: Only scan specified ports"><div class="titlepage"><div><div><h4 class="title"><a id="idp193504"></a>1.3.1. -p &lt;port ranges&gt;: Only scan specified ports</h4></div></div></div>
			
			<p>Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080</p>
			<pre class="screen">
sudo nmap -sU -p 53 localhost
			</pre>
			<p>掃瞄DHCP伺服器</p>
			<pre class="screen">
sudo nmap -sU -p U:67,68 192.168.0.0/24

sudo nmap -sU -p U:67,68 192.168.0.0/24 &gt; /tmp/dhcp.log
			</pre>
			<p></p>
			<pre class="screen">
$ sudo nmap -sU -p161 192.168.0.0/24 &gt; /tmp/snmp.log
			</pre>
		</div>
	</div>
	<div class="section" title="1.4. SCRIPT SCAN"><div class="titlepage"><div><div><h3 class="title"><a id="idp197392"></a>1.4. SCRIPT SCAN</h3></div></div></div>
		
		<p>nmap script 使用lua編寫，請先安裝lua環境。</p>
		<pre class="screen">
		
$ sudo apt-get install lua5.1

$ lua
Lua 5.1.4  Copyright (C) 1994-2008 Lua.org, PUC-Rio
&gt; ^C
		
		</pre>
		<pre class="screen">
		
$ nmap --script "default and safe" localhost

Starting Nmap 5.21 ( http://nmap.org ) at 2012-02-02 16:23 CST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00023s latency).
Not shown: 993 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
| ssh-hostkey: 1024 a6:ab:76:a5:fb:80:4e:2c:bc:06:d4:85:ff:22:18:1a (DSA)
|_2048 c7:da:16:7a:e7:01:cc:f0:d2:02:b4:17:52:c9:c2:50 (RSA)
80/tcp   open  http
|_html-title: 500 Internal Server Error
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
631/tcp  open  ipp
3000/tcp open  ppp
9000/tcp open  cslistener

Host script results:
|_nbstat: NetBIOS name: NEO-OPTIPLEX-38, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt;
|_smbv2-enabled: Server doesn't support SMBv2 protocol
| smb-os-discovery:
|   OS: Unix (Samba 3.5.11)
|   Name: WORKGROUP\Unknown
|_  System time: 2012-02-02 16:23:08 UTC+8

Nmap done: 1 IP address (1 host up) scanned in 0.21 seconds


$ nmap --script=default 172.16.1.5

Starting Nmap 5.21 ( http://nmap.org ) at 2012-02-02 16:25 CST
Nmap scan report for 172.16.1.5
Host is up (0.024s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
| ssh-hostkey: 1024 c1:40:33:3b:be:4d:ef:52:40:a9:08:0a:e1:ae:d7:91 (DSA)
|_2048 9d:db:c5:41:94:63:c7:51:d1:97:36:d3:87:ad:8f:a5 (RSA)
3306/tcp open  mysql
| mysql-info: Protocol: 10
| Version: 5.1.48-community-log
| Thread ID: 6647320
| Some Capabilities: Long Passwords, Connect with DB, Compress, ODBC, Transactions, Secure Connection
| Status: Autocommit
|_Salt: 0%eRHQ?'Fi_!%6|4+w9U
5666/tcp open  nrpe

Nmap done: 1 IP address (1 host up) scanned in 3.23 seconds
		
		</pre>

		<div class="section" title="1.4.1. ftp-anon"><div class="titlepage"><div><div><h4 class="title"><a id="idp201616"></a>1.4.1. ftp-anon</h4></div></div></div>
			
			<pre class="screen">
$ nmap -p21 --script=ftp-anon 172.16.3.100

Starting Nmap 5.21 ( http://nmap.org ) at 2012-02-02 16:51 CST
NSE: Script Scanning completed.
Nmap scan report for 172.16.3.100
Host is up (0.0066s latency).
PORT   STATE SERVICE
21/tcp open  ftp
|_ftp-anon: Anonymous FTP login allowed

Nmap done: 1 IP address (1 host up) scanned in 0.09 seconds
			</pre>
		</div>
		<div class="section" title="1.4.2. mysql-info"><div class="titlepage"><div><div><h4 class="title"><a id="idp203136"></a>1.4.2. mysql-info</h4></div></div></div>
			
			<pre class="screen">
$ nmap -p3306 --script=mysql-info 172.16.0.5

Starting Nmap 5.00 ( http://nmap.org ) at 2012-02-02 16:58 CST
Interesting ports on 172.16.0.5:
PORT     STATE SERVICE
3306/tcp open  mysql
|  mysql-info: Protocol: 10
|  Version: 5.1.48-community-log
|  Thread ID: 62837508
|  Some Capabilities: Long Passwords, Connect with DB, Compress, ODBC, Transactions, Secure Connection
|  Status: Autocommit
|_ Salt: T{3(moe.R2C;?fgP:rQ|

Nmap done: 1 IP address (1 host up) scanned in 0.06 seconds
			</pre>
		</div>
		<div class="section" title="1.4.3. http"><div class="titlepage"><div><div><h4 class="title"><a id="idp205056"></a>1.4.3. http</h4></div></div></div>
			
			<p>http-date</p>
			<pre class="screen">
$ nmap -p80 --script=http-date www.baidu.com

Starting Nmap 5.21 ( http://nmap.org ) at 2012-02-02 18:37 CST
NSE: Script Scanning completed.
Nmap scan report for www.baidu.com (220.181.111.147)
Host is up (0.037s latency).
PORT   STATE SERVICE
80/tcp open  http
|_http-date: Thu, 02 Feb 2012 10:37:40 GMT; 0s from local time.

Nmap done: 1 IP address (1 host up) scanned in 1.55 seconds

			</pre>
			<p>http-headers</p>
			<pre class="screen">
$ nmap -p80 --script=http-headers www.baidu.com

Starting Nmap 5.21 ( http://nmap.org ) at 2012-02-02 18:38 CST
NSE: Script Scanning completed.
Nmap scan report for www.baidu.com (220.181.111.147)
Host is up (0.036s latency).
PORT   STATE SERVICE
80/tcp open  http
| http-headers:
|   Date: Thu, 02 Feb 2012 10:38:15 GMT
|   Server: BWS/1.0
|   Content-Length: 7677
|   Content-Type: text/html;charset=gb2312
|   Cache-Control: private
|   Expires: Thu, 02 Feb 2012 10:38:15 GMT
|   Set-Cookie: BAIDUID=0279AEA82B65E8B74C03D5B6AA92326C:FG=1; expires=Thu, 02-Feb-42 10:38:15 GMT; path=/; domain=.baidu.com
|   P3P: CP=" OTI DSP COR IVA OUR IND COM "
|   Connection: Close
|
|_  (Request type: HEAD)

Nmap done: 1 IP address (1 host up) scanned in 1.54 seconds
			</pre>
			<pre class="screen">
$ nmap -p80 --script=http-date,http-headers,http-malware-host,http-trace,http-enum 192.168.3.5

Starting Nmap 5.21 ( http://nmap.org ) at 2012-02-02 19:15 CST
NSE: Script Scanning completed.
Nmap scan report for 192.168.3.5
Host is up (0.0015s latency).
PORT   STATE SERVICE
80/tcp open  http
| http-headers:
|   Date: Thu, 02 Feb 2012 11:15:00 GMT
|   Server: Apache
|   Last-Modified: Mon, 29 Nov 2010 14:56:50 GMT
|   ETag: "7bcaa3-2c-496324828b080"
|   Accept-Ranges: bytes
|   Content-Length: 44
|   Connection: close
|   Content-Type: text/html
|
|_  (Request type: HEAD)
|_http-malware-host: Host appears to be clean
|_http-date: Thu, 02 Feb 2012 11:15:00 GMT; 0s from local time.
|_http-enum:

Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds

			</pre>
		</div>
		<div class="section" title="1.4.4. snmp"><div class="titlepage"><div><div><h4 class="title"><a id="idp210000"></a>1.4.4. snmp</h4></div></div></div>
			
			<pre class="screen">
$ sudo nmap -sU -p161 --script=snmp-sysdescr 172.16.3.250

Starting Nmap 5.00 ( http://nmap.org ) at 2012-02-02 19:20 CST
Interesting ports on 172.16.3.250:
PORT    STATE SERVICE
161/udp open  snmp
|  snmp-sysdescr: Cisco Adaptive Security Appliance Version 8.2(5)
|_   System uptime: 84 days, 18:39:55.00 (732479500 timeticks)

Nmap done: 1 IP address (1 host up) scanned in 0.49 seconds
			</pre>
		</div>
		<div class="section" title="1.4.5. SSHv1"><div class="titlepage"><div><div><h4 class="title"><a id="idp211824"></a>1.4.5. SSHv1</h4></div></div></div>
			
			<pre class="screen">
$ sudo nmap -sT -p22 --script=sshv1 172.16.0.0/24

$ sudo nmap -sT -p22 --script=sshv1 172.16.3.0/24 --open | grep -B4 sshv1

Interesting ports on 172.16.3.250:
PORT   STATE SERVICE
22/tcp open  ssh
|_ sshv1: Server supports SSHv1

Interesting ports on 172.16.3.251:
PORT   STATE SERVICE
22/tcp open  ssh
|_ sshv1: Server supports SSHv1
			</pre>
			<pre class="screen">
$ nmap -sT -p22 172.16.0.0/24 --script=ssh-hostkey --script-args=ssh_hostkey=all &gt; ssh.log

$ nmap -sT -p22 172.16.0.5 --script=ssh-hostkey --script-args=ssh_hostkey=full

Starting Nmap 5.21 ( http://nmap.org ) at 2012-02-02 19:35 CST
NSE: Script Scanning completed.
Nmap scan report for 172.16.0.5
Host is up (0.0017s latency).
PORT   STATE SERVICE
22/tcp open  ssh
| ssh-hostkey: ssh-dss AAAAB3NzaC1kc3MAAACBANinhMHgAGFMhkYW0qmFTNsJKuim8P7vFfPV3+c9R0urqF42HwZrIbhEZhRlUDSGo0v5cFzufabQaQ58//L4UXYqKOHaiqSo4ju5CWquH6YY+SNhszJY4OSessioJJfjbLCXx73pfqX8akEV13jQujLhYD0Tuela0/c4iQW+ktnjAAAAFQDxCjX3PK+dAUKviG6xX2C6DstqUQAAAIBrEephaZhQJg3ctO3Y7OMAOu/uRKt9VpeChbptsh4DGXk6Lmet5hYJ1/UOzEAZd4dEO0uijy8iKYSZoAaZh2qGa9PynIWuD1ENt8feEMwRv5VV7zaNitmjYedmPO9rLAja1/49mxUq9XAeRYTOhWJlbwrc38sybTsCrDsdoxDqUwAAAIEAzV7w+dy0lzER0OHfy/E70So80V8/2Bo3AIwnACWGMTqKC2CrFm6VWDKA9P4x0bq+JBshpjtur/3H0sgAt+Zky3Z2EWpdf+9z1AqTy3l95J+xQhQTzD2lw+NqroInxEqJU0eip3YgdTqksQuDRCSy/hKJDLJOELkWbDLMlb1vXA8=
|_ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAlgJcaT8/F0Ah+Jq9PifhQ3Bvfh4Nl5/WWiyoF0yIhhKlNnO04Vnbi8Qb39BDVRKaqIrfhgbG3vxfyF3TeSEOoAiXXyCns6Ivl7HUEHVsjHOVu7nwwMqo94CaM1+pUgJtXmbmTWyfWGCm8kGD2xNaxs10uxIcuukBN7jlN2TGyEmOD8QkA+1Dx7XGBjpMZT+DQwmEo72V2taAo3a0UOz9ivAakZ/kysP+PN+Kz106iT3BWMkvQScyt96HAwbq8Z0tO531mz90UGVBS1KqNMtNsLHsXYJnQ3obXUTwo8KvtEvJ1UHDs6QdEP55PiBTVvCS+CbEwZZ9O1yGNfznBWmp4Q==

Nmap done: 1 IP address (1 host up) scanned in 0.11 seconds


$ nmap -sT -p22 172.16.0.5 --script=ssh-hostkey --script-args=ssh_hostkey=all

Starting Nmap 5.21 ( http://nmap.org ) at 2012-02-02 19:35 CST
NSE: Script Scanning completed.
Nmap scan report for 172.16.0.5
Host is up (0.0014s latency).
PORT   STATE SERVICE
22/tcp open  ssh
| ssh-hostkey: 1024 26:89:a4:1d:f1:28:3c:36:88:ea:49:6d:1b:df:de:70 (DSA)
| 1024 xumep-dynut-poheh-cenys-dyfyz-tubap-lupoz-fofyd-figuf-timaz-byxox (DSA)
| +--[ DSA 1024]----+
| |    .            |
| |.o   +           |
| |o * + .          |
| |...B o .         |
| |...+o o S        |
| |o o + .o         |
| | o . . o E       |
| |      . +        |
| |       . .       |
| +-----------------+
| ssh-dss AAAAB3NzaC1kc3MAAACBANinhMHgAGFMhkYW0qmFTNsJKuim8P7vFfPV3+c9R0urqF42HwZrIbhEZhRlUDSGo0v5cFzufabQaQ58//L4UXYqKOHaiqSo4ju5CWquH6YY+SNhszJY4OSessioJJfjbLCXx73pfqX8akEV13jQujLhYD0Tuela0/c4iQW+ktnjAAAAFQDxCjX3PK+dAUKviG6xX2C6DstqUQAAAIBrEephaZhQJg3ctO3Y7OMAOu/uRKt9VpeChbptsh4DGXk6Lmet5hYJ1/UOzEAZd4dEO0uijy8iKYSZoAaZh2qGa9PynIWuD1ENt8feEMwRv5VV7zaNitmjYedmPO9rLAja1/49mxUq9XAeRYTOhWJlbwrc38sybTsCrDsdoxDqUwAAAIEAzV7w+dy0lzER0OHfy/E70So80V8/2Bo3AIwnACWGMTqKC2CrFm6VWDKA9P4x0bq+JBshpjtur/3H0sgAt+Zky3Z2EWpdf+9z1AqTy3l95J+xQhQTzD2lw+NqroInxEqJU0eip3YgdTqksQuDRCSy/hKJDLJOELkWbDLMlb1vXA8=
| 2048 98:fb:db:e0:a3:99:18:04:cb:8c:42:25:f0:f5:b3:5a (RSA)
| 2048 xogok-vykec-zacyg-ruzup-baral-kotyv-latoz-hygyz-hysis-zadun-hyxix (RSA)
| +--[ RSA 2048]----+
| |o. ..            |
| | .o. .           |
| | .o   o          |
| |.+ o   =         |
| |o + . E S        |
| |.  . o .         |
| |    o . .        |
| |     o =.o       |
| |    . +.+o.      |
| +-----------------+
|_ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAlgJcaT8/F0Ah+Jq9PifhQ3Bvfh4Nl5/WWiyoF0yIhhKlNnO04Vnbi8Qb39BDVRKaqIrfhgbG3vxfyF3TeSEOoAiXXyCns6Ivl7HUEHVsjHOVu7nwwMqo94CaM1+pUgJtXmbmTWyfWGCm8kGD2xNaxs10uxIcuukBN7jlN2TGyEmOD8QkA+1Dx7XGBjpMZT+DQwmEo72V2taAo3a0UOz9ivAakZ/kysP+PN+Kz106iT3BWMkvQScyt96HAwbq8Z0tO531mz90UGVBS1KqNMtNsLHsXYJnQ3obXUTwo8KvtEvJ1UHDs6QdEP55PiBTVvCS+CbEwZZ9O1yGNfznBWmp4Q==

Nmap done: 1 IP address (1 host up) scanned in 0.12 seconds


$ nmap -sT -p22 172.16.0.5 --script=ssh-hostkey --script-args=ssh_hostkey='visual bubble'

Starting Nmap 5.21 ( http://nmap.org ) at 2012-02-02 19:36 CST
NSE: Script Scanning completed.
Nmap scan report for 172.16.0.5
Host is up (0.0017s latency).
PORT   STATE SERVICE
22/tcp open  ssh
| ssh-hostkey: 1024 xumep-dynut-poheh-cenys-dyfyz-tubap-lupoz-fofyd-figuf-timaz-byxox (DSA)
| +--[ DSA 1024]----+
| |    .            |
| |.o   +           |
| |o * + .          |
| |...B o .         |
| |...+o o S        |
| |o o + .o         |
| | o . . o E       |
| |      . +        |
| |       . .       |
| +-----------------+
| 2048 xogok-vykec-zacyg-ruzup-baral-kotyv-latoz-hygyz-hysis-zadun-hyxix (RSA)
| +--[ RSA 2048]----+
| |o. ..            |
| | .o. .           |
| | .o   o          |
| |.+ o   =         |
| |o + . E S        |
| |.  . o .         |
| |    o . .        |
| |     o =.o       |
| |    . +.+o.      |
|_+-----------------+

Nmap done: 1 IP address (1 host up) scanned in 0.12 seconds

			</pre>
		</div>
		<div class="section" title="1.4.6. --script-updatedb 更新腳本"><div class="titlepage"><div><div><h4 class="title"><a id="idp218400"></a>1.4.6. --script-updatedb 更新腳本</h4></div></div></div>
			
			<pre class="screen">
$ sudo nmap --script-updatedb

Starting Nmap 5.00 ( http://nmap.org ) at 2012-02-02 16:34 CST
NSE: Updating rule database.
NSE script database updated successfully.
Nmap done: 0 IP addresses (0 hosts up) scanned in 0.12 seconds

			</pre>
		</div>
	</div>
	<div class="section" title="1.5. OS DETECTION"><div class="titlepage"><div><div><h3 class="title"><a id="idp197648"></a>1.5. OS DETECTION</h3></div></div></div>
		
		<div class="section" title="1.5.1. -O: Enable OS detection 操作系統探測"><div class="titlepage"><div><div><h4 class="title"><a id="idp220480"></a>1.5.1. -O: Enable OS detection 操作系統探測</h4></div></div></div>
			
			<pre class="screen">
nmap -O -v scanme.nmap.org
			</pre>
		</div>
	</div>

	<div class="section" title="1.6. OUTPUT"><div class="titlepage"><div><div><h3 class="title"><a id="idp222112"></a>1.6. OUTPUT</h3></div></div></div>
		
		<div class="section" title="1.6.1. --open: Only show open (or possibly open) ports 操作系統探測"><div class="titlepage"><div><div><h4 class="title"><a id="idp222752"></a>1.6.1. --open: Only show open (or possibly open) ports 操作系統探測</h4></div></div></div>
			
			<pre class="screen">
nmap -O -v scanme.nmap.org
			</pre>
		</div>
	</div>

	<div class="section" title="1.7. MISC"><div class="titlepage"><div><div><h3 class="title"><a id="idp224416"></a>1.7. MISC</h3></div></div></div>
		
		<div class="section" title="1.7.1. -6: Enable IPv6 scanning"><div class="titlepage"><div><div><h4 class="title"><a id="idp225056"></a>1.7.1. -6: Enable IPv6 scanning</h4></div></div></div>
			
		</div>
		<div class="section" title="1.7.2. -A: Enables OS detection and Version detection, Script scanning and Traceroute"><div class="titlepage"><div><div><h4 class="title"><a id="idp226080"></a>1.7.2. -A: Enables OS detection and Version detection, Script scanning and Traceroute</h4></div></div></div>
			
			<pre class="screen">
			
  $ nmap -A -T4 localhost

Starting Nmap 5.21 ( http://nmap.org ) at 2012-02-02 14:54 CST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00025s latency).
Not shown: 993 closed ports
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 5.8p1 Debian 7ubuntu1 (protocol 2.0)
| ssh-hostkey: 1024 a6:ab:76:a5:fb:80:4e:2c:bc:06:d4:85:ff:22:18:1a (DSA)
|_2048 c7:da:16:7a:e7:01:cc:f0:d2:02:b4:17:52:c9:c2:50 (RSA)
80/tcp   open  http        nginx 1.0.5
|_html-title: 500 Internal Server Error
139/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
631/tcp  open  ipp         CUPS 1.4
3000/tcp open  ntop-http   Ntop web interface 4.0.3
9000/tcp open  tcpwrapped
Service Info: OS: Linux

Host script results:
|_nbstat: NetBIOS name: NEO-OPTIPLEX-38, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt;
|_smbv2-enabled: Server doesn't support SMBv2 protocol
| smb-os-discovery:
|   OS: Unix (Samba 3.5.11)
|   Name: WORKGROUP\Unknown
|_  System time: 2012-02-02 14:54:19 UTC+8

Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.24 seconds
			
			</pre>
		</div>
	</div>
	<div class="section" title="1.8. Nmap Scripting Engine (NSE)"><div class="titlepage"><div><div><h3 class="title"><a id="idp228704"></a>1.8. Nmap Scripting Engine (NSE)</h3></div></div></div>
		
		<p>http://nmap.org/nsedoc/</p>
		<p>預置腳本</p>
		<pre class="screen">
$ ls /usr/share/nmap/scripts
asn-query.nse                http-malware-host.nse    smb-enum-groups.nse
auth-owners.nse              http-open-proxy.nse      smb-enum-processes.nse
auth-spoof.nse               http-passwd.nse          smb-enum-sessions.nse
banner.nse                   http-trace.nse           smb-enum-shares.nse
citrix-brute-xml.nse         http-userdir-enum.nse    smb-enum-users.nse
citrix-enum-apps.nse         iax2-version.nse         smb-os-discovery.nse
citrix-enum-apps-xml.nse     imap-capabilities.nse    smb-psexec.nse
citrix-enum-servers.nse      irc-info.nse             smb-security-mode.nse
citrix-enum-servers-xml.nse  ms-sql-info.nse          smb-server-stats.nse
daytime.nse                  mysql-info.nse           smb-system-info.nse
db2-info.nse                 nbstat.nse               smbv2-enabled.nse
dhcp-discover.nse            nfs-showmount.nse        smtp-commands.nse
dns-random-srcport.nse       ntp-info.nse             smtp-open-relay.nse
dns-random-txid.nse          oracle-sid-brute.nse     smtp-strangeport.nse
dns-recursion.nse            p2p-conficker.nse        sniffer-detect.nse
dns-zone-transfer.nse        pjl-ready-message.nse    snmp-brute.nse
finger.nse                   pop3-brute.nse           snmp-sysdescr.nse
ftp-anon.nse                 pop3-capabilities.nse    socks-open-proxy.nse
ftp-bounce.nse               pptp-version.nse         sql-injection.nse
ftp-brute.nse                realvnc-auth-bypass.nse  ssh-hostkey.nse
html-title.nse               robots.txt.nse           sshv1.nse
http-auth.nse                rpcinfo.nse              ssl-cert.nse
http-date.nse                script.db                sslv2.nse
http-enum.nse                skypev2-version.nse      telnet-brute.nse
http-favicon.nse             smb-brute.nse            upnp-info.nse
http-headers.nse             smb-check-vulns.nse      whois.nse
http-iis-webdav-vuln.nse     smb-enum-domains.nse     x11-access.nse
		</pre>
		<p>使用所有腳本進行掃瞄</p>
		<pre class="screen">
nmap --script all localhost
		</pre>
	</div>
</div>




	

	
	
	
	
</div><div xmlns="" id="disqus_thread"></div><script xmlns="" type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

            if(document.domain == 'netkiller.github.com'){
            var disqus_shortname = 'netkiller'; // required: replace example with your forum shortname
            }else{
			var disqus_shortname = 'neochan';
            }

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script><noscript xmlns="">Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a xmlns="" href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="reader.html">上一頁</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="tcpdump.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">3. 寫給讀者 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 2. tcpdump - A powerful tool for network monitoring and data acquisition</td></tr></table></div><script xmlns="" type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11694057-1']);
  _gaq.push(['_setDomainName', 'netkiller.github.io']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script><script xmlns="" type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F997cd4a7320a82d72cb74d179118f697' type='text/javascript'%3E%3C/script%3E"));
</script></body></html>